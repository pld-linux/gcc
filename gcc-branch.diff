Index: libgcc/config/i386/32/sfp-machine.h
===================================================================
--- libgcc/config/i386/32/sfp-machine.h	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgcc/config/i386/32/sfp-machine.h	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -145,8 +145,8 @@
     if (_fex & FP_EX_DIVZERO)						\
       {									\
 	float f = 1.0, g = 0.0;						\
-	__asm__ __volatile__ ("fdivp" : "=t" (f)			\
-			      	      : "0" (f), "u" (g)		\
+	__asm__ __volatile__ ("fdivp {%0, %y1|%y1, %0}"			\
+				      : "+t" (f) : "u" (g)		\
 				      : "st(1)");			\
 	__asm__ __volatile__ ("fwait");					\
       }									\
Index: libgcc/ChangeLog
===================================================================
--- libgcc/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgcc/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,8 @@
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* config/i386/32/sfp-machine.h (FP_HANDLE_EXCEPTIONS): Support Sun
+	assembler syntax.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libgomp/Makefile.in
===================================================================
--- libgomp/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgomp/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -38,15 +38,15 @@
 build_triplet = @build@
 host_triplet = @host@
 target_triplet = @target@
-DIST_COMMON = $(am__configure_deps) $(srcdir)/../config.guess \
-	$(srcdir)/../config.sub $(srcdir)/../depcomp \
-	$(srcdir)/../install-sh $(srcdir)/../ltmain.sh \
-	$(srcdir)/../missing $(srcdir)/../mkinstalldirs \
-	$(srcdir)/Makefile.am $(srcdir)/Makefile.in \
-	$(srcdir)/config.h.in $(srcdir)/libgomp.spec.in \
-	$(srcdir)/libgomp_f.h.in $(srcdir)/omp.h.in \
-	$(srcdir)/omp_lib.f90.in $(srcdir)/omp_lib.h.in \
-	$(top_srcdir)/configure ChangeLog
+DIST_COMMON = $(srcdir)/../config.guess $(srcdir)/../config.sub \
+	ChangeLog $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/config.h.in $(srcdir)/../mkinstalldirs \
+	$(srcdir)/omp.h.in $(srcdir)/omp_lib.h.in \
+	$(srcdir)/omp_lib.f90.in $(srcdir)/libgomp_f.h.in \
+	$(srcdir)/libgomp.spec.in $(srcdir)/../depcomp \
+	$(srcdir)/../ltmain.sh $(srcdir)/../config.guess \
+	$(srcdir)/../config.sub
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../config/acx.m4 \
@@ -100,7 +100,6 @@
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(libgomp_la_SOURCES)
-DIST_SOURCES = $(libgomp_la_SOURCES)
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -133,17 +132,6 @@
 ETAGS = etags
 CTAGS = ctags
 DIST_SUBDIRS = $(SUBDIRS)
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -771,152 +759,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/. $(distdir)/.. $(distdir)/../config
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
-	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
-	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
-	        distdir) \
-	      || exit 1; \
-	  fi; \
-	done
-	$(MAKE) $(AM_MAKEFLAGS) \
-	  top_distdir="$(top_distdir)" distdir="$(distdir)" \
-	  dist-info
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-recursive
 all-am: Makefile $(INFO_DEPS) $(LTLIBRARIES) all-multi $(HEADERS) \
@@ -1049,16 +891,13 @@
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am all-local \
 	all-multi am--refresh check check-am clean clean-generic \
 	clean-libtool clean-multi clean-recursive \
-	clean-toolexeclibLTLIBRARIES ctags ctags-recursive dist \
-	dist-all dist-bzip2 dist-gzip dist-info dist-shar dist-tarZ \
-	dist-zip distcheck distclean distclean-compile \
-	distclean-generic distclean-hdr distclean-libtool \
-	distclean-multi distclean-recursive distclean-tags \
-	distcleancheck distdir distuninstallcheck dvi dvi-am html \
-	html-am info info-am install install-am install-data \
-	install-data-am install-exec install-exec-am install-info \
-	install-info-am install-man install-multi \
-	install-nodist_fincludeHEADERS \
+	clean-toolexeclibLTLIBRARIES ctags ctags-recursive dist-info \
+	distclean distclean-compile distclean-generic distclean-hdr \
+	distclean-libtool distclean-multi distclean-recursive \
+	distclean-tags dvi dvi-am html html-am info info-am install \
+	install-am install-data install-data-am install-exec \
+	install-exec-am install-info install-info-am install-man \
+	install-multi install-nodist_fincludeHEADERS \
 	install-nodist_libsubincludeHEADERS \
 	install-nodist_toolexeclibHEADERS install-strip \
 	install-toolexeclibLTLIBRARIES installcheck installcheck-am \
Index: libgomp/configure.ac
===================================================================
--- libgomp/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgomp/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -61,7 +61,7 @@
 #  -Wall:  turns on all automake warnings...
 #  -Wno-portability:  ...except this one, since GNU make is required.
 #  -Wno-override: ... and this one, since we do want this in testsuite.
-AM_INIT_AUTOMAKE([1.9.0 foreign -Wall -Wno-portability -Wno-override])
+AM_INIT_AUTOMAKE([1.9.0 foreign no-dist -Wall -Wno-portability -Wno-override])
 AM_ENABLE_MULTILIB(, ..)
 
 # Calculate toolexeclibdir
Index: libgomp/ChangeLog
===================================================================
--- libgomp/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgomp/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,15 @@
+2010-04-30  Jakub Jelinek  <jakub@redhat.com>
+
+	PR c/43893
+	* testsuite/libgomp.c/pr43893.c: New test.
+	* testsuite/libgomp.c++/pr43893.C: New test.
+
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libgomp/testsuite/libgomp.c++/pr43893.C
===================================================================
--- libgomp/testsuite/libgomp.c++/pr43893.C	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ libgomp/testsuite/libgomp.c++/pr43893.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,125 @@
+// PR c/43893
+// { dg-do run }
+
+extern "C" void abort ();
+
+template <typename T, T M, T N>
+void
+f1 ()
+{
+  int c;
+  T i;
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = M; i < N; i++)
+    c++;
+  if (c != 1)
+    abort ();
+}
+
+template <typename T, T M, T N>
+void
+f2 ()
+{
+  int c;
+  T i;
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = M; i <= N; i++)
+    c++;
+  if (c != 1)
+    abort ();
+}
+
+template <typename T, T M, T N>
+void
+f3 ()
+{
+  int c;
+  T i;
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = M; i > N; i--)
+    c++;
+  if (c != 1)
+    abort ();
+}
+
+template <typename T, T M, T N>
+void
+f4 ()
+{
+  int c;
+  T i;
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = M; i >= N; i--)
+    c++;
+  if (c != 1)
+    abort ();
+}
+
+int
+main ()
+{
+  int c;
+  unsigned int i;
+  int j;
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 0; i < 1; i++)
+    c++;
+  if (c != 1)
+    abort ();
+  f1 <unsigned int, 0, 1> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 0; i <= 0; i++)
+    c++;
+  if (c != 1)
+    abort ();
+  f2 <unsigned int, 0, 0> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = - __INT_MAX__ - 1; j < - __INT_MAX__; j++)
+    c++;
+  if (c != 1)
+    abort ();
+  f1 <int, (- __INT_MAX__ - 1), (- __INT_MAX__)> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = - __INT_MAX__ - 1; j <= - __INT_MAX__ - 1; j++)
+    c++;
+  if (c != 1)
+    abort ();
+  f2 <int, (- __INT_MAX__ - 1), (- __INT_MAX__ - 1)> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 2U * __INT_MAX__ + 1; i > 2U * __INT_MAX__; i--)
+    c++;
+  if (c != 1)
+    abort ();
+  f3 <unsigned int, (2U * __INT_MAX__ + 1), (2U * __INT_MAX__)> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 2U * __INT_MAX__ + 1; i >= 2U * __INT_MAX__ + 1; i--)
+    c++;
+  if (c != 1)
+    abort ();
+  f4 <unsigned int, (2U * __INT_MAX__ + 1), (2U * __INT_MAX__ + 1)> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = __INT_MAX__; j > __INT_MAX__ - 1; j--)
+    c++;
+  if (c != 1)
+    abort ();
+  f3 <int, __INT_MAX__, (__INT_MAX__ - 1)> ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = __INT_MAX__; j >= __INT_MAX__; j--)
+    c++;
+  if (c != 1)
+    abort ();
+  f4 <int, __INT_MAX__, __INT_MAX__> ();
+  return 0;
+}
Index: libgomp/testsuite/libgomp.c/pr43893.c
===================================================================
--- libgomp/testsuite/libgomp.c/pr43893.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ libgomp/testsuite/libgomp.c/pr43893.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,61 @@
+/* PR c/43893 */
+/* { dg-do run } */
+
+extern void abort (void);
+
+int
+main ()
+{
+  int c;
+  unsigned int i;
+  int j;
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 0; i < 1; i++)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 0; i <= 0; i++)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = - __INT_MAX__ - 1; j < - __INT_MAX__; j++)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = - __INT_MAX__ - 1; j <= - __INT_MAX__ - 1; j++)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 2U * __INT_MAX__ + 1; i > 2U * __INT_MAX__; i--)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (i = 2U * __INT_MAX__ + 1; i >= 2U * __INT_MAX__ + 1; i--)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = __INT_MAX__; j > __INT_MAX__ - 1; j--)
+    c++;
+  if (c != 1)
+    abort ();
+  c = 0;
+#pragma omp parallel for reduction(+:c)
+  for (j = __INT_MAX__; j >= __INT_MAX__; j--)
+    c++;
+  if (c != 1)
+    abort ();
+  return 0;
+}
Index: gcc/doc/sourcebuild.texi
===================================================================
--- gcc/doc/sourcebuild.texi	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/doc/sourcebuild.texi	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1035,9 +1035,12 @@
 They require at least one argument, which can be an empty string if the
 specific procedure does not examine the argument.
 
-@item @{ dg-require-effective-target @var{keyword} @}
+@item @{ dg-require-effective-target @var{keyword} [@{ @var{selector} @}] @}
 Skip the test if the test target, including current multilib flags,
 is not covered by the effective-target keyword.
+If the directive includes the optional @samp{@{ @var{selector} @}}
+then the effective-target test is only performed if the target system
+matches the @var{selector}.
 This directive must appear after any @code{dg-do} directive in the test
 and before any @code{dg-additional-sources} directive.
 
Index: gcc/doc/standards.texi
===================================================================
--- gcc/doc/standards.texi	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/doc/standards.texi	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -183,7 +183,7 @@
 available on the ISO C++ committee's web site at
 @uref{http://www.open-std.org/jtc1/sc22/wg21/}. For information
 regarding the C++0x features available in the experimental C++0x mode,
-see @uref{http://gcc.gnu.org/gcc-4.3/cxx0x_status.html}. To select this
+see @uref{http://gcc.gnu.org/projects/cxx0x.html}. To select this
 standard in GCC, use the option @option{-std=c++0x}; to obtain all the
 diagnostics required by the standard, you should also specify
 @option{-pedantic} (or @option{-pedantic-errors} if you want them to be
Index: gcc/DATESTAMP
===================================================================
--- gcc/DATESTAMP	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/DATESTAMP	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1 +1 @@
-20100429
+20100601
Index: gcc/configure
===================================================================
--- gcc/configure	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/configure	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -21359,8 +21359,36 @@
   echo "$as_me:$LINENO: \$? = $ac_status" >&5
   (exit $ac_status); }; }
     then
-	gcc_cv_as_hidden=yes
+
+# Solaris 9/x86 as incorrectly emits an alias for a hidden symbol with
+# STV_HIDDEN, so disable .hidden support if so.
+case "${target}" in
+  i?86-*-solaris2*)
+    if test x$gcc_cv_as != x && test x$gcc_cv_objdump != x; then
+      cat > conftest.s <<EOF
+.globl hidden
+        .hidden hidden
+hidden:
+.globl default
+        .set    default,hidden
+EOF
+      if $gcc_cv_as -o conftest.o conftest.s > /dev/null 2>&1 \
+        && $gcc_cv_objdump -t conftest.o 2>/dev/null | \
+        grep '\.hidden default' > /dev/null; then
+        gcc_cv_as_hidden=no
+      else
+        gcc_cv_as_hidden=yes
+      fi
     else
+      # Assume bug is present if objdump is missing.
+      gcc_cv_as_hidden=no
+    fi
+    ;;
+  *)
+    gcc_cv_as_hidden=yes
+    ;;
+esac
+    else
       echo "configure: failed program was" >&5
       cat conftest.s >&5
     fi
@@ -22925,6 +22953,39 @@
 
 fi
 
+    echo "$as_me:$LINENO: checking assembler for .quad directive" >&5
+echo $ECHO_N "checking assembler for .quad directive... $ECHO_C" >&6
+if test "${gcc_cv_as_ix86_quad+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  gcc_cv_as_ix86_quad=no
+  if test x$gcc_cv_as != x; then
+    echo '.quad 0' > conftest.s
+    if { ac_try='$gcc_cv_as  -o conftest.o conftest.s >&5'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }
+    then
+	gcc_cv_as_ix86_quad=yes
+    else
+      echo "configure: failed program was" >&5
+      cat conftest.s >&5
+    fi
+    rm -f conftest.o conftest.s
+  fi
+fi
+echo "$as_me:$LINENO: result: $gcc_cv_as_ix86_quad" >&5
+echo "${ECHO_T}$gcc_cv_as_ix86_quad" >&6
+if test $gcc_cv_as_ix86_quad = yes; then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_AS_IX86_QUAD 1
+_ACEOF
+
+fi
+
     echo "$as_me:$LINENO: checking assembler for sahf mnemonic" >&5
 echo $ECHO_N "checking assembler for sahf mnemonic... $ECHO_C" >&6
 if test "${gcc_cv_as_ix86_sahf+set}" = set; then
@@ -22932,7 +22993,8 @@
 else
   gcc_cv_as_ix86_sahf=no
   if test x$gcc_cv_as != x; then
-    echo 'sahf' > conftest.s
+    echo '.code64
+       sahf' > conftest.s
     if { ac_try='$gcc_cv_as  -o conftest.o conftest.s >&5'
   { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
   (eval $ac_try) 2>&5
@@ -22997,7 +23059,7 @@
 
 fi
 
-    # This one is used unconditionally by i386.[ch]; it is to be defined
+    # These two are used unconditionally by i386.[ch]; it is to be defined
     # to 1 if the feature is present, 0 otherwise.
     echo "$as_me:$LINENO: checking assembler for GOTOFF in data" >&5
 echo $ECHO_N "checking assembler for GOTOFF in data... $ECHO_C" >&6
@@ -23038,6 +23100,40 @@
 #define HAVE_AS_GOTOFF_IN_DATA `if test $gcc_cv_as_ix86_gotoff_in_data = yes; then echo 1; else echo 0; fi`
 _ACEOF
 
+
+    echo "$as_me:$LINENO: checking assembler for rep and lock prefix" >&5
+echo $ECHO_N "checking assembler for rep and lock prefix... $ECHO_C" >&6
+if test "${gcc_cv_as_ix86_rep_lock_prefix+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+  gcc_cv_as_ix86_rep_lock_prefix=no
+  if test x$gcc_cv_as != x; then
+    echo 'rep movsl
+	 lock orl $0, (%esp)' > conftest.s
+    if { ac_try='$gcc_cv_as  -o conftest.o conftest.s >&5'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }
+    then
+	gcc_cv_as_ix86_rep_lock_prefix=yes
+    else
+      echo "configure: failed program was" >&5
+      cat conftest.s >&5
+    fi
+    rm -f conftest.o conftest.s
+  fi
+fi
+echo "$as_me:$LINENO: result: $gcc_cv_as_ix86_rep_lock_prefix" >&5
+echo "${ECHO_T}$gcc_cv_as_ix86_rep_lock_prefix" >&6
+
+
+cat >>confdefs.h <<_ACEOF
+#define HAVE_AS_IX86_REP_LOCK_PREFIX `if test $gcc_cv_as_ix86_rep_lock_prefix = yes; then echo 1; else echo 0; fi`
+_ACEOF
+
+
     ;;
 
   ia64*-*-*)
Index: gcc/DEV-PHASE
===================================================================
--- gcc/DEV-PHASE	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/DEV-PHASE	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1 @@
+prerelease
Index: gcc/ChangeLog
===================================================================
--- gcc/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,205 @@
+2010-05-28  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>
+
+	* config/s390/s390.md (movqi): Fix typo ('*' -> '#').
+
+2010-05-27  Matthias Klose  <doko@ubuntu.com>
+
+	Backport from mainline:
+	2009-04-22  Andrey Belevantsev  <abel@ispras.ru>
+
+	PR rtl-optimization/39580
+	* sel-sched-ir.c (insert_in_history_vect): Remove incorrect gcc_assert.
+
+2010-05-26  Jakub Jelinek  <jakub@redhat.com>
+
+	PR target/44199
+	* config/rs6000/rs6000.c (rs6000_emit_epilogue): If cfun->calls_alloca
+	or total_size is larger than red zone size for non-V4 ABI, emit a
+	stack_tie resp. frame_tie insn before stack pointer restore.
+	* config/rs6000/rs6000.md (frame_tie): New insn.
+
+2010-05-24  Uros Bizjak  <ubizjak@gmail.com>
+
+	Backport from mainline:
+	2010-05-20  Uros Bizjak  <ubizjak@gmail.com>
+
+	PR target/43733
+	* configure.ac (gcc_cv_as_ix86_sahf): Switch to 64bit mode.
+	* configure: Regenerate.
+	* config.in: Regenerate.
+	* config/i386/i386.md (x86_sahf_1): Conditionally output 0x9e
+	instead of sahf only for 64bit targets.
+
+2010-05-23  H.J. Lu  <hongjiu.lu@intel.com>
+
+	Backport from mainline
+	2010-05-23  H.J. Lu  <hongjiu.lu@intel.com>
+
+	PR target/44245
+	* config/i386/i386.c (def_builtin): Properly check
+	OPTION_MASK_ISA_64BIT.
+
+2010-05-21  Andreas Krebbel  <Andreas.Krebbel@de.ibm.com>
+
+	* config/s390/s390.c (override_options): Increase the default
+	of max-completely-peel-times.
+
+2010-05-21  Richard Guenther  <rguenther@suse.de>
+
+	PR tree-optimization/43845
+	* tree-ssa-pre.c (create_component_ref_by_pieces_1): Properly
+	lookup the CALL_EXPR function and arguments.
+
+2010-05-21  Jakub Jelinek  <jakub@redhat.com>
+
+	PR debug/44205
+	* tree-cfgcleanup.c (tree_forwarder_block_p): Return false if
+	at -O0 goto_locus of any of the incoming edges differs from
+	goto_locus of outgoing edge, or gimple_location of any of the
+	labels differs.
+
+2010-05-19  Kenneth Zadeck  <zadeck@naturalbridge.com>
+
+	PR bootstrap/43870
+	* df-scan.c (df_ref_compare): Stabilize sort.
+
+2010-05-20  Jakub Jelinek  <jakub@redhat.com>
+
+	PR target/44074
+	* configure: Regenerate.
+
+2010-05-20  Hans-Peter Nilsson  <hp@axis.com>
+
+	PR target/44202
+	* config/cris/cris.md ("*addsi3_v32"): Correct "cc"
+	settings for 16-bit-constant "addo" alternative.
+
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	Backport from mainline:
+	2010-05-17  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	PR target/44074
+	* configure.ac (HAVE_AS_IX86_REP_LOCK_PREFIX): New test.
+	* configure: Regenerate.
+	* config.in: Regenerate.
+	* config/i386/i386.c (print_operand) <case ;>: Also print ; if
+	!HAVE_AS_IX86_REP_LOCK_PREFIX.
+	Don't emit whitespace.
+	* config/i386/i386.md (*rep_movdi_rex64): Use {%;} after rep.
+	(*rep_movsi): Likewise.
+	(*rep_movsi_rex64): Likewise.
+	(*rep_movqi): Likewise.
+	(*rep_movqi_rex64): Likewise.
+	(*rep_stosdi_rex64): Likewise.
+	(*rep_stossi): Likewise.
+	(*rep_stossi_rex64): Likewise.
+	(*rep_stosqi): Likewise.
+	(*rep_stosqi_rex64): Likewise.
+	(*cmpstrnqi_nz_1): Use {%;} after repz.
+	(*cmpstrnqi_nz_rex_1): Likewise.
+	(*cmpstrnqi_1): Likewise.
+	(*cmpstrnqi_rex_1): Likewise.
+	(*strlenqi_1): Use {%;} after repnz.
+	(*strlenqi_rex_1): Likewise.
+	* config/i386/sync.md (memory_barrier_nosse): Replace {%;| } by {%;} .
+	(*sync_compare_and_swap<mode>): Likewise.
+	(sync_double_compare_and_swap<mode>): Likewise.
+	(*sync_double_compare_and_swapdi_pic): Likewise.
+	(sync_old_add<mode>): Likewise.
+	(sync_add<mode>): Likewise.
+	(sync_sub<mode>): Likewise.
+	(sync_<code><mode>): Likewise.
+
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* doc/sourcebuild.texi (Directives): Document optional
+	dg-require-effective-target selector.
+
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* configure.ac (gcc_cv_as_hidden): Check for Solaris 9/x86 as
+	hidden alias bug.
+	(gcc_cv_as_ix86_quad): Check for .quad directive.
+	* configure: Regenerate.
+	* config.in: Regenerate.
+	* config/i386/sol2.h (ASM_QUAD): Change guard to !HAVE_AS_IX86_QUAD.
+
+2010-05-17  Alan Modra  <amodra@gmail.com>
+
+	* config/rs6000/rs6000.c (rs6000_emit_allocate_stack): Delete
+	unnecessary prototype.  Replace copy_r12 and copy_r11 flag params
+	with copy_reg rtx param.
+	(rs6000_emit_prologue): Update rs6000_emit_allocate_stack calls.
+	Correct cases where code for ABI_V4 did not initialise the reg
+	used to access frame.  Also leave frame_reg_rtx as sp for large
+	frames that save no regs.
+
+2010-05-12  Jakub Jelinek  <jakub@redhat.com>
+
+	PR middle-end/44085
+	* gimplify.c (enum omp_region_type): Add ORT_UNTIED_TASK,
+	change value of ORT_TASK.
+	(new_omp_context): Handle ORT_UNTIED_TASK like ORT_TASK.
+	(omp_notice_threadprivate_variable): New function.
+	(omp_notice_variable): Call it for threadprivate variables.
+	If enclosing ctx is a task, print enclosing task rather than
+	enclosing parallel.  Handle ORT_UNTIED_TASK like ORT_TASK.
+	(gimplify_omp_task): Pass ORT_UNTIED_TASK instead of ORT_TASK
+	if task has untied clause.
+
+2010-05-07  Ralf Wildenhues  <Ralf.Wildenhues@gmx.de>
+
+	PR documentation/44016
+	* doc/standards.texi (Standards): Link to unversioned
+	cxx0x_status.html page.
+
+2010-05-05  Kaz Kojima  <kkojima@gcc.gnu.org>
+
+	Backport from mainline:
+	2010-04-22  Kaz Kojima  <kkojima@gcc.gnu.org>
+
+	PR target/43744
+	* config/sh/sh.c (find_barrier): Don't emit a constant pool
+	in the middle of insns for casesi_worker_2.
+
+2010-05-05  Jason Merrill  <jason@redhat.com>
+
+	PR debug/43370
+	* c-common.c (handle_aligned_attribute): Respect
+	ATTR_FLAG_TYPE_IN_PLACE.
+
+2010-05-04  H.J. Lu  <hongjiu.lu@intel.com>
+
+	Backport from mainline
+	2010-05-04  H.J. Lu  <hongjiu.lu@intel.com>
+
+	PR middle-end/43671
+	* alias.c (true_dependence): Handle the same VALUE in x and mem.
+	(canon_true_dependence): Likewise.
+	(write_dependence_p): Likewise.
+
+2010-05-02  Uros Bizjak  <ubizjak@gmail.com>
+
+	* config/i386/i386.c (ix86_target_string): Output 'flags', not 'isa',
+	when processing flag options.
+
+2010-04-30  Eric Botcazou  <ebotcazou@adacore.com>
+
+	* tree-ssa-loop-ivopts.c (may_be_unaligned_p): Check the alignment of
+	the variable part of the offset as well.  Use highest_pow2_factor for
+	all alignment checks.
+
+2010-04-30  Jakub Jelinek  <jakub@redhat.com>
+
+	PR c/43893
+	* c-omp.c (c_finish_omp_for): Handle also EQ_EXPR.
+
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	* BASE-VER: Set to 4.4.5.
+	* DEV-PHASE: Set to prerelease.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
@@ -72,8 +274,8 @@
 2010-04-08  Wolfgang Gellerich  <gellerich@de.ibm.com>
 
 	* config/s390/s390.c (override_options): Adjust the z10
-          defaults for max-unroll-times, max-completely-peeled-insns
-          and max-completely-peel-times.
+	defaults for max-unroll-times, max-completely-peeled-insns
+	and max-completely-peel-times.
 
 2010-04-08  Wolfgang Gellerich  <gellerich@de.ibm.com>
 
Index: gcc/testsuite/gcc.c-torture/execute/20100430-1.c
===================================================================
--- gcc/testsuite/gcc.c-torture/execute/20100430-1.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.c-torture/execute/20100430-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,51 @@
+/* This used to generate unaligned accesses at -O2 because of IVOPTS.  */
+
+struct packed_struct
+{
+  struct packed_struct1
+  {
+    unsigned char cc11;
+    unsigned char cc12;
+  } __attribute__ ((packed)) pst1;
+  struct packed_struct2
+  {
+    unsigned char cc21;
+    unsigned char cc22;
+    unsigned short ss[104];
+    unsigned char cc23[13];
+  } __attribute__ ((packed)) pst2[4];
+} __attribute__ ((packed));
+
+typedef struct
+{
+  int ii;
+  struct packed_struct buf;
+} info_t;
+
+static unsigned short g;
+
+static void __attribute__((noinline))
+dummy (unsigned short s)
+{
+  g = s;
+}
+
+static int
+foo (info_t *info)
+{
+  int i, j;
+
+  for (i = 0; i < info->buf.pst1.cc11; i++)
+    for (j = 0; j < info->buf.pst2[i].cc22; j++)
+      dummy (info->buf.pst2[i].ss[j]);
+
+  return 0;
+}
+
+int main(void)
+{
+  info_t info;
+  info.buf.pst1.cc11 = 2;
+  info.buf.pst2[0].cc22 = info.buf.pst2[1].cc22 = 8;
+  return foo (&info);
+}
Index: gcc/testsuite/gcc.c-torture/execute/pr44202-1.c
===================================================================
--- gcc/testsuite/gcc.c-torture/execute/pr44202-1.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.c-torture/execute/pr44202-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,30 @@
+extern __attribute__ ((__noreturn__)) void exit(int);
+extern __attribute__ ((__noreturn__)) void abort(void);
+__attribute__ ((__noinline__))
+int
+add512(int a, int *b)
+{
+  int c = a + 512;
+  if (c != 0)
+    *b = a;
+  return c;
+}
+
+__attribute__ ((__noinline__))
+int
+add513(int a, int *b)
+{
+  int c = a + 513;
+  if (c == 0)
+    *b = a;
+  return c;
+}
+
+int main(void)
+{
+  int b0 = -1;
+  int b1 = -1;
+  if (add512(-512, &b0) != 0 || b0 != -1 || add513(-513, &b1) != 0 || b1 != -513)
+    abort ();
+  exit (0);
+}
Index: gcc/testsuite/gcc.c-torture/compile/pr43845.c
===================================================================
--- gcc/testsuite/gcc.c-torture/compile/pr43845.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.c-torture/compile/pr43845.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,12 @@
+typedef int __attribute__ ((const)) (*x264_pixel_cmp_t)(void);
+
+typedef struct {
+    x264_pixel_cmp_t ssd;
+} x264_pixel_function_t;
+
+int x264_pixel_ssd_wxh (x264_pixel_function_t *pf, int i_width) {
+    int i_ssd = 0, x;
+    for (x = 0; x < i_width; x++)
+      i_ssd += pf->ssd();
+    return i_ssd;
+}
Index: gcc/testsuite/gcc.target/i386/20060512-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/20060512-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/20060512-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-std=gnu99 -msse2 -mstackrealign -mpreferred-stack-boundary=4" } */
 
 #include "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/crc32-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/crc32-4.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.target/i386/crc32-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,9 @@
+/* { dg-do compile } */
+/* { dg-options "-O2 -mno-sse4.2" } */
+/* { dg-final { scan-assembler "__builtin_ia32_crc32di" } } */
+
+unsigned long long
+crc32d (unsigned long long x, unsigned long long y)
+{
+  return __builtin_ia32_crc32di (x, y);
+}
Index: gcc/testsuite/gcc.target/i386/sse2-pminub-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pminub-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pminub-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/i386.exp
===================================================================
--- gcc/testsuite/gcc.target/i386/i386.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/i386.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -24,6 +24,29 @@
 # Load support procs.
 load_lib gcc-dg.exp
 
+# Return 1 if 3dnow instructions can be compiled.
+proc check_effective_target_3dnow { } {
+    return [check_no_compiler_messages 3dnow object {
+	void _m_pfadd (void)
+	{
+	    __builtin_ia32_pfadd();
+	}
+    } "-O2 -m3dnow" ]
+}
+
+# Return 1 if sse3 instructions can be compiled.
+proc check_effective_target_sse3 { } {
+    return [check_no_compiler_messages sse3 object {
+	typedef double __m128d __attribute__ ((__vector_size__ (16)));
+	typedef double __v2df __attribute__ ((__vector_size__ (16)));
+
+	__m128d _mm_addsub_pd (__m128d __X, __m128d __Y)
+	{
+	    return (__m128d) __builtin_ia32_addsubpd ((__v2df)__X, (__v2df)__Y);
+	}
+    } "-O2 -msse3" ]
+}
+
 # Return 1 if ssse3 instructions can be compiled.
 proc check_effective_target_ssse3 { } {
     return [check_no_compiler_messages ssse3 object {
Index: gcc/testsuite/gcc.target/i386/sse2-pslldq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pslldq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pslldq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-cvtsi2sd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtsi2sd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtsi2sd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-minsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-minsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-minsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr40906-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr40906-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr40906-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run { target *-*-linux* } } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -fomit-frame-pointer -msse2 -mpush-args -mno-accumulate-outgoing-args" } */
 
 #include "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse-15.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-15.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-15.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 /* Test that the intrinsics compile with optimization.  These were not
    tested in i386-sse-[12].c because these builtins require immediate
Index: gcc/testsuite/gcc.target/i386/sse2-cvttsd2si-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvttsd2si-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvttsd2si-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target lp64 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-pcmpgtd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pcmpgtd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pcmpgtd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-init-v2di-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-init-v2di-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-init-v2di-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-punpcklbw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpcklbw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpcklbw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrlw-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrlw-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrlw-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-shufps-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-shufps-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-shufps-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr23570.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr23570.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr23570.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef float __v4sf __attribute__ ((__vector_size__ (16)));
 typedef float __m128 __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/fpcvt-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/fpcvt-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/fpcvt-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler-not "cvtss2sd" } } */
 extern double fabs (double);
 float a,b;
Index: gcc/testsuite/gcc.target/i386/pr42542-3a.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr42542-3a.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr42542-3a.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O1 -msse2 -ftree-vectorize" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "pr42542-3.c"
 
Index: gcc/testsuite/gcc.target/i386/pr39445.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr39445.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr39445.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-Os -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/opt-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/opt-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/opt-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2,6 +2,7 @@
    whether we vectorize a simple loop.  */
 /* { dg-do compile } */
 /* { dg-options "-O1 -msse2 -mfpmath=sse -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "prefetcht0" } } */
 /* { dg-final { scan-assembler "addps" } } */
 /* { dg-final { scan-assembler "subss" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-pmaxub-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmaxub-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmaxub-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-maxsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-maxsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-maxsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pmaddwd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmaddwd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmaddwd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-punpcklqdq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpcklqdq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpcklqdq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movntpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movntpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movntpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-set-v16qi-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v16qi-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v16qi-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/sse-17.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-17.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-17.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #include "sse2-check.h"
 #include <xmmintrin.h>
 extern void abort();
Index: gcc/testsuite/gcc.target/i386/vararg-7.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vararg-7.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vararg-7.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <stdarg.h>
 #include <assert.h>
Index: gcc/testsuite/gcc.target/i386/sse2-shufpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-shufpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-shufpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psllq-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psllq-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psllq-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-cvtss2sd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtss2sd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtss2sd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-vec-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-vec-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-vec-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-psubsw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psubsw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psubsw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-punpckhwd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpckhwd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpckhwd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/ssefp-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssefp-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssefp-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "maxsd" } } */
 /* { dg-final { scan-assembler "minsd" } } */
 double x;
Index: gcc/testsuite/gcc.target/i386/sse3-addsubps.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-addsubps.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-addsubps.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse3-lddqu.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-lddqu.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-lddqu.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/float128-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/float128-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/float128-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run { target *-*-linux* } } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/vecinit-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vecinit-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vecinit-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #define vector __attribute__((vector_size(16)))
 
 int a;
Index: gcc/testsuite/gcc.target/i386/pr35767-2d.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-2d.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-2d.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-psubq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psubq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psubq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrlq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrlq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrlq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/fpprec-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/fpprec-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/fpprec-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -fno-math-errno -fno-trapping-math -msse2 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/pr40809.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr40809.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr40809.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -ftree-vectorize -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-mulsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-mulsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-mulsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse3-addsubpd.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-addsubpd.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-addsubpd.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse-19.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-19.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-19.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O3 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "punpcklbw" } } */
 extern void abort();
 #include <emmintrin.h>
Index: gcc/testsuite/gcc.target/i386/sse2-pminsw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pminsw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pminsw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-vec-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-vec-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-vec-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-psraw-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psraw-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psraw-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movupd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movupd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movupd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psubb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psubb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psubb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vecinit-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vecinit-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vecinit-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #define vector __attribute__((vector_size(16)))
 
 short a;
Index: gcc/testsuite/gcc.target/i386/sse2-xorpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-xorpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-xorpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pavgb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pavgb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pavgb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/incoming-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/incoming-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/incoming-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do compile { target { { ! *-*-darwin* } && ilp32 } } } */
 /* { dg-options "-w -msse2 -mpreferred-stack-boundary=2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-paddq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr35767-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/vectorize2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vectorize2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vectorize2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -ffast-math -ftree-vectorize -msse2 -mfpmath=sse" } */
 
 double a[256];
Index: gcc/testsuite/gcc.target/i386/sse2-cvtpd2dq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtpd2dq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtpd2dq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr28839.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr28839.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr28839.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -ftree-vectorize -funswitch-loops" } */
+/* { dg-require-effective-target sse2 } */
 
 static int ready[10];
 void abort (void);
Index: gcc/testsuite/gcc.target/i386/pr36222-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr36222-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr36222-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef long long __m128i __attribute__ ((__vector_size__ (16), __may_alias__));
 typedef int __v4si __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/sse2-movdqu-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movdqu-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movdqu-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr37434-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr37434-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr37434-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef short __v8hi __attribute__ ((__vector_size__ (16)));
 typedef long long __m128i __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/sse2-pmaxsw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmaxsw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmaxsw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pcmpgtw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pcmpgtw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pcmpgtw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/3dnowA-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/3dnowA-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/3dnowA-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do assemble } */
+/* { dg-require-effective-target 3dnow } */
 /* { dg-options "-O0 -Werror-implicit-function-declaration -march=k8 -m3dnow" } */
 
 /* Test that the intrinsics compile without optimization.  All of them are
Index: gcc/testsuite/gcc.target/i386/sse2-vec-6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-vec-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-vec-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/ssetype-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssetype-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssetype-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "andpd" } } */
 /* { dg-final { scan-assembler "andnpd" } } */
 /* { dg-final { scan-assembler "xorpd" } } */
Index: gcc/testsuite/gcc.target/i386/pr35767-1i.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-1i.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-1i.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-pshufd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pshufd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pshufd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vecinit-6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vecinit-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vecinit-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #define vector __attribute__((vector_size(16)))
 
 int a, b;
Index: gcc/testsuite/gcc.target/i386/pr41019.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr41019.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr41019.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2 -ftree-vectorize" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-paddb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/incoming-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/incoming-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/incoming-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do compile { target { { ! *-*-darwin* } && ilp32 } } } */
 /* { dg-options "-w -msse2 -mpreferred-stack-boundary=2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-cvtsd2si-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtsd2si-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtsd2si-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/math-torture/math-torture.exp
===================================================================
--- gcc/testsuite/gcc.target/i386/math-torture/math-torture.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/math-torture/math-torture.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,7 @@
 # This harness is for tests that should be run at all optimisation levels.
 
+load_lib target-supports.exp
+
 # Exit immediately if this isn't a x86 target.
 if { ![istarget i?86*-*-*] && ![istarget x86_64-*-*] } then {
   return
@@ -9,27 +11,31 @@
         { -O0 } \
         { -O0 -mfpmath=387 } \
         { -O0 -msse -mno-sse2 -mfpmath=sse } \
-        { -O0 -msse -msse2 -mfpmath=sse } \
         { -O0 -msse -mno-sse2 -mfpmath=sse,387 } \
-        { -O0 -msse -msse2 -mfpmath=sse,387 } \
         { -O0 -mfpmath=387 -ffast-math } \
         { -O0 -msse -mno-sse2 -mfpmath=sse -ffast-math } \
-        { -O0 -msse -msse2 -mfpmath=sse -ffast-math } \
         { -O0 -msse -mno-sse2 -mfpmath=sse,387 -ffast-math } \
-        { -O0 -msse -msse2 -mfpmath=sse,387 -ffast-math } \
         { -O2 } \
         { -O2 -mfpmath=387 } \
         { -O2 -msse -mno-sse2 -mfpmath=sse } \
-        { -O2 -msse -msse2 -mfpmath=sse } \
         { -O2 -msse -mno-sse2 -mfpmath=sse,387 } \
-        { -O2 -msse -msse2 -mfpmath=sse,387 } \
         { -O2 -mfpmath=387 -ffast-math } \
         { -O2 -msse -mno-sse2 -mfpmath=sse -ffast-math } \
-        { -O2 -msse -msse2 -mfpmath=sse -ffast-math } \
         { -O2 -msse -mno-sse2 -mfpmath=sse,387 -ffast-math } \
-        { -O2 -msse -msse2 -mfpmath=sse,387 -ffast-math } \
 ]
 
+if { [check_effective_target_sse2] } {
+    lappend MATH_TORTURE_OPTIONS \
+        { -O0 -msse -msse2 -mfpmath=sse } \
+        { -O0 -msse -msse2 -mfpmath=sse,387 } \
+        { -O0 -msse -msse2 -mfpmath=sse -ffast-math } \
+        { -O0 -msse -msse2 -mfpmath=sse,387 -ffast-math } \
+        { -O2 -msse -msse2 -mfpmath=sse } \
+        { -O2 -msse -msse2 -mfpmath=sse,387 } \
+        { -O2 -msse -msse2 -mfpmath=sse -ffast-math } \
+        { -O2 -msse -msse2 -mfpmath=sse,387 -ffast-math } \
+}
+
 load_lib gcc-dg.exp
 load_lib torture-options.exp
 
Index: gcc/testsuite/gcc.target/i386/sse2-addpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-addpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-addpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pslld-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pslld-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pslld-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr35767-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target dfp } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O -msse2 -std=gnu99" } */
 
 #include "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vectorize4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vectorize4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vectorize4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -ffast-math -ftree-vectorize -msse2 --param ggc-min-expand=0 --param ggc-min-heapsize=0" } */
 /* This test, tests two thing, we vectorize square root and also we don't crash due to a GC issue.  */
 
Index: gcc/testsuite/gcc.target/i386/sseregparm-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sseregparm-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sseregparm-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* { dg-options "-msse2 -O2" } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 
 /* Make sure we know that mysinfp returns in %xmm0.  */
 
Index: gcc/testsuite/gcc.target/i386/sse2-cvtpd2ps-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtpd2ps-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtpd2ps-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-set-v8hi-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v8hi-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v8hi-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/sse2-packssdw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-packssdw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-packssdw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr42549.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr42549.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr42549.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target 3dnow } */
 /* { dg-options "-O2 -m3dnow" } */
 
 #include "mmx-3dnow-check.h"
Index: gcc/testsuite/gcc.target/i386/ssetype-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssetype-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssetype-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "andps" } } */
 /* { dg-final { scan-assembler "andnps" } } */
 /* { dg-final { scan-assembler "xorps" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-movapd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movapd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movapd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movlpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movlpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movlpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psubd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psubd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psubd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrld-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrld-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrld-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr36578-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr36578-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr36578-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* Test for unsafe floating-point conversions.  */
 /* { dg-do run } */
 /* { dg-options "-msse2 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/pr32000-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr32000-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr32000-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do run } */
 /* { dg-require-effective-target dfp } */
 /* { dg-options "-O -msse2 -std=gnu99" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-lrint-vec.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-lrint-vec.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-lrint-vec.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -ffast-math -ftree-vectorize -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-pand-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pand-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pand-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movq-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movq-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movq-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target lp64 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/pr39496.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr39496.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr39496.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR target/39496 */
 /* { dg-do compile { target { { i?86-*-linux* x86_64-*-linux* } && ilp32 } } } */
 /* { dg-options "-O0 -fverbose-asm -fno-omit-frame-pointer -mtune=i686 -msse2 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 /* Verify that {foo,bar}{,2}param are all passed on the stack, using
    normal calling conventions, when not optimizing.  */
 /* { dg-final { scan-assembler "\[^0-9-\]8\\(%ebp\\),\[^\n\]*fooparam," } } */
Index: gcc/testsuite/gcc.target/i386/pr35767-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* Test that we generate aligned load when memory is aligned.  */
 /* { dg-do compile } */
 /* { dg-options "-O -msse2 -mtune=generic" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler-not "movups" } } */
 /* { dg-final { scan-assembler "movaps" } } */
 
Index: gcc/testsuite/gcc.target/i386/vectorize6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vectorize6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vectorize6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -ftree-vectorize -mveclibabi=svml -ffast-math" } */
+/* { dg-require-effective-target sse2 } */
 
 double x[256];
 
Index: gcc/testsuite/gcc.target/i386/sse2-paddsb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddsb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddsb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sseregparm-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sseregparm-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sseregparm-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* { dg-options "-msse2 -O2" } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 
 /* Make sure we know that mysinfp returns in %xmm0.  */
 
Index: gcc/testsuite/gcc.target/i386/sse2-unpckhpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-unpckhpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-unpckhpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse-10.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-10.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-10.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2,6 +2,7 @@
 /* { dg-do run } */
 /* { dg-options "-O1 -msse2 -mfpmath=sse -mno-accumulate-outgoing-args -fno-omit-frame-pointer -mno-omit-leaf-frame-pointer" } */
 /* { dg-options "-O1 -msse2 -mfpmath=sse -fno-omit-frame-pointer" { target *-*-mingw* *-*-cygwin* } } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-cvtps2dq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtps2dq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtps2dq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr39162.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr39162.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr39162.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -mno-avx" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef long long __m256i __attribute__ ((__vector_size__ (32), __may_alias__));
 
Index: gcc/testsuite/gcc.target/i386/sse2-pshufhw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pshufhw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pshufhw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-andpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-andpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-andpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-ucomisd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-ucomisd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-ucomisd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-set-v8hi-2a.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v8hi-2a.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v8hi-2a.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -mtune=core2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/pr42542-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr42542-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr42542-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O1 -msse2 -ftree-vectorize" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-paddd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-comisd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-comisd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-comisd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movmskpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movmskpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movmskpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr37101.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr37101.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr37101.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -ftree-vectorize -march=nocona" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef __SIZE_TYPE__ size_t;
 extern void *malloc (size_t);
Index: gcc/testsuite/gcc.target/i386/sse2-divpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-divpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-divpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-set-epi64x-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-epi64x-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-epi64x-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-init-v4si-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-init-v4si-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-init-v4si-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sseregparm-7.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sseregparm-7.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sseregparm-7.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* { dg-options "-msse2 -O2" } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 
 /* Make sure we know that mysinfp returns in %xmm0.  */
 
Index: gcc/testsuite/gcc.target/i386/sse3-movshdup.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-movshdup.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-movshdup.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/quad-sse.c
===================================================================
--- gcc/testsuite/gcc.target/i386/quad-sse.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/quad-sse.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 __float128 x, y;
 
Index: gcc/testsuite/gcc.target/i386/pr42881.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr42881.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr42881.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,8 @@
 /* PR target/42881 */
 /* { dg-do run } */
 /* { dg-options "-O0 -msse2" } */
+/* { dg-require-effective-target sse2 } */
+
 #include "sse2-check.h"
 static void
 sse2_test (void)
Index: gcc/testsuite/gcc.target/i386/sse2-paddusb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddusb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddusb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vararg-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vararg-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vararg-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2,6 +2,7 @@
 /* { dg-do run } */
 /* { dg-options "-w" { target { lp64 } } } */
 /* { dg-options "-w -msse2 -mpreferred-stack-boundary=2" { target { ilp32 } } } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 #include <stdarg.h>
Index: gcc/testsuite/gcc.target/i386/sse2-pmulhw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmulhw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmulhw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/3dnow-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/3dnow-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/3dnow-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do assemble } */
+/* { dg-require-effective-target 3dnow } */
 /* { dg-options "-O2 -Werror-implicit-function-declaration -m3dnow" } */
 
 /* Test that the intrinsics compile with optimization.  All of them are
Index: gcc/testsuite/gcc.target/i386/sse2-movdqa-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movdqa-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movdqa-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-punpckhdq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpckhdq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpckhdq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/xorps.c
===================================================================
--- gcc/testsuite/gcc.target/i386/xorps.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/xorps.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-Os -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef float __m128 __attribute__ ((vector_size (16)));
 
Index: gcc/testsuite/gcc.target/i386/sse2-movd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-ucomisd-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-ucomisd-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-ucomisd-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrad-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrad-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrad-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-cvttpd2dq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvttpd2dq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvttpd2dq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-comisd-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-comisd-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-comisd-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movhpd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movhpd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movhpd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -mfpmath=sse -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/crc32-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/crc32-3.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.target/i386/crc32-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,10 @@
+/* { dg-do compile } */
+/* { dg-require-effective-target ilp32 } */
+/* { dg-options "-O2 -msse4.2" } */
+/* { dg-final { scan-assembler "__builtin_ia32_crc32di" } } */
+
+unsigned long long
+crc32d (unsigned long long x, unsigned long long y)
+{
+  return __builtin_ia32_crc32di (x, y);
+}
Index: gcc/testsuite/gcc.target/i386/sse2-packsswb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-packsswb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-packsswb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psllw-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psllw-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psllw-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse3-hsubps.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-hsubps.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-hsubps.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-pcmpeqb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pcmpeqb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pcmpeqb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-cvtps2pd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtps2pd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtps2pd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-punpcklwd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpcklwd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpcklwd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vararg-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vararg-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vararg-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <stdarg.h>
 #include <assert.h>
Index: gcc/testsuite/gcc.target/i386/sse2-cvttsd2si-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvttsd2si-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvttsd2si-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse3-hsubpd.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-hsubpd.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-hsubpd.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-psubw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psubw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psubw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrlw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrlw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrlw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr26600.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr26600.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr26600.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O -ftree-vectorize -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 void foo(int *p, int N)
 {
Index: gcc/testsuite/gcc.target/i386/sse2-ucomisd-6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-ucomisd-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-ucomisd-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/fpcvt-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/fpcvt-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/fpcvt-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler-not "cvtss2sd" } } */
 float a,b;
 main()
Index: gcc/testsuite/gcc.target/i386/sse2-addsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-addsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-addsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-comisd-6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-comisd-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-comisd-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pavgw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pavgw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pavgw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/ssefn-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssefn-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssefn-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -3,6 +3,7 @@
 
 /* { dg-do compile } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "movss" } } */
 /* { dg-final { scan-assembler "mulss" } } */
 /* { dg-final { scan-assembler "movsd" } } */
Index: gcc/testsuite/gcc.target/i386/xorps-sse2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/xorps-sse2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/xorps-sse2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* Test that we generate xorps when the result is used in FP math.  */
 /* { dg-do compile } */
 /* { dg-options "-O -msse2 -mno-sse3" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "xorps\[ \t\]" { xfail *-*-* } } } */
 /* { dg-final { scan-assembler-not "pxor" { xfail *-*-* } } } */
 
Index: gcc/testsuite/gcc.target/i386/sse2-unpack-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-unpack-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-unpack-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/opt-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/opt-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/opt-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2,6 +2,7 @@
    whether we vectorize a simple loop.  */
 /* { dg-do compile } */
 /* { dg-options "-O1 -msse2 -mfpmath=sse -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "prefetcht0" } } */
 /* { dg-final { scan-assembler "addps" } } */
 /* { dg-final { scan-assembler "subss" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-cvtsi2sd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtsi2sd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtsi2sd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target lp64 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-set-v16qi-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v16qi-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v16qi-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/pr33329.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr33329.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr33329.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -ftree-vectorize -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 extern void g (int *);
 
Index: gcc/testsuite/gcc.target/i386/sse2-psllq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psllq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psllq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse3-haddps.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-haddps.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-haddps.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-vec-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-vec-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-vec-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/pr27790.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr27790.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr27790.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O -ftree-vectorize -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 void binarize (int npixels, unsigned char *b)
 {
Index: gcc/testsuite/gcc.target/i386/pr35767-1d.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-1d.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-1d.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-paddw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/ssefn-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssefn-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssefn-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -3,6 +3,7 @@
 
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse-vect-types.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-vect-types.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-vect-types.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O0 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <xmmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/vecinit-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vecinit-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vecinit-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #define vector __attribute__((vector_size(16)))
 
 float a;
Index: gcc/testsuite/gcc.target/i386/sse3-haddpd.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-haddpd.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-haddpd.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-cvttps2dq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvttps2dq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvttps2dq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr32661.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr32661.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr32661.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef int __v4si __attribute__ ((__vector_size__ (16)));
 typedef float __v4sf __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/sse2-pcmpeqd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pcmpeqd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pcmpeqd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-set-v16qi-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v16qi-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v16qi-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/sse2-mmx.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-mmx.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-mmx.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse-18.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-18.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-18.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O3 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/pr18614-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr18614-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr18614-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR rtl-optimization/18614 */
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef double v2df __attribute__ ((vector_size (16)));
 
Index: gcc/testsuite/gcc.target/i386/vararg-8.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vararg-8.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vararg-8.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <stdarg.h>
 #include <assert.h>
Index: gcc/testsuite/gcc.target/i386/sse2-divsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-divsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-divsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-punpckhqdq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpckhqdq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpckhqdq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-vec-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-vec-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-vec-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-psraw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psraw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psraw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/ssefp-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssefp-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssefp-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "maxsd" } } */
 /* { dg-final { scan-assembler "minsd" } } */
 double x;
Index: gcc/testsuite/gcc.target/i386/sse2-movupd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movupd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movupd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr30970.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr30970.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr30970.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile }
 /* { dg-options "-msse2 -O2 -ftree-vectorize" } */
+/* { dg-require-effective-target sse2 } */
 
 #define N 256
 int b[N];
Index: gcc/testsuite/gcc.target/i386/float128-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/float128-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/float128-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2,6 +2,7 @@
 
 /* { dg-do run { target *-*-linux* *-*-darwin* } } */
 /* { dg-options "-Os -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/vecinit-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vecinit-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vecinit-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #define vector __attribute__((vector_size(16)))
 
 char a;
Index: gcc/testsuite/gcc.target/i386/sse2-punpckhbw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpckhbw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpckhbw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrlq-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrlq-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrlq-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrldq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrldq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrldq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-paddsw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddsw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddsw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr22152.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr22152.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr22152.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <mmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-packuswb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-packuswb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-packuswb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr37843-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr37843-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr37843-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* Test for stack alignment with sibcall optimization.  */
 /* { dg-do compile { target { ilp32 && nonpic } } } */
 /* { dg-options "-O2 -msse2 -mpreferred-stack-boundary=4 -mstackrealign" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler-not "andl\[\\t \]*\\$-16,\[\\t \]*%\[re\]?sp" } } */
 /* { dg-final { scan-assembler-not "call\[\\t \]*foo" } } */
 /* { dg-final { scan-assembler "jmp\[\\t \]*foo" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-pshuflw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pshuflw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pshuflw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-andnpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-andnpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-andnpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movdqu-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movdqu-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movdqu-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr23575.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr23575.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr23575.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-msse2 -O2" } */
+/* { dg-require-effective-target sse2 } */
 
 /* We used to ICE because of a bogous pattern.  */
 
Index: gcc/testsuite/gcc.target/i386/sse2-vec-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-vec-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-vec-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/3dnowA-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/3dnowA-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/3dnowA-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do assemble } */
+/* { dg-require-effective-target 3dnow } */
 /* { dg-options "-O2 -Werror-implicit-function-declaration -march=k8 -m3dnow" } */
 
 /* Test that the intrinsics compile with optimization.  All of them are
Index: gcc/testsuite/gcc.target/i386/ssetype-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssetype-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssetype-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* This test checks for absolute memory operands.  */
 /* { dg-require-effective-target nonpic } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
 /* { dg-final { scan-assembler "andpd\[^\\n\]*magic" } } */
 /* { dg-final { scan-assembler "andnpd\[^\\n\]*magic" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-cvtdq2ps-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtdq2ps-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtdq2ps-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-subpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-subpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-subpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-sqrtpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-sqrtpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-sqrtpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vecinit-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vecinit-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vecinit-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 #define vector __attribute__((vector_size(16)))
 
 float a, b;
Index: gcc/testsuite/gcc.target/i386/sse2-lrintf-vec.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-lrintf-vec.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-lrintf-vec.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -ffast-math -ftree-vectorize -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse3-movsldup.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-movsldup.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-movsldup.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-unpcklpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-unpcklpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-unpcklpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/incoming-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/incoming-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/incoming-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do compile { target { { ! *-*-darwin* } && ilp32 } } } */
 /* { dg-options "-w -msse2 -mpreferred-stack-boundary=2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-por-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-por-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-por-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-paddusw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-paddusw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-paddusw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pslld-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pslld-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pslld-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pmullw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmullw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmullw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr35767-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/vectorize3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vectorize3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vectorize3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -ffast-math -ftree-vectorize -msse2 -mfpmath=sse" } */
 
 float a[256];
Index: gcc/testsuite/gcc.target/i386/sse2-set-v8hi-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v8hi-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v8hi-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/pr37434-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr37434-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr37434-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -mtune=core2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef short __v8hi __attribute__ ((__vector_size__ (16)));
 typedef long long __m128i __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/pr35714.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35714.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35714.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-psadbw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psadbw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psadbw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/ssetype-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssetype-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssetype-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* This test checks for absolute memory operands.  */
 /* { dg-require-effective-target nonpic } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
 /* { dg-final { scan-assembler "andps\[^\\n\]*magic" } } */
 /* { dg-final { scan-assembler "andnps\[^\\n\]*magic" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-movapd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movapd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movapd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-cvtdq2pd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtdq2pd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtdq2pd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-minpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-minpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-minpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/unordcmp-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/unordcmp-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/unordcmp-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "cmpunordss" } } */
 /* { dg-final { scan-assembler "cmpunordps" } } */
 /* { dg-final { scan-assembler "cmpunordsd" } } */
Index: gcc/testsuite/gcc.target/i386/pr36578-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr36578-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr36578-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* Test for unsafe floating-point conversions.  PR 36578.  */
 /* { dg-do run } */
 /* { dg-options "-msse2 -mfpmath=sse" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/pr35767-2i.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr35767-2i.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr35767-2i.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-psubsb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psubsb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psubsb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr32961.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr32961.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr32961.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O0 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <xmmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-movq-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movq-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movq-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target lp64 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* This testcase caused a buffer overflow in simplify_immed_subreg.  */
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/incoming-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/incoming-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/incoming-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do compile { target { { ! *-*-darwin* } && ilp32 } } } */
 /* { dg-options "-w -msse2 -mpreferred-stack-boundary=2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <stdarg.h>
 #include <emmintrin.h>
Index: gcc/testsuite/gcc.target/i386/sse2-cvtsd2si-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtsd2si-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtsd2si-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-require-effective-target lp64 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-set-epi32-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-epi32-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-epi32-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-pcmpeqw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pcmpeqw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pcmpeqw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse3-movddup.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse3-movddup.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse3-movddup.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do run } */
+/* { dg-require-effective-target sse3 } */
 /* { dg-options "-O2 -msse3 -mfpmath=sse" } */
 
 #ifndef CHECK_H
Index: gcc/testsuite/gcc.target/i386/sse2-pmovmskb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmovmskb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmovmskb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-punpckldq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-punpckldq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-punpckldq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sseregparm-4.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sseregparm-4.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sseregparm-4.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* { dg-options "-msse2 -O2" } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 
 /* Make sure we know that mysinfp returns in %xmm0.  */
 
Index: gcc/testsuite/gcc.target/i386/pr43671.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr43671.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.target/i386/pr43671.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,27 @@
+/* { dg-do run } */
+/* { dg-require-effective-target ilp32 } */
+/* { dg-options "-mtune=i686 -O1 -fpeel-loops -fschedule-insns2 -ftree-vectorize -fsched2-use-superblocks" } */
+
+extern void abort ();
+
+int main ()
+{
+  struct {
+    char ca[16];
+  } s;
+  int i;
+
+  for (i = 0; i < 16; i++)
+    {
+      s.ca[i] = 5;
+    }
+
+
+  for (i = 0; i < 16; i++)
+    {
+      if (s.ca[i] != 5)
+        abort ();
+    }
+
+  return 0;
+}
Index: gcc/testsuite/gcc.target/i386/ssetype-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ssetype-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ssetype-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* This test checks for absolute memory operands.  */
 /* { dg-require-effective-target nonpic } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
 /* { dg-final { scan-assembler "pand\[^\\n\]*magic" } } */
 /* { dg-final { scan-assembler "pandn\[^\\n\]*magic" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-movlpd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movlpd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movlpd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-init-v16qi-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-init-v16qi-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-init-v16qi-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-set-v8hi-1a.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-set-v8hi-1a.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-set-v8hi-1a.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -mtune=core2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #define CHECK_H "sse2-check.h"
 #define TEST sse2_test
Index: gcc/testsuite/gcc.target/i386/sse2-maxpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-maxpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-maxpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-psrld-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrld-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrld-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr32000-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr32000-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr32000-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do run } */
 /* { dg-skip-if "" { ! { ilp32 && dfp } } } */
 /* { dg-options "-O -msse2 -std=gnu99 -mpreferred-stack-boundary=2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-ucomisd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-ucomisd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-ucomisd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr42542-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr42542-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr42542-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O1 -msse2 -ftree-vectorize" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-comisd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-comisd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-comisd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse-6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/ordcmp-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/ordcmp-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/ordcmp-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler "cmpordss" } } */
 /* { dg-final { scan-assembler "cmpordps" } } */
 /* { dg-final { scan-assembler "cmpordsd" } } */
Index: gcc/testsuite/gcc.target/i386/sse2-pmulhuw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmulhuw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmulhuw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sseregparm-6.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sseregparm-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sseregparm-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* { dg-options "-msse2 -O2" } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 
 /* Make sure we know that mysinfp returns in %xmm0.  */
 
Index: gcc/testsuite/gcc.target/i386/push-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/push-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/push-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
 /* { dg-options "-w -msse2 -Os" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef float __m128 __attribute__ ((__vector_size__ (16), __may_alias__));
 
Index: gcc/testsuite/gcc.target/i386/pr26449-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr26449-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr26449-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -mtune=k8" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef short __v8hi __attribute__ ((__vector_size__ (16)));
 typedef long long __m128i __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/sse2-pmuludq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pmuludq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pmuludq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse-11.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse-11.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse-11.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR rtl-optimization/21239 */
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/vararg-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vararg-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vararg-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2,6 +2,7 @@
 /* { dg-do run } */
 /* { dg-options "-w" { target { lp64 } } } */
 /* { dg-options "-w -msse2 -mpreferred-stack-boundary=2" { target { ilp32 } } } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 #include <stdarg.h>
Index: gcc/testsuite/gcc.target/i386/sse2-cvtsd2ss-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-cvtsd2ss-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-cvtsd2ss-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-mulpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-mulpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-mulpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pcmpgtb-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pcmpgtb-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pcmpgtb-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-ucomisd-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-ucomisd-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-ucomisd-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr32280.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr32280.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr32280.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef long long __m128i __attribute__ ((__vector_size__ (16)));
 
Index: gcc/testsuite/gcc.target/i386/pr42542-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr42542-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr42542-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O1 -msse2 -ftree-vectorize" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-init-v8hi-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-init-v8hi-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-init-v8hi-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-comisd-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-comisd-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-comisd-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/20060512-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/20060512-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/20060512-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do run } */
 /* { dg-require-effective-target ilp32 } */
 /* { dg-options "-std=gnu99 -msse2 -mpreferred-stack-boundary=4" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "sse2-check.h"
 
Index: gcc/testsuite/gcc.target/i386/sse2-movhpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movhpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movhpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -mfpmath=sse -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr36992-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr36992-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr36992-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile }
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/gcc.target/i386/sse2-psllw-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psllw-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psllw-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/funcspec-9.c
===================================================================
--- gcc/testsuite/gcc.target/i386/funcspec-9.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/funcspec-9.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* Test whether using target specific options, we can generate SSE5 code.  */
 /* { dg-do compile } */
 /* { dg-options "-O2 -march=k8 -mfpmath=sse -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 extern void exit (int);
 
Index: gcc/testsuite/gcc.target/i386/sse2-subsd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-subsd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-subsd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movntdq-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movntdq-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movntdq-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pxor-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pxor-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pxor-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movsd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movsd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movsd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-pandn-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-pandn-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-pandn-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/vararg-3.c
===================================================================
--- gcc/testsuite/gcc.target/i386/vararg-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/vararg-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <stdarg.h>
 #include <assert.h>
Index: gcc/testsuite/gcc.target/i386/3dnow-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/3dnow-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/3dnow-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-do assemble } */
+/* { dg-require-effective-target 3dnow } */
 /* { dg-options "-O0 -Werror-implicit-function-declaration -m3dnow" } */
 
 /* Test that the intrinsics compile without optimization.  All of them are
Index: gcc/testsuite/gcc.target/i386/sse2-movdqa-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movdqa-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movdqa-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/reload-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/reload-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/reload-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O3 -msse2 -fdump-rtl-csa" } */
 
 #include <emmintrin.h>
Index: gcc/testsuite/gcc.target/i386/sse2-orpd-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-orpd-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-orpd-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-movd-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-movd-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-movd-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/sse2-ucomisd-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-ucomisd-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-ucomisd-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/fpcvt-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/fpcvt-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/fpcvt-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2 -march=k8" } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-final { scan-assembler-not "cvtss2sd" } } */
 float a,b;
 main()
Index: gcc/testsuite/gcc.target/i386/sse2-psrad-2.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-psrad-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-psrad-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr32708-1.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr32708-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr32708-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef long long __v2di __attribute__ ((__vector_size__ (16)));
 typedef long long __m128i __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/gcc.target/i386/sse2-comisd-5.c
===================================================================
--- gcc/testsuite/gcc.target/i386/sse2-comisd-5.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/sse2-comisd-5.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #ifndef CHECK_H
 #define CHECK_H "sse2-check.h"
Index: gcc/testsuite/gcc.target/i386/pr17692.c
===================================================================
--- gcc/testsuite/gcc.target/i386/pr17692.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.target/i386/pr17692.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile } */
 /* { dg-options "-O -mfpmath=sse -msse2" } */
+/* { dg-require-effective-target sse2 } */
 /* The fact that t1 and t2 are uninitialized is critical.  With them
    uninitialized, the register allocator is free to put them in the same
    hard register, which results in
Index: gcc/testsuite/ada/acats/run_acats
===================================================================
--- gcc/testsuite/ada/acats/run_acats	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/ada/acats/run_acats	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -5,10 +5,25 @@
    exit 1
 fi
 
+# Provide which replacement.
+#
+# type -p is missing from Solaris 2 /bin/sh and /bin/ksh (ksh88), but both
+# ksh93 and bash have it.
+# type output format differs between ksh88 and ksh93, so avoid it if
+# type -p is present.
+# Fall back to whence which ksh88 and ksh93 provide, but bash does not.
+
+which () {
+    type -p $* 2>/dev/null && return 0
+    type $* 2>/dev/null | awk '{print $3}' && return 0
+    whence $* 2>/dev/null && return 0
+    return 1
+}
+
 # Set up environment to use the Ada compiler from the object tree
 
-host_gnatchop=`type gnatchop | awk '{print $3}'`
-host_gnatmake=`type gnatmake | awk '{print $3}'`
+host_gnatchop=`which gnatchop`
+host_gnatmake=`which gnatmake`
 ROOT=`${PWDCMD-pwd}`
 BASE=`cd $ROOT/../../..; ${PWDCMD-pwd}`
 
Index: gcc/testsuite/gcc.dg/pr34856.c
===================================================================
--- gcc/testsuite/gcc.dg/pr34856.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/pr34856.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do compile } */
 /* { dg-options "-O2" } */
 /* { dg-options "-O2 -msse2" { target { i?86-*-* x86_64-*-* } } } */
+/* { dg-require-effective-target sse2 { target { i?86-*-* x86_64-*-* } } } */
 /* { dg-options "-O2 -maltivec" { target { powerpc*-*-linux* && powerpc_altivec_ok } } } */
 
 typedef unsigned __attribute__ ((__mode__ (__pointer__))) uintptr_t;
Index: gcc/testsuite/gcc.dg/gomp/pr44085.c
===================================================================
--- gcc/testsuite/gcc.dg/gomp/pr44085.c	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gcc.dg/gomp/pr44085.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,27 @@
+/* PR middle-end/44085 */
+/* { dg-do compile } */
+/* { dg-require-effective-target tls_native } */
+/* { dg-options "-fopenmp" } */
+
+int thr1, thr2;
+#pragma omp threadprivate (thr1, thr2)
+
+void
+foo (void)
+{
+#pragma omp task untied	/* { dg-error "enclosing task" } */
+  {
+    thr1++;		/* { dg-error "used in untied task" } */
+    thr2 |= 4;		/* { dg-error "used in untied task" } */
+  }
+}
+
+void
+bar (void)
+{
+#pragma omp task
+  {
+    thr1++;
+    thr2 |= 4;
+  }
+}
Index: gcc/testsuite/gcc.dg/torture/pr35771-1.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/pr35771-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/pr35771-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef float __m128 __attribute__ ((__vector_size__ (16), __may_alias__));
 
Index: gcc/testsuite/gcc.dg/torture/stackalign/vararg-3.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/stackalign/vararg-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/stackalign/vararg-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <stdarg.h>
 #include <emmintrin.h>
Index: gcc/testsuite/gcc.dg/torture/stackalign/push-1.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/stackalign/push-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/stackalign/push-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37010 */
 /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
 /* { dg-options "-msse2 -mpreferred-stack-boundary=2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 #include "cpuid.h"
Index: gcc/testsuite/gcc.dg/torture/stackalign/alloca-2.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/stackalign/alloca-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/stackalign/alloca-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 #include "cpuid.h"
Index: gcc/testsuite/gcc.dg/torture/stackalign/alloca-3.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/stackalign/alloca-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/stackalign/alloca-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR middle-end/37009 */
 /* { dg-do run { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 #include "cpuid.h"
Index: gcc/testsuite/gcc.dg/torture/pr35771-2.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/pr35771-2.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/pr35771-2.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef double __m128d __attribute__ ((__vector_size__ (16), __may_alias__));
 
Index: gcc/testsuite/gcc.dg/torture/pr16104-1.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/pr16104-1.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/pr16104-1.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR rtl-optimization/16104 */
 /* { dg-do run { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "cpuid.h"
 
Index: gcc/testsuite/gcc.dg/torture/pr35771-3.c
===================================================================
--- gcc/testsuite/gcc.dg/torture/pr35771-3.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/torture/pr35771-3.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef long long __m128i __attribute__ ((__vector_size__ (16), __may_alias__));
 
Index: gcc/testsuite/gcc.dg/pr37544.c
===================================================================
--- gcc/testsuite/gcc.dg/pr37544.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/pr37544.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* { dg-do run } */
 /* { dg-options "-O2" } */
 /* { dg-options "-O2 -msse2 -mtune=core2 -mfpmath=387" { target { i?86-*-* x86_64-*-* } } } */
+/* { dg-require-effective-target sse2 { target { i?86-*-* x86_64-*-* } } } */
 
 #ifdef __i386__
 #include "cpuid.h"
Index: gcc/testsuite/gcc.dg/tree-ssa/prefetch-6.c
===================================================================
--- gcc/testsuite/gcc.dg/tree-ssa/prefetch-6.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/tree-ssa/prefetch-6.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile { target i?86-*-* x86_64-*-* } } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -fprefetch-loop-arrays -march=athlon -msse2 -mfpmath=sse --param simultaneous-prefetches=100 -fdump-tree-aprefetch-details" } */
 
 #define N 1000
Index: gcc/testsuite/gcc.dg/tree-ssa/prefetch-7.c
===================================================================
--- gcc/testsuite/gcc.dg/tree-ssa/prefetch-7.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/tree-ssa/prefetch-7.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile { target i?86-*-* x86_64-*-* } } */
 /* { dg-require-effective-target ilp32 } */
+/* { dg-require-effective-target sse2 } */
 /* { dg-options "-O2 -fprefetch-loop-arrays -march=athlon -msse2 -mfpmath=sse --param simultaneous-prefetches=100 --param max-unrolled-insns=1 -fdump-tree-aprefetch-details -fdump-tree-final_cleanup" } */
 
 #define K 1000000
Index: gcc/testsuite/gcc.dg/pr36584.c
===================================================================
--- gcc/testsuite/gcc.dg/pr36584.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/pr36584.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,8 +1,8 @@
 /* { dg-do run } */
 /* { dg-options "-O2 -lm" } */
 /* { dg-options "-O2 -msse2 -mfpmath=sse" { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
+/* { dg-require-effective-target sse2 { target { { i?86-*-* x86_64-*-* } && ilp32 } } } */
 
-
 #ifdef __i386__
 #include "cpuid.h"
 #endif
Index: gcc/testsuite/gcc.dg/compat/union-m128-1_main.c
===================================================================
--- gcc/testsuite/gcc.dg/compat/union-m128-1_main.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/compat/union-m128-1_main.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-skip-if "test SSE2 support" { ! { i?86-*-* x86_64-*-* } } } */
 /* { dg-options "-O" } */
+/* { dg-require-effective-target sse2 } */
 
 #include "cpuid.h"
 
Index: gcc/testsuite/gcc.dg/compat/vector-1a_main.c
===================================================================
--- gcc/testsuite/gcc.dg/compat/vector-1a_main.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/compat/vector-1a_main.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-skip-if "test SSE2 vector" { ! { i?86-*-* x86_64-*-* } } } */
+/* { dg-require-effective-target sse2 } */
 
 /* Test compatibility of vector types: layout between separately-compiled
    modules, parameter passing, and function return.  This test uses
Index: gcc/testsuite/gcc.dg/compat/vector-2a_main.c
===================================================================
--- gcc/testsuite/gcc.dg/compat/vector-2a_main.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/compat/vector-2a_main.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,5 @@
 /* { dg-skip-if "test SSE2 support" { ! { i?86-*-* x86_64-*-* } } } */
+/* { dg-require-effective-target sse2 } */
 
 /* Test compatibility of vector types: layout between separately-compiled
    modules, parameter passing, and function return.  This test uses
Index: gcc/testsuite/gcc.dg/vect/costmodel/i386/i386-costmodel-vect.exp
===================================================================
--- gcc/testsuite/gcc.dg/vect/costmodel/i386/i386-costmodel-vect.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/vect/costmodel/i386/i386-costmodel-vect.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,4 @@
-# Copyright (C) 1997, 2004, 2005, 2006, 2007, 2008
+# Copyright (C) 1997, 2004, 2005, 2006, 2007, 2008, 2010
 # Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
@@ -39,6 +39,9 @@
 global dg-do-what-default
 set save-dg-do-what-default ${dg-do-what-default}
 
+if { ![check_effective_target_sse2] } then {
+  return
+}
 lappend DEFAULT_VECTCFLAGS "-msse2"
 if [check_sse2_hw_available] {
     set dg-do-what-default run
Index: gcc/testsuite/gcc.dg/vect/vect-debug-pr41926.c
===================================================================
--- gcc/testsuite/gcc.dg/vect/vect-debug-pr41926.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/vect/vect-debug-pr41926.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 /* PR debug/41926 */
 /* { dg-do compile } */
 /* { dg-options "-O2 -g -ffast-math -funroll-loops -ftree-vectorize -msse2" { target { i?86-*-* x86_64-*-* } } } */
+/* { dg-require-effective-target sse2 { target { i?86-*-* x86_64-*-* } } } */
 
 void
 foo (double (*__restrict p)[4], double (*__restrict q)[4],
Index: gcc/testsuite/gcc.dg/vect/vect.exp
===================================================================
--- gcc/testsuite/gcc.dg/vect/vect.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/vect/vect.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,4 @@
-# Copyright (C) 1997, 2004, 2005, 2006, 2007, 2008
+# Copyright (C) 1997, 2004, 2005, 2006, 2007, 2008, 2010
 # Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
@@ -63,6 +63,9 @@
 } elseif { [istarget  "spu-*-*"] } {
    set dg-do-what-default run
 } elseif { [istarget "i?86-*-*"] || [istarget "x86_64-*-*"] } {
+    if { ![check_effective_target_sse2] } then {
+	return
+    }
     lappend DEFAULT_VECTCFLAGS "-msse2"
     if [check_sse2_hw_available] {
 	set dg-do-what-default run
Index: gcc/testsuite/gcc.dg/pr36997.c
===================================================================
--- gcc/testsuite/gcc.dg/pr36997.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gcc.dg/pr36997.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,9 +1,10 @@
 /* { dg-do compile { target x86_64-*-* i?86-*-* } } */
 /* { dg-options "-std=c99 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 typedef int __m64 __attribute__ ((__vector_size__ (8), __may_alias__));
 __m64 _mm_add_si64 (__m64 __m1, __m64 __m2)
 {
     return (__m64) __builtin_ia32_paddq ((long long)__m1, (long long)__m2); /* { dg-error "incompatible type" } */
-    /* { dg-message "note: expected 'long long int __vector__' but argument is of type 'long long int'" "" { target *-*-* } 7 } */
+    /* { dg-message "note: expected 'long long int __vector__' but argument is of type 'long long int'" "" { target *-*-* } 8 } */
 }
Index: gcc/testsuite/ChangeLog
===================================================================
--- gcc/testsuite/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,401 @@
+2010-05-27  Jason Merrill  <jason@redhat.com>
+
+	PR c++/43555
+	* g++.dg/ext/vla9.C: New.
+
+2010-05-23  H.J. Lu  <hongjiu.lu@intel.com>
+
+	Backport from mainline
+	2010-05-23  H.J. Lu  <hongjiu.lu@intel.com>
+
+	PR target/44245
+	* gcc.target/i386/crc32-3.c: New.
+	* gcc.target/i386/crc32-4.c: Likewise.
+
+2010-05-21  Richard Guenther  <rguenther@suse.de>
+
+	PR tree-optimization/43845
+	* gcc.c-torture/compile/pr43845.c: New testcase.
+
+2010-05-20  Hans-Peter Nilsson  <hp@axis.com>
+
+	PR target/44202
+	* gcc.c-torture/execute/pr44202-1.c: New test.
+
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* lib/target-supports.exp (check_effective_target_sse2): New proc.
+	* lib/target-supports-dg.exp (dg-require-effective-target): Allow
+	for optional selector.
+	* gcc.target/i386/i386.exp (check_effective_target_3dnow): New proc.
+	(check_effective_target_sse3): New proc.
+	* gcc.target/i386/math-torture/math-torture.exp: Load
+	target-supports.exp.
+	Only add options with -msse2 to MATH_TORTURE_OPTIONS if
+	check_effective_target_sse2.
+	* gcc.dg/vect/vect.exp: Return unless check_effective_target_sse2.
+	* gcc.dg/vect/costmodel/i386/i386-costmodel-vect.exp: Likewise.
+	* g++.dg/vect/vect.exp: Likewise.
+	* gfortran.dg/vect/vect.exp: Likewise.
+	* lib/fortran-torture.exp (get-fortran-torture-options): Only use
+	-msse2 if check_effective_target_sse2.
+
+	* gcc.target/i386/3dnow-1.c: Use dg-require-effective-target 3dnow.
+	* gcc.target/i386/3dnow-2.c: Likewise.
+	* gcc.target/i386/3dnowA-1.c: Likewise.
+	* gcc.target/i386/3dnowA-2.c: Likewise.
+	* gcc.target/i386/pr42549.c: Likewise.
+
+	* gcc.target/i386/sse3-addsubpd.c: Use dg-require-effective-target sse3.
+	* gcc.target/i386/sse3-addsubps.c: Likewise.
+	* gcc.target/i386/sse3-haddpd.c: Likewise.
+	* gcc.target/i386/sse3-haddps.c: Likewise.
+	* gcc.target/i386/sse3-hsubpd.c: Likewise.
+	* gcc.target/i386/sse3-hsubps.c: Likewise.
+	* gcc.target/i386/sse3-lddqu.c: Likewise.
+	* gcc.target/i386/sse3-movddup.c: Likewise.
+	* gcc.target/i386/sse3-movshdup.c: Likewise.
+	* gcc.target/i386/sse3-movsldup.c: Likewise.
+
+	* g++.dg/abi/mangle42.C: Use dg-require-effective-target sse2.
+	* g++.dg/ext/attrib35.C: Likewise.
+	* g++.dg/opt/pr40496.C: Likewise.
+	* g++.dg/other/i386-1.C: Likewise.
+	* g++.dg/other/i386-4.C: Likewise.
+	* g++.dg/other/pr34435.C: Likewise.
+	* g++.dg/other/pr39496.C: Likewise.
+	* g++.dg/other/pr40446.C: Likewise.
+	* gcc.dg/compat/union-m128-1_main.c: Likewise.
+	* gcc.dg/compat/vector-1a_main.c: Likewise.
+	* gcc.dg/compat/vector-2a_main.c: Likewise.
+	* gcc.dg/pr34856.c: Likewise.
+	* gcc.dg/pr36584.c: Likewise.
+	* gcc.dg/pr36997.c: Likewise.  Adapt dg-message line number.
+	* gcc.dg/pr37544.c: Likewise.
+	* gcc.dg/torture/pr16104-1.c: Likewise.
+	* gcc.dg/torture/pr35771-1.c: Likewise.
+	* gcc.dg/torture/pr35771-2.c: Likewise.
+	* gcc.dg/torture/pr35771-3.c: Likewise.
+	* gcc.dg/torture/stackalign/alloca-2.c: Likewise.
+	* gcc.dg/torture/stackalign/alloca-3.c: Likewise.
+	* gcc.dg/torture/stackalign/push-1.c: Likewise.
+	* gcc.dg/torture/stackalign/vararg-3.c: Likewise.
+	* gcc.dg/tree-ssa/prefetch-6.c: Likewise.
+	* gcc.dg/tree-ssa/prefetch-7.c: Likewise.
+	* gcc.dg/vect/vect-debug-pr41926.c: Likewise.
+	* gcc.target/i386/20060512-1.c: Likewise.
+	* gcc.target/i386/20060512-3.c: Likewise.
+	* gcc.target/i386/float128-1.c: Likewise.
+	* gcc.target/i386/float128-2.c: Likewise.
+	* gcc.target/i386/fpcvt-1.c: Likewise.
+	* gcc.target/i386/fpcvt-2.c: Likewise.
+	* gcc.target/i386/fpcvt-3.c: Likewise.
+	* gcc.target/i386/fpprec-1.c: Likewise.
+	* gcc.target/i386/funcspec-9.c: Likewise.
+	* gcc.target/i386/incoming-1.c: Likewise.
+	* gcc.target/i386/incoming-2.c: Likewise.
+	* gcc.target/i386/incoming-3.c: Likewise.
+	* gcc.target/i386/incoming-4.c: Likewise.
+	* gcc.target/i386/opt-1.c: Likewise.
+	* gcc.target/i386/opt-2.c: Likewise.
+	* gcc.target/i386/ordcmp-1.c: Likewise.
+	* gcc.target/i386/pr17692.c: Likewise.
+	* gcc.target/i386/pr18614-1.c: Likewise.
+	* gcc.target/i386/pr22152.c: Likewise.
+	* gcc.target/i386/pr23570.c: Likewise.
+	* gcc.target/i386/pr23575.c: Likewise.
+	* gcc.target/i386/pr26449-1.c: Likewise.
+	* gcc.target/i386/pr26600.c: Likewise.
+	* gcc.target/i386/pr27790.c: Likewise.
+	* gcc.target/i386/pr28839.c: Likewise.
+	* gcc.target/i386/pr30970.c: Likewise.
+	* gcc.target/i386/pr32000-1.c: Likewise.
+	* gcc.target/i386/pr32000-2.c: Likewise.
+	* gcc.target/i386/pr32280.c: Likewise.
+	* gcc.target/i386/pr32661.c: Likewise.
+	* gcc.target/i386/pr32708-1.c: Likewise.
+	* gcc.target/i386/pr32961.c: Likewise.
+	* gcc.target/i386/pr33329.c: Likewise.
+	* gcc.target/i386/pr35714.c: Likewise.
+	* gcc.target/i386/pr35767-1.c: Likewise.
+	* gcc.target/i386/pr35767-1d.c: Likewise.
+	* gcc.target/i386/pr35767-1i.c: Likewise.
+	* gcc.target/i386/pr35767-2.c: Likewise.
+	* gcc.target/i386/pr35767-2d.c: Likewise.
+	* gcc.target/i386/pr35767-2i.c: Likewise.
+	* gcc.target/i386/pr35767-3.c: Likewise.
+	* gcc.target/i386/pr35767-5.c: Likewise.
+	* gcc.target/i386/pr36222-1.c: Likewise.
+	* gcc.target/i386/pr36578-1.c: Likewise.
+	* gcc.target/i386/pr36578-2.c: Likewise.
+	* gcc.target/i386/pr36992-1.c: Likewise.
+	* gcc.target/i386/pr37101.c: Likewise.
+	* gcc.target/i386/pr37434-1.c: Likewise.
+	* gcc.target/i386/pr37434-2.c: Likewise.
+	* gcc.target/i386/pr37843-3.c: Likewise.
+	* gcc.target/i386/pr39162.c: Likewise.
+	* gcc.target/i386/pr39445.c: Likewise.
+	* gcc.target/i386/pr39496.c: Likewise.
+	* gcc.target/i386/pr40809.c: Likewise.
+	* gcc.target/i386/pr40906-3.c: Likewise.
+	* gcc.target/i386/pr41019.c: Likewise.
+	* gcc.target/i386/pr42542-1.c: Likewise.
+	* gcc.target/i386/pr42542-2.c: Likewise.
+	* gcc.target/i386/pr42542-3.c: Likewise.
+	* gcc.target/i386/pr42542-3a.c: Likewise.
+	* gcc.target/i386/pr42881.c: Likewise.
+	* gcc.target/i386/push-1.c: Likewise.
+	* gcc.target/i386/quad-sse.c: Likewise.
+	* gcc.target/i386/reload-1.c: Likewise.
+	* gcc.target/i386/sse-10.c: Likewise.
+	* gcc.target/i386/sse-11.c: Likewise.
+	* gcc.target/i386/sse-15.c: Likewise.
+	* gcc.target/i386/sse-17.c: Likewise.
+	* gcc.target/i386/sse-18.c: Likewise.
+	* gcc.target/i386/sse-19.c: Likewise.
+	* gcc.target/i386/sse-4.c: Likewise.
+	* gcc.target/i386/sse-6.c: Likewise.
+	* gcc.target/i386/sse-vect-types.c: Likewise.
+	* gcc.target/i386/sse2-addpd-1.c: Likewise.
+	* gcc.target/i386/sse2-addsd-1.c: Likewise.
+	* gcc.target/i386/sse2-andnpd-1.c: Likewise.
+	* gcc.target/i386/sse2-andpd-1.c: Likewise.
+	* gcc.target/i386/sse2-comisd-1.c: Likewise.
+	* gcc.target/i386/sse2-comisd-2.c: Likewise.
+	* gcc.target/i386/sse2-comisd-3.c: Likewise.
+	* gcc.target/i386/sse2-comisd-4.c: Likewise.
+	* gcc.target/i386/sse2-comisd-5.c: Likewise.
+	* gcc.target/i386/sse2-comisd-6.c: Likewise.
+	* gcc.target/i386/sse2-cvtdq2pd-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtdq2ps-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtpd2dq-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtpd2ps-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtps2dq-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtps2pd-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtsd2si-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtsd2si-2.c: Likewise.
+	* gcc.target/i386/sse2-cvtsd2ss-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtsi2sd-1.c: Likewise.
+	* gcc.target/i386/sse2-cvtsi2sd-2.c: Likewise.
+	* gcc.target/i386/sse2-cvtss2sd-1.c: Likewise.
+	* gcc.target/i386/sse2-cvttpd2dq-1.c: Likewise.
+	* gcc.target/i386/sse2-cvttps2dq-1.c: Likewise.
+	* gcc.target/i386/sse2-cvttsd2si-1.c: Likewise.
+	* gcc.target/i386/sse2-cvttsd2si-2.c: Likewise.
+	* gcc.target/i386/sse2-divpd-1.c: Likewise.
+	* gcc.target/i386/sse2-divsd-1.c: Likewise.
+	* gcc.target/i386/sse2-init-v16qi-1.c: Likewise.
+	* gcc.target/i386/sse2-init-v2di-1.c: Likewise.
+	* gcc.target/i386/sse2-init-v4si-1.c: Likewise.
+	* gcc.target/i386/sse2-init-v8hi-1.c: Likewise.
+	* gcc.target/i386/sse2-lrint-vec.c: Likewise.
+	* gcc.target/i386/sse2-lrintf-vec.c: Likewise.
+	* gcc.target/i386/sse2-maxpd-1.c: Likewise.
+	* gcc.target/i386/sse2-maxsd-1.c: Likewise.
+	* gcc.target/i386/sse2-minpd-1.c: Likewise.
+	* gcc.target/i386/sse2-minsd-1.c: Likewise.
+	* gcc.target/i386/sse2-mmx.c: Likewise.
+	* gcc.target/i386/sse2-movapd-1.c: Likewise.
+	* gcc.target/i386/sse2-movapd-2.c: Likewise.
+	* gcc.target/i386/sse2-movd-1.c: Likewise.
+	* gcc.target/i386/sse2-movd-2.c: Likewise.
+	* gcc.target/i386/sse2-movdqa-1.c: Likewise.
+	* gcc.target/i386/sse2-movdqa-2.c: Likewise.
+	* gcc.target/i386/sse2-movdqu-1.c: Likewise.
+	* gcc.target/i386/sse2-movdqu-2.c: Likewise.
+	* gcc.target/i386/sse2-movhpd-1.c: Likewise.
+	* gcc.target/i386/sse2-movhpd-2.c: Likewise.
+	* gcc.target/i386/sse2-movlpd-1.c: Likewise.
+	* gcc.target/i386/sse2-movlpd-2.c: Likewise.
+	* gcc.target/i386/sse2-movmskpd-1.c: Likewise.
+	* gcc.target/i386/sse2-movntdq-1.c: Likewise.
+	* gcc.target/i386/sse2-movntpd-1.c: Likewise.
+	* gcc.target/i386/sse2-movq-1.c: Likewise.
+	* gcc.target/i386/sse2-movq-2.c: Likewise.
+	* gcc.target/i386/sse2-movq-3.c: Likewise.
+	* gcc.target/i386/sse2-movsd-1.c: Likewise.
+	* gcc.target/i386/sse2-movsd-2.c: Likewise.
+	* gcc.target/i386/sse2-movupd-1.c: Likewise.
+	* gcc.target/i386/sse2-movupd-2.c: Likewise.
+	* gcc.target/i386/sse2-mulpd-1.c: Likewise.
+	* gcc.target/i386/sse2-mulsd-1.c: Likewise.
+	* gcc.target/i386/sse2-orpd-1.c: Likewise.
+	* gcc.target/i386/sse2-packssdw-1.c: Likewise.
+	* gcc.target/i386/sse2-packsswb-1.c: Likewise.
+	* gcc.target/i386/sse2-packuswb-1.c: Likewise.
+	* gcc.target/i386/sse2-paddb-1.c: Likewise.
+	* gcc.target/i386/sse2-paddd-1.c: Likewise.
+	* gcc.target/i386/sse2-paddq-1.c: Likewise.
+	* gcc.target/i386/sse2-paddsb-1.c: Likewise.
+	* gcc.target/i386/sse2-paddsw-1.c: Likewise.
+	* gcc.target/i386/sse2-paddusb-1.c: Likewise.
+	* gcc.target/i386/sse2-paddusw-1.c: Likewise.
+	* gcc.target/i386/sse2-paddw-1.c: Likewise.
+	* gcc.target/i386/sse2-pand-1.c: Likewise.
+	* gcc.target/i386/sse2-pandn-1.c: Likewise.
+	* gcc.target/i386/sse2-pavgb-1.c: Likewise.
+	* gcc.target/i386/sse2-pavgw-1.c: Likewise.
+	* gcc.target/i386/sse2-pcmpeqb-1.c: Likewise.
+	* gcc.target/i386/sse2-pcmpeqd-1.c: Likewise.
+	* gcc.target/i386/sse2-pcmpeqw-1.c: Likewise.
+	* gcc.target/i386/sse2-pcmpgtb-1.c: Likewise.
+	* gcc.target/i386/sse2-pcmpgtd-1.c: Likewise.
+	* gcc.target/i386/sse2-pcmpgtw-1.c: Likewise.
+	* gcc.target/i386/sse2-pmaddwd-1.c: Likewise.
+	* gcc.target/i386/sse2-pmaxsw-1.c: Likewise.
+	* gcc.target/i386/sse2-pmaxub-1.c: Likewise.
+	* gcc.target/i386/sse2-pminsw-1.c: Likewise.
+	* gcc.target/i386/sse2-pminub-1.c: Likewise.
+	* gcc.target/i386/sse2-pmovmskb-1.c: Likewise.
+	* gcc.target/i386/sse2-pmulhuw-1.c: Likewise.
+	* gcc.target/i386/sse2-pmulhw-1.c: Likewise.
+	* gcc.target/i386/sse2-pmullw-1.c: Likewise.
+	* gcc.target/i386/sse2-pmuludq-1.c: Likewise.
+	* gcc.target/i386/sse2-por-1.c: Likewise.
+	* gcc.target/i386/sse2-psadbw-1.c: Likewise.
+	* gcc.target/i386/sse2-pshufd-1.c: Likewise.
+	* gcc.target/i386/sse2-pshufhw-1.c: Likewise.
+	* gcc.target/i386/sse2-pshuflw-1.c: Likewise.
+	* gcc.target/i386/sse2-pslld-1.c: Likewise.
+	* gcc.target/i386/sse2-pslld-2.c: Likewise.
+	* gcc.target/i386/sse2-pslldq-1.c: Likewise.
+	* gcc.target/i386/sse2-psllq-1.c: Likewise.
+	* gcc.target/i386/sse2-psllq-2.c: Likewise.
+	* gcc.target/i386/sse2-psllw-1.c: Likewise.
+	* gcc.target/i386/sse2-psllw-2.c: Likewise.
+	* gcc.target/i386/sse2-psrad-1.c: Likewise.
+	* gcc.target/i386/sse2-psrad-2.c: Likewise.
+	* gcc.target/i386/sse2-psraw-1.c: Likewise.
+	* gcc.target/i386/sse2-psraw-2.c: Likewise.
+	* gcc.target/i386/sse2-psrld-1.c: Likewise.
+	* gcc.target/i386/sse2-psrld-2.c: Likewise.
+	* gcc.target/i386/sse2-psrldq-1.c: Likewise.
+	* gcc.target/i386/sse2-psrlq-1.c: Likewise.
+	* gcc.target/i386/sse2-psrlq-2.c: Likewise.
+	* gcc.target/i386/sse2-psrlw-1.c: Likewise.
+	* gcc.target/i386/sse2-psrlw-2.c: Likewise.
+	* gcc.target/i386/sse2-psubb-1.c: Likewise.
+	* gcc.target/i386/sse2-psubd-1.c: Likewise.
+	* gcc.target/i386/sse2-psubq-1.c: Likewise.
+	* gcc.target/i386/sse2-psubsb-1.c: Likewise.
+	* gcc.target/i386/sse2-psubsw-1.c: Likewise.
+	* gcc.target/i386/sse2-psubw-1.c: Likewise.
+	* gcc.target/i386/sse2-punpckhbw-1.c: Likewise.
+	* gcc.target/i386/sse2-punpckhdq-1.c: Likewise.
+	* gcc.target/i386/sse2-punpckhqdq-1.c: Likewise.
+	* gcc.target/i386/sse2-punpckhwd-1.c: Likewise.
+	* gcc.target/i386/sse2-punpcklbw-1.c: Likewise.
+	* gcc.target/i386/sse2-punpckldq-1.c: Likewise.
+	* gcc.target/i386/sse2-punpcklqdq-1.c: Likewise.
+	* gcc.target/i386/sse2-punpcklwd-1.c: Likewise.
+	* gcc.target/i386/sse2-pxor-1.c: Likewise.
+	* gcc.target/i386/sse2-set-epi32-1.c: Likewise.
+	* gcc.target/i386/sse2-set-epi64x-1.c: Likewise.
+	* gcc.target/i386/sse2-set-v16qi-1.c: Likewise.
+	* gcc.target/i386/sse2-set-v16qi-2.c: Likewise.
+	* gcc.target/i386/sse2-set-v16qi-3.c: Likewise.
+	* gcc.target/i386/sse2-set-v8hi-1.c: Likewise.
+	* gcc.target/i386/sse2-set-v8hi-1a.c: Likewise.
+	* gcc.target/i386/sse2-set-v8hi-2.c: Likewise.
+	* gcc.target/i386/sse2-set-v8hi-2a.c: Likewise.
+	* gcc.target/i386/sse2-shufpd-1.c: Likewise.
+	* gcc.target/i386/sse2-shufps-1.c: Likewise.
+	* gcc.target/i386/sse2-sqrtpd-1.c: Likewise.
+	* gcc.target/i386/sse2-subpd-1.c: Likewise.
+	* gcc.target/i386/sse2-subsd-1.c: Likewise.
+	* gcc.target/i386/sse2-ucomisd-1.c: Likewise.
+	* gcc.target/i386/sse2-ucomisd-2.c: Likewise.
+	* gcc.target/i386/sse2-ucomisd-3.c: Likewise.
+	* gcc.target/i386/sse2-ucomisd-4.c: Likewise.
+	* gcc.target/i386/sse2-ucomisd-5.c: Likewise.
+	* gcc.target/i386/sse2-ucomisd-6.c: Likewise.
+	* gcc.target/i386/sse2-unpack-1.c: Likewise.
+	* gcc.target/i386/sse2-unpckhpd-1.c: Likewise.
+	* gcc.target/i386/sse2-unpcklpd-1.c: Likewise.
+	* gcc.target/i386/sse2-vec-1.c: Likewise.
+	* gcc.target/i386/sse2-vec-2.c: Likewise.
+	* gcc.target/i386/sse2-vec-3.c: Likewise.
+	* gcc.target/i386/sse2-vec-4.c: Likewise.
+	* gcc.target/i386/sse2-vec-5.c: Likewise.
+	* gcc.target/i386/sse2-vec-6.c: Likewise.
+	* gcc.target/i386/sse2-xorpd-1.c: Likewise.
+	* gcc.target/i386/ssefn-2.c: Likewise.
+	* gcc.target/i386/ssefn-4.c: Likewise.
+	* gcc.target/i386/ssefp-1.c: Likewise.
+	* gcc.target/i386/ssefp-2.c: Likewise.
+	* gcc.target/i386/sseregparm-3.c: Likewise.
+	* gcc.target/i386/sseregparm-4.c: Likewise.
+	* gcc.target/i386/sseregparm-5.c: Likewise.
+	* gcc.target/i386/sseregparm-6.c: Likewise.
+	* gcc.target/i386/sseregparm-7.c: Likewise.
+	* gcc.target/i386/ssetype-1.c: Likewise.
+	* gcc.target/i386/ssetype-2.c: Likewise.
+	* gcc.target/i386/ssetype-3.c: Likewise.
+	* gcc.target/i386/ssetype-4.c: Likewise.
+	* gcc.target/i386/ssetype-5.c: Likewise.
+	* gcc.target/i386/unordcmp-1.c: Likewise.
+	* gcc.target/i386/vararg-1.c: Likewise.
+	* gcc.target/i386/vararg-2.c: Likewise.
+	* gcc.target/i386/vararg-3.c: Likewise.
+	* gcc.target/i386/vararg-4.c: Likewise.
+	* gcc.target/i386/vararg-7.c: Likewise.
+	* gcc.target/i386/vararg-8.c: Likewise.
+	* gcc.target/i386/vecinit-1.c: Likewise.
+	* gcc.target/i386/vecinit-2.c: Likewise.
+	* gcc.target/i386/vecinit-3.c: Likewise.
+	* gcc.target/i386/vecinit-4.c: Likewise.
+	* gcc.target/i386/vecinit-5.c: Likewise.
+	* gcc.target/i386/vecinit-6.c: Likewise.
+	* gcc.target/i386/vectorize2.c: Likewise.
+	* gcc.target/i386/vectorize3.c: Likewise.
+	* gcc.target/i386/vectorize4.c: Likewise.
+	* gcc.target/i386/vectorize6.c: Likewise.
+	* gcc.target/i386/xorps-sse2.c: Likewise.
+	* gcc.target/i386/xorps.c: Likewise.
+
+2010-05-19  Jason Merrill  <jason@redhat.com>
+
+	PR c++/44193
+	* g++.dg/template/fntype1.C: New.
+
+2010-05-14  Steven G. Kargl  <kargl@gcc.gnu.org>
+
+	PR fortran/44135
+	* gfortran.dg/actual_array_interface_2.f90: New test.
+
+2010-05-13  Jakub Jelinek  <jakub@redhat.com>
+
+	PR fortran/44036
+	* gfortran.dg/gomp/pr44036-1.f90: New test.
+	* gfortran.dg/gomp/pr44036-2.f90: New test.
+	* gfortran.dg/gomp/pr44036-3.f90: New test.
+
+	PR middle-end/44085
+	* gcc.dg/gomp/pr44085.c: New test.
+	* gfortran.dg/gomp/pr44085.f90: New test.
+
+2010-05-05  Jason Merrill  <jason@redhat.com>
+
+	PR debug/43370
+	* g++.dg/ext/attrib39.C: New.
+
+2010-05-04  H.J. Lu  <hongjiu.lu@intel.com>
+
+	Backport from mainline
+	2010-05-04  H.J. Lu  <hongjiu.lu@intel.com>
+
+	PR middle-end/43671
+	* gcc.target/i386/pr43671.c: New.
+
+2010-05-03  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* ada/acats/run_acats (which): New function.
+	(host_gnatchop, host_gnatmake): Use it.
+
+2010-04-30  DJ Delorie  <dj@redhat.com>
+
+	* gcc.c-torture/execute/20100430-1.c: New test.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: gcc/testsuite/g++.dg/other/i386-4.C
===================================================================
--- gcc/testsuite/g++.dg/other/i386-4.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/other/i386-4.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-O1 -msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <xmmintrin.h>
 
Index: gcc/testsuite/g++.dg/other/pr39496.C
===================================================================
--- gcc/testsuite/g++.dg/other/pr39496.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/other/pr39496.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 // PR target/39496
 // { dg-do compile { target { { i?86-*-linux* x86_64-*-linux* } && ilp32 } } }
 // { dg-options "-O0 -fverbose-asm -fno-omit-frame-pointer -mtune=i686 -msse2 -mfpmath=sse" }
+// { dg-require-effective-target sse2 }
 // Verify that {foo,bar}{,2}param are all passed on the stack, using
 // normal calling conventions, when not optimizing.
 // { dg-final { scan-assembler "\[^0-9-\]8\\(%ebp\\),\[^\n\]*fooparam," } }
Index: gcc/testsuite/g++.dg/other/pr40446.C
===================================================================
--- gcc/testsuite/g++.dg/other/pr40446.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/other/pr40446.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 // PR middle-end/40446
 // { dg-do run { target i?86-*-* x86_64-*-* } }
 // { dg-options "-O1 -msse2" }
+// { dg-require-effective-target sse2 }
 
 #include <emmintrin.h>
 #include "cpuid.h"
Index: gcc/testsuite/g++.dg/other/i386-1.C
===================================================================
--- gcc/testsuite/g++.dg/other/i386-1.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/other/i386-1.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do run { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <xmmintrin.h>
 
Index: gcc/testsuite/g++.dg/other/pr34435.C
===================================================================
--- gcc/testsuite/g++.dg/other/pr34435.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/other/pr34435.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 /* { dg-do compile { target i?86-*-* x86_64-*-* } } */
 /* { dg-options "-msse2" } */
+/* { dg-require-effective-target sse2 } */
 
 #include <emmintrin.h>
 
Index: gcc/testsuite/g++.dg/ext/vla9.C
===================================================================
--- gcc/testsuite/g++.dg/ext/vla9.C	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/g++.dg/ext/vla9.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,38 @@
+// PR c++/43555
+// { dg-options "" }
+// { dg-do run }
+
+extern "C" void * malloc (__SIZE_TYPE__);
+extern "C" int printf (const char *, ...);
+extern "C" void abort(void);
+
+int nx,ny;
+
+void f(double *x1d,int choice)
+{
+  double (*x2d)[nx][ny]=(double(*)[nx][ny])x1d;
+  unsigned long delta;
+//  (*x2d)[0][0]=123; // <- this line affects the result
+  if (choice!=0)
+  {
+    delta=&(*x2d)[1][0]-x1d;
+  }
+  else
+  {
+    delta=&(*x2d)[1][0]-x1d;
+  }
+  printf("Choice: %d, Delta: %ld\n",choice,delta);
+  if (delta != ny)
+    abort ();
+}
+
+int main()
+{
+  double *data;
+  nx=100;
+  ny=100;
+  data=(double*)malloc(nx*ny*sizeof(double));
+  f(data,0);
+  f(data,1);
+  return 0;
+}
Index: gcc/testsuite/g++.dg/ext/attrib35.C
===================================================================
--- gcc/testsuite/g++.dg/ext/attrib35.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/ext/attrib35.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 // { dg-do compile { target i*86-*-* x86_64-*-* } }
 // { dg-options "-O3 -msse2" }
+// { dg-require-effective-target sse2 }
 
 // You can make NON-template typedefs with a large alignment.
 typedef double AlignedDoubleType __attribute__((aligned(16)));
Index: gcc/testsuite/g++.dg/ext/attrib39.C
===================================================================
--- gcc/testsuite/g++.dg/ext/attrib39.C	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/g++.dg/ext/attrib39.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,9 @@
+// PR debug/43370
+// { dg-options "-g" }
+
+int fragile_block(void) {
+  typedef __attribute__ ((aligned (16))) struct {
+    int i;
+  } XmmUint16;
+  return 0;
+}
Index: gcc/testsuite/g++.dg/vect/vect.exp
===================================================================
--- gcc/testsuite/g++.dg/vect/vect.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/vect/vect.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,4 @@
-# Copyright (C) 2004, 2007, 2008 Free Software Foundation, Inc.
+# Copyright (C) 2004, 2007, 2008, 2010 Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -71,6 +71,9 @@
 } elseif { [istarget  "spu-*-*"] } {
    set dg-do-what-default run
 } elseif { [istarget "i?86-*-*"] || [istarget "x86_64-*-*"] } {
+    if { ![check_effective_target_sse2] } then {
+	return
+    }
     lappend DEFAULT_VECTCFLAGS "-msse2"
     if [check_sse2_hw_available] {
 	set dg-do-what-default run
Index: gcc/testsuite/g++.dg/opt/pr40496.C
===================================================================
--- gcc/testsuite/g++.dg/opt/pr40496.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/opt/pr40496.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,6 @@
 // { dg-do compile }
 // { dg-options "-O2 -fprefetch-loop-arrays -msse2" { target i?86-*-* x86_64-*-* } }
+// { dg-require-effective-target sse2 { target i?86-*-* x86_64-*-* } }
 
 struct DOMStringHandle
 {
Index: gcc/testsuite/g++.dg/abi/mangle42.C
===================================================================
--- gcc/testsuite/g++.dg/abi/mangle42.C	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/g++.dg/abi/mangle42.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,7 @@
 // Origin: PR c++/43375
 // { dg-do compile { target i?86-*-* x86_64-*-* } }
 // { dg-options "-msse2 -std=gnu++0x" }
+// { dg-require-effective-target sse2 }
 
 typedef float __v4sf __attribute__ ((__vector_size__ (16)));
 typedef int __v4si __attribute__ ((__vector_size__ (16)));
Index: gcc/testsuite/g++.dg/template/fntype1.C
===================================================================
--- gcc/testsuite/g++.dg/template/fntype1.C	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/g++.dg/template/fntype1.C	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,26 @@
+bool f(int i) { return i != 5; }
+
+template <class X, class P = bool(X)>
+struct Traits
+{
+ typedef P type;
+};
+
+template <class X, class P = typename Traits<X>::type>
+struct S
+{
+ const P& p_;
+ S( const P& p ) : p_(p) {} // const reference
+};
+
+template <class X>
+S<X> make_s(const typename Traits<X>::type & p) // const reference
+{
+ return S<X>(p); // << HERE
+}
+
+
+int main()
+{
+ make_s<int>(f);
+}
Index: gcc/testsuite/lib/target-supports-dg.exp
===================================================================
--- gcc/testsuite/lib/target-supports-dg.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/lib/target-supports-dg.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,4 @@
-#   Copyright (C) 1997, 1999, 2000, 2003, 2004, 2005, 2007, 2008, 2009
+#   Copyright (C) 1997, 1999, 2000, 2003, 2004, 2005, 2007, 2008, 2009, 2010
 #   Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
@@ -145,12 +145,23 @@
 }
 
 # If the target does not match the required effective target, skip this test.
+# Only apply this if the optional selector matches.
 
 proc dg-require-effective-target { args } {
     set args [lreplace $args 0 0]
-    if { [llength $args] != 1 } {
-	error "syntax error, need a single effective-target keyword"
+    # Verify the number of arguments.  The last is optional.
+    if { [llength $args] < 1 || [llength $args] > 2 } {
+	error "syntax error, need a single effective-target keyword with optional selector"
     }
+    
+    # Evaluate selector if present.
+    if { [llength $args] == 2 } {
+	switch [dg-process-target [lindex $args 1]] {
+	    "S" { }
+	    "N" { return }
+	}
+    }
+
     if { ![is-effective-target [lindex $args 0]] } {
 	upvar dg-do-what dg-do-what
         set dg-do-what [list [lindex ${dg-do-what} 0] "N" "P"]
Index: gcc/testsuite/lib/fortran-torture.exp
===================================================================
--- gcc/testsuite/lib/fortran-torture.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/lib/fortran-torture.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,4 @@
-# Copyright (C) 2003, 2006, 2007, 2008 Free Software Foundation, Inc.
+# Copyright (C) 2003, 2006, 2007, 2008, 2010 Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -45,6 +45,7 @@
     } elseif { [istarget  "spu-*-*"] } {
 	set test_tree_vectorize 1
     } elseif { ( [istarget "i?86-*-*"] || [istarget "x86_64-*-*"] )
+	       && [check_effective_target_sse2]
 	       && [check_sse2_hw_available] } {
 	lappend vectorizer_options "-msse2"
 	set test_tree_vectorize 1
Index: gcc/testsuite/lib/target-supports.exp
===================================================================
--- gcc/testsuite/lib/target-supports.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/lib/target-supports.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2858,6 +2858,18 @@
     } "-O2 -mavx" ]
 }
 
+# Return 1 if sse2 instructions can be compiled.
+proc check_effective_target_sse2 { } {
+    return [check_no_compiler_messages sse2 object {
+	typedef long long __m128i __attribute__ ((__vector_size__ (16)));
+	
+	__m128i _mm_srli_si128 (__m128i __A, int __N)
+	{
+	    return (__m128i)__builtin_ia32_psrldqi128 (__A, 8);
+	}
+    } "-O2 -msse2" ]
+}
+
 # Return 1 if C wchar_t type is compatible with char16_t.
 
 proc check_effective_target_wchar_t_char16_t_compatible { } {
Index: gcc/testsuite/gfortran.dg/actual_array_interface_2.f90
===================================================================
--- gcc/testsuite/gfortran.dg/actual_array_interface_2.f90	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gfortran.dg/actual_array_interface_2.f90	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,13 @@
+! { dg-do compile }
+program gprogram
+   implicit none
+   real, dimension(-2:0) :: my_arr
+   call fill_array(my_arr)
+   contains
+      subroutine  fill_array(arr)
+         implicit none
+         real, dimension(-2:0), intent(out) :: arr
+         arr = 42
+      end subroutine fill_array
+end program gprogram
+
Index: gcc/testsuite/gfortran.dg/gomp/pr44085.f90
===================================================================
--- gcc/testsuite/gfortran.dg/gomp/pr44085.f90	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gfortran.dg/gomp/pr44085.f90	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,25 @@
+! PR middle-end/44085
+! { dg-do compile }
+! { dg-require-effective-target tls_native }
+! { dg-options "-fopenmp" }
+
+  integer, save :: thr1, thr2
+  integer :: thr3, thr4
+  common /thrs/ thr3, thr4
+!$omp threadprivate (thr1, thr2, /thrs/)
+
+!$omp task untied		! { dg-error "enclosing task" }
+  thr1 = thr1 + 1		! { dg-error "used in untied task" }
+  thr2 = thr2 + 2		! { dg-error "used in untied task" }
+  thr3 = thr3 + 3		! { dg-error "used in untied task" }
+  thr4 = thr4 + 4		! { dg-error "used in untied task" }
+!$omp end task
+
+!$omp task
+  thr1 = thr1 + 1
+  thr2 = thr2 + 2
+  thr3 = thr3 + 3
+  thr4 = thr4 + 4
+!$omp end task
+
+  end
Index: gcc/testsuite/gfortran.dg/gomp/pr44036-1.f90
===================================================================
--- gcc/testsuite/gfortran.dg/gomp/pr44036-1.f90	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gfortran.dg/gomp/pr44036-1.f90	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,24 @@
+! PR fortran/44036
+! { dg-do compile }
+! { dg-options "-fopenmp" }
+subroutine foo(a, b)
+  integer, external :: a
+  integer, external, pointer :: b
+  integer, external :: c
+  integer, external, pointer :: d
+  integer :: x
+  x = 6
+!$omp parallel default(none) private (x)
+  x = a(4)
+!$omp end parallel
+!$omp parallel default(none) private (x)	! { dg-error "enclosing parallel" }
+  x = b(5)					! { dg-error "not specified in" }
+!$omp end parallel
+!$omp parallel default(none) private (x)
+  x = c(6)
+!$omp end parallel
+  d => a
+!$omp parallel default(none) private (x)	! { dg-error "enclosing parallel" }
+  x = d(7)					! { dg-error "not specified in" }
+!$omp end parallel
+end
Index: gcc/testsuite/gfortran.dg/gomp/pr44036-2.f90
===================================================================
--- gcc/testsuite/gfortran.dg/gomp/pr44036-2.f90	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gfortran.dg/gomp/pr44036-2.f90	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,17 @@
+! PR fortran/44036
+! { dg-do compile }
+! { dg-options "-fopenmp" }
+subroutine foo(a, b)
+  integer, external :: a
+  integer, external, pointer :: b
+  integer, external :: c
+  integer, external, pointer :: d
+  integer :: x
+  d => a
+!$omp parallel default(none) private (x) firstprivate (b, d)
+  x = a(4)
+  x = b(5)
+  x = c(6)
+  x = d(7)
+!$omp end parallel
+end
Index: gcc/testsuite/gfortran.dg/gomp/pr44036-3.f90
===================================================================
--- gcc/testsuite/gfortran.dg/gomp/pr44036-3.f90	(.../tags/gcc_4_4_4_release)	(wersja 0)
+++ gcc/testsuite/gfortran.dg/gomp/pr44036-3.f90	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -0,0 +1,13 @@
+! PR fortran/44036
+! { dg-do compile }
+! { dg-options "-fopenmp" }
+subroutine foo(a)
+  integer, external :: a, c
+  integer :: x
+!$omp parallel default(none) private (x) shared (a)	! { dg-error "is not a variable" }
+  x = a(6)
+!$omp end parallel
+!$omp parallel default(none) private (x) shared (c)	! { dg-error "is not a variable" }
+  x = c(6)
+!$omp end parallel
+end
Index: gcc/testsuite/gfortran.dg/vect/vect.exp
===================================================================
--- gcc/testsuite/gfortran.dg/vect/vect.exp	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/testsuite/gfortran.dg/vect/vect.exp	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,4 +1,4 @@
-# Copyright (C) 1997, 2004, 2007, 2008 Free Software Foundation, Inc.
+# Copyright (C) 1997, 2004, 2007, 2008, 2010 Free Software Foundation, Inc.
 
 # This program is free software; you can redistribute it and/or modify
 # it under the terms of the GNU General Public License as published by
@@ -64,6 +64,9 @@
 } elseif { [istarget  "spu-*-*"] } {
    set dg-do-what-default run
 } elseif { [istarget "i?86-*-*"] || [istarget "x86_64-*-*"] } {
+    if { ![check_effective_target_sse2] } then {
+	return
+    }
     lappend DEFAULT_VECTCFLAGS "-msse2"
     if [check_sse2_hw_available] {
 	set dg-do-what-default run
Index: gcc/df-scan.c
===================================================================
--- gcc/df-scan.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/df-scan.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2308,7 +2308,7 @@
       if (DF_REF_EXTRACT_MODE (ref1) != DF_REF_EXTRACT_MODE (ref2))
 	return DF_REF_EXTRACT_MODE (ref1) - DF_REF_EXTRACT_MODE (ref2);
     }
-  return 0;
+  return (int)DF_REF_ORDER (ref1) - (int)DF_REF_ORDER (ref2);
 }
 
 static void
Index: gcc/cp/decl.c
===================================================================
--- gcc/cp/decl.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/cp/decl.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -8502,6 +8502,34 @@
 		   declarator->kind == cdk_reference ? "reference" : "pointer",
 		   type);
 
+	  /* When the pointed-to type involves components of variable size,
+	     care must be taken to ensure that the size evaluation code is
+	     emitted early enough to dominate all the possible later uses
+	     and late enough for the variables on which it depends to have
+	     been assigned.
+
+	     This is expected to happen automatically when the pointed-to
+	     type has a name/declaration of it's own, but special attention
+	     is required if the type is anonymous.
+
+	     We handle the NORMAL and FIELD contexts here by inserting a
+	     dummy statement that just evaluates the size at a safe point
+	     and ensures it is not deferred until e.g. within a deeper
+	     conditional context (c++/43555).
+
+	     We expect nothing to be needed here for PARM or TYPENAME.
+	     Evaluating the size at this point for TYPENAME would
+	     actually be incorrect, as we might be in the middle of an
+	     expression with side effects on the pointed-to type size
+	     "arguments" prior to the pointer declaration point and the
+	     size evaluation could end up prior to the side effects.  */
+
+	  if (!TYPE_NAME (type)
+	      && (decl_context == NORMAL || decl_context == FIELD)
+	      && at_function_scope_p ()
+	      && variably_modified_type_p (type, NULL_TREE))
+	    finish_expr_stmt (TYPE_SIZE (type));
+
 	  if (declarator->kind == cdk_reference)
 	    {
 	      /* In C++0x, the type we are creating a reference to might be
Index: gcc/cp/ChangeLog
===================================================================
--- gcc/cp/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/cp/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,15 @@
+2010-05-27  Jason Merrill  <jason@redhat.com>
+
+	PR c++/43555
+	* decl.c (grokdeclarator) [cdk_pointer et al]: Force evaluation of
+	anonymous VLA size.
+
+2010-05-19  Jason Merrill  <jason@redhat.com>
+
+	PR c++/44193
+	* pt.c (tsubst) [TYPENAME_TYPE]: Discard cv-quals on
+	function/reference type.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: gcc/cp/pt.c
===================================================================
--- gcc/cp/pt.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/cp/pt.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -9708,6 +9708,7 @@
 				     in_decl, /*entering_scope=*/1);
 	tree f = tsubst_copy (TYPENAME_TYPE_FULLNAME (t), args,
 			      complain, in_decl);
+	int quals;
 
 	if (ctx == error_mark_node || f == error_mark_node)
 	  return error_mark_node;
@@ -9757,8 +9758,15 @@
 		     t, f);
 	  }
 
-	return cp_build_qualified_type_real
-	  (f, cp_type_quals (f) | cp_type_quals (t), complain);
+	/* cv-quals from the template are discarded when
+	   substituting in a function or reference type.  */
+	if (TREE_CODE (f) == FUNCTION_TYPE
+	    || TREE_CODE (f) == METHOD_TYPE
+	    || TREE_CODE (f) == REFERENCE_TYPE)
+	  quals = cp_type_quals (f);
+	else
+	  quals = cp_type_quals (f) | cp_type_quals (t);
+	return cp_build_qualified_type_real (f, quals, complain);
       }
 
     case UNBOUND_CLASS_TEMPLATE:
Index: gcc/tree-ssa-loop-ivopts.c
===================================================================
--- gcc/tree-ssa-loop-ivopts.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/tree-ssa-loop-ivopts.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1525,17 +1525,19 @@
 
   if (mode != BLKmode)
     {
-      double_int mul;
-      tree al = build_int_cst (TREE_TYPE (step),
-			       GET_MODE_ALIGNMENT (mode) / BITS_PER_UNIT);
+      unsigned mode_align = GET_MODE_ALIGNMENT (mode);
 
-      if (base_align < GET_MODE_ALIGNMENT (mode)
-	  || bitpos % GET_MODE_ALIGNMENT (mode) != 0
-	  || bitpos % BITS_PER_UNIT != 0)
+      if (base_align < mode_align
+	  || (bitpos % mode_align) != 0
+	  || (bitpos % BITS_PER_UNIT) != 0)
 	return true;
-    
-      if (!constant_multiple_of (step, al, &mul))
+
+      if (toffset
+	  && (highest_pow2_factor (toffset) * BITS_PER_UNIT) < mode_align)
 	return true;
+
+      if ((highest_pow2_factor (step) * BITS_PER_UNIT) < mode_align)
+	return true;
     }
 
   return false;
Index: gcc/config.in
===================================================================
--- gcc/config.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -274,8 +274,20 @@
 #endif
 
 
-/* Define if your assembler supports the sahf mnemonic. */
+/* Define if your assembler supports the .quad directive. */
 #ifndef USED_FOR_TARGET
+#undef HAVE_AS_IX86_QUAD
+#endif
+
+
+/* Define true if the assembler supports 'rep <insn>, lock <insn>'. */
+#ifndef USED_FOR_TARGET
+#undef HAVE_AS_IX86_REP_LOCK_PREFIX
+#endif
+
+
+/* Define if your assembler supports the sahf mnemonic in 64bit mode. */
+#ifndef USED_FOR_TARGET
 #undef HAVE_AS_IX86_SAHF
 #endif
 
Index: gcc/sel-sched-ir.c
===================================================================
--- gcc/sel-sched-ir.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/sel-sched-ir.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1505,14 +1505,6 @@
     {
       expr_history_def *phist = VEC_index (expr_history_def, vect, ind);
 
-      /* When merging, either old vinsns are the *same* or, if not, both 
-         old and new vinsns are different pointers.  In the latter case, 
-         though, new vinsns should be equal.  */
-      gcc_assert (phist->old_expr_vinsn == old_expr_vinsn
-                  || (phist->new_expr_vinsn != new_expr_vinsn 
-                      && (vinsn_equal_p 
-                          (phist->old_expr_vinsn, old_expr_vinsn))));
-
       /* It is possible that speculation types of expressions that were 
          propagated through different paths will be different here.  In this
          case, merge the status to get the correct check later.  */
Index: gcc/fortran/openmp.c
===================================================================
--- gcc/fortran/openmp.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/fortran/openmp.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -812,6 +812,8 @@
 		if (el)
 		  continue;
 	      }
+	    if (n->sym->attr.proc_pointer)
+	      continue;
 	  }
 	gfc_error ("Object '%s' is not a variable at %L", n->sym->name,
 		   &code->loc);
Index: gcc/fortran/interface.c
===================================================================
--- gcc/fortran/interface.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/fortran/interface.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1625,8 +1625,8 @@
 	  || sym->as->lower[i]->expr_type != EXPR_CONSTANT)
 	return 0;
 
-      elements *= mpz_get_ui (sym->as->upper[i]->value.integer)
-		  - mpz_get_ui (sym->as->lower[i]->value.integer) + 1L;
+      elements *= mpz_get_si (sym->as->upper[i]->value.integer)
+		  - mpz_get_si (sym->as->lower[i]->value.integer) + 1L;
     }
 
   return strlen*elements;
Index: gcc/fortran/trans-openmp.c
===================================================================
--- gcc/fortran/trans-openmp.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/fortran/trans-openmp.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -56,7 +56,8 @@
       if (GFC_POINTER_TYPE_P (type))
 	return false;
 
-      if (!DECL_ARTIFICIAL (decl))
+      if (!DECL_ARTIFICIAL (decl)
+	  && TREE_CODE (TREE_TYPE (type)) != FUNCTION_TYPE)
 	return true;
 
       /* Some arrays are expanded as DECL_ARTIFICIAL pointers
@@ -95,6 +96,15 @@
 	 == NULL)
     return OMP_CLAUSE_DEFAULT_SHARED;
 
+  /* Dummy procedures aren't considered variables by OpenMP, thus are
+     disallowed in OpenMP clauses.  They are represented as PARM_DECLs
+     in the middle-end, so return OMP_CLAUSE_DEFAULT_FIRSTPRIVATE here
+     to avoid complaining about their uses with default(none).  */
+  if (TREE_CODE (decl) == PARM_DECL
+      && TREE_CODE (TREE_TYPE (decl)) == POINTER_TYPE
+      && TREE_CODE (TREE_TYPE (TREE_TYPE (decl))) == FUNCTION_TYPE)
+    return OMP_CLAUSE_DEFAULT_FIRSTPRIVATE;
+
   /* COMMON and EQUIVALENCE decls are shared.  They
      are only referenced through DECL_VALUE_EXPR of the variables
      contained in them.  If those are privatized, they will not be
Index: gcc/fortran/ChangeLog
===================================================================
--- gcc/fortran/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/fortran/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,19 @@
+2010-05-14  Steven G. Kargl  <kargl@gcc.gnu.org>
+
+	PR fortran/44135
+	* fortran/interface.c (get_sym_storage_size): Use signed instead of
+	unsigned mpz_get_?i routines.
+
+2010-05-13  Jakub Jelinek  <jakub@redhat.com>
+
+	PR fortran/44036
+	* openmp.c (resolve_omp_clauses): Allow procedure pointers in clause
+	variable lists.
+	* trans-openmp.c (gfc_omp_privatize_by_reference): Don't privatize
+	by reference dummy procedures or non-dummy procedure pointers.
+	(gfc_omp_predetermined_sharing): Return
+	OMP_CLAUSE_DEFAULT_FIRSTPRIVATE for dummy procedures.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: gcc/configure.ac
===================================================================
--- gcc/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2094,7 +2094,35 @@
 gcc_GAS_CHECK_FEATURE([.hidden], gcc_cv_as_hidden,
  [elf,2,13,0],,
 [	.hidden foobar
-foobar:])
+foobar:],[
+# Solaris 9/x86 as incorrectly emits an alias for a hidden symbol with
+# STV_HIDDEN, so disable .hidden support if so.
+case "${target}" in
+  i?86-*-solaris2*)
+    if test x$gcc_cv_as != x && test x$gcc_cv_objdump != x; then
+      cat > conftest.s <<EOF
+.globl hidden
+        .hidden hidden
+hidden:
+.globl default
+        .set    default,hidden
+EOF
+      if $gcc_cv_as -o conftest.o conftest.s > /dev/null 2>&1 \
+        && $gcc_cv_objdump -t conftest.o 2>/dev/null | \
+        grep '\.hidden default' > /dev/null; then
+        gcc_cv_as_hidden=no
+      else
+        gcc_cv_as_hidden=yes
+      fi
+    else
+      # Assume bug is present if objdump is missing.
+      gcc_cv_as_hidden=no
+    fi
+    ;;
+  *)
+    gcc_cv_as_hidden=yes
+    ;;
+esac])
 
 AC_CACHE_CHECK(linker for .hidden support, gcc_cv_ld_hidden,
 [if test $in_tree_ld = yes ; then
@@ -2991,11 +3019,18 @@
       [AC_DEFINE(HAVE_AS_IX86_FFREEP, 1,
         [Define if your assembler supports the ffreep mnemonic.])])
 
+    gcc_GAS_CHECK_FEATURE([.quad directive],
+      gcc_cv_as_ix86_quad,,,
+      [.quad 0],,
+      [AC_DEFINE(HAVE_AS_IX86_QUAD, 1,
+        [Define if your assembler supports the .quad directive.])])
+
     gcc_GAS_CHECK_FEATURE([sahf mnemonic],
       gcc_cv_as_ix86_sahf,,,
-      [sahf],,
+      [.code64
+       sahf],,
       [AC_DEFINE(HAVE_AS_IX86_SAHF, 1,
-        [Define if your assembler supports the sahf mnemonic.])])
+        [Define if your assembler supports the sahf mnemonic in 64bit mode.])])
 
     gcc_GAS_CHECK_FEATURE([different section symbol subtraction],
       gcc_cv_as_ix86_diff_sect_delta,,,
@@ -3009,7 +3044,7 @@
       [AC_DEFINE(HAVE_AS_IX86_DIFF_SECT_DELTA, 1,
         [Define if your assembler supports the subtraction of symbols in different sections.])])
 
-    # This one is used unconditionally by i386.[ch]; it is to be defined
+    # These two are used unconditionally by i386.[ch]; it is to be defined
     # to 1 if the feature is present, 0 otherwise.
     gcc_GAS_CHECK_FEATURE([GOTOFF in data],
         gcc_cv_as_ix86_gotoff_in_data, [2,11,0],,
@@ -3021,6 +3056,15 @@
     AC_DEFINE_UNQUOTED(HAVE_AS_GOTOFF_IN_DATA,
       [`if test $gcc_cv_as_ix86_gotoff_in_data = yes; then echo 1; else echo 0; fi`],
       [Define true if the assembler supports '.long foo@GOTOFF'.])
+
+    gcc_GAS_CHECK_FEATURE([rep and lock prefix],
+        gcc_cv_as_ix86_rep_lock_prefix,,,
+	[rep movsl
+	 lock orl $0, (%esp)])
+    AC_DEFINE_UNQUOTED(HAVE_AS_IX86_REP_LOCK_PREFIX,
+      [`if test $gcc_cv_as_ix86_rep_lock_prefix = yes; then echo 1; else echo 0; fi`],
+      [Define true if the assembler supports 'rep <insn>, lock <insn>'.])
+
     ;;
 
   ia64*-*-*)
Index: gcc/BASE-VER
===================================================================
--- gcc/BASE-VER	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/BASE-VER	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1 +1 @@
-4.4.4
+4.4.5
Index: gcc/alias.c
===================================================================
--- gcc/alias.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/alias.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2214,8 +2214,18 @@
   if (mem_mode == VOIDmode)
     mem_mode = GET_MODE (mem);
 
-  x_addr = get_addr (XEXP (x, 0));
-  mem_addr = get_addr (XEXP (mem, 0));
+  x_addr = XEXP (x, 0);
+  mem_addr = XEXP (mem, 0);
+  if (!((GET_CODE (x_addr) == VALUE
+	 && GET_CODE (mem_addr) != VALUE
+	 && reg_mentioned_p (x_addr, mem_addr))
+	|| (GET_CODE (x_addr) != VALUE
+	    && GET_CODE (mem_addr) == VALUE
+	    && reg_mentioned_p (mem_addr, x_addr))))
+    {
+      x_addr = get_addr (x_addr);
+      mem_addr = get_addr (mem_addr);
+    }
 
   base = find_base_term (x_addr);
   if (base && (GET_CODE (base) == LABEL_REF
@@ -2287,7 +2297,16 @@
     return 0;
 
   if (! x_addr)
-    x_addr = get_addr (XEXP (x, 0));
+    {
+      x_addr = XEXP (x, 0);
+      if (!((GET_CODE (x_addr) == VALUE
+	     && GET_CODE (mem_addr) != VALUE
+	     && reg_mentioned_p (x_addr, mem_addr))
+	    || (GET_CODE (x_addr) != VALUE
+		&& GET_CODE (mem_addr) == VALUE
+		&& reg_mentioned_p (mem_addr, x_addr))))
+	x_addr = get_addr (x_addr);
+    }
 
   if (! base_alias_check (x_addr, mem_addr, GET_MODE (x), mem_mode))
     return 0;
@@ -2347,8 +2366,18 @@
   if (nonoverlapping_memrefs_p (x, mem))
     return 0;
 
-  x_addr = get_addr (XEXP (x, 0));
-  mem_addr = get_addr (XEXP (mem, 0));
+  x_addr = XEXP (x, 0);
+  mem_addr = XEXP (mem, 0);
+  if (!((GET_CODE (x_addr) == VALUE
+	 && GET_CODE (mem_addr) != VALUE
+	 && reg_mentioned_p (x_addr, mem_addr))
+	|| (GET_CODE (x_addr) != VALUE
+	    && GET_CODE (mem_addr) == VALUE
+	    && reg_mentioned_p (mem_addr, x_addr))))
+    {
+      x_addr = get_addr (x_addr);
+      mem_addr = get_addr (mem_addr);
+    }
 
   if (! writep)
     {
Index: gcc/gimplify.c
===================================================================
--- gcc/gimplify.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/gimplify.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -74,9 +74,10 @@
 enum omp_region_type
 {
   ORT_WORKSHARE = 0,
-  ORT_TASK = 1,
   ORT_PARALLEL = 2,
-  ORT_COMBINED_PARALLEL = 3
+  ORT_COMBINED_PARALLEL = 3,
+  ORT_TASK = 4,
+  ORT_UNTIED_TASK = 5
 };
 
 struct gimplify_omp_ctx
@@ -320,7 +321,7 @@
   c->privatized_types = pointer_set_create ();
   c->location = input_location;
   c->region_type = region_type;
-  if (region_type != ORT_TASK)
+  if ((region_type & ORT_TASK) == 0)
     c->default_kind = OMP_CLAUSE_DEFAULT_SHARED;
   else
     c->default_kind = OMP_CLAUSE_DEFAULT_UNSPECIFIED;
@@ -5290,6 +5291,32 @@
   splay_tree_insert (ctx->variables, (splay_tree_key)decl, flags);
 }
 
+/* Notice a threadprivate variable DECL used in OpenMP context CTX.
+   This just prints out diagnostics about threadprivate variable uses
+   in untied tasks.  If DECL2 is non-NULL, prevent this warning
+   on that variable.  */
+
+static bool
+omp_notice_threadprivate_variable (struct gimplify_omp_ctx *ctx, tree decl,
+				   tree decl2)
+{
+  splay_tree_node n;
+
+  if (ctx->region_type != ORT_UNTIED_TASK)
+    return false;
+  n = splay_tree_lookup (ctx->variables, (splay_tree_key)decl);
+  if (n == NULL)
+    {
+      error ("threadprivate variable %qs used in untied task",
+	     IDENTIFIER_POINTER (DECL_NAME (decl)));
+      error ("%Henclosing task", &ctx->location);
+      splay_tree_insert (ctx->variables, (splay_tree_key)decl, 0);
+    }
+  if (decl2)
+    splay_tree_insert (ctx->variables, (splay_tree_key)decl2, 0);
+  return false;
+}
+
 /* Record the fact that DECL was used within the OpenMP context CTX.
    IN_CODE is true when real code uses DECL, and false when we should
    merely emit default(none) errors.  Return true if DECL is going to
@@ -5310,14 +5337,14 @@
   if (is_global_var (decl))
     {
       if (DECL_THREAD_LOCAL_P (decl))
-	return false;
+	return omp_notice_threadprivate_variable (ctx, decl, NULL_TREE);
 
       if (DECL_HAS_VALUE_EXPR_P (decl))
 	{
 	  tree value = get_base_address (DECL_VALUE_EXPR (decl));
 
 	  if (value && DECL_P (value) && DECL_THREAD_LOCAL_P (value))
-	    return false;
+	    return omp_notice_threadprivate_variable (ctx, decl, value);
 	}
     }
 
@@ -5343,8 +5370,11 @@
 	case OMP_CLAUSE_DEFAULT_NONE:
 	  error ("%qs not specified in enclosing parallel",
 		 IDENTIFIER_POINTER (DECL_NAME (decl)));
-	  error ("%Henclosing parallel", &ctx->location);
-	  /* FALLTHRU */
+	  if ((ctx->region_type & ORT_TASK) != 0)
+	    error ("%Henclosing task", &ctx->location);
+	  else
+	    error ("%Henclosing parallel", &ctx->location);
+ 	  /* FALLTHRU */
 	case OMP_CLAUSE_DEFAULT_SHARED:
 	  flags |= GOVD_SHARED;
 	  break;
@@ -5356,7 +5386,7 @@
 	  break;
 	case OMP_CLAUSE_DEFAULT_UNSPECIFIED:
 	  /* decl will be either GOVD_FIRSTPRIVATE or GOVD_SHARED.  */
-	  gcc_assert (ctx->region_type == ORT_TASK);
+	  gcc_assert ((ctx->region_type & ORT_TASK) != 0);
 	  if (ctx->outer_context)
 	    omp_notice_variable (ctx->outer_context, decl, in_code);
 	  for (octx = ctx->outer_context; octx; octx = octx->outer_context)
@@ -5859,7 +5889,10 @@
   gimple_seq body = NULL;
   struct gimplify_ctx gctx;
 
-  gimplify_scan_omp_clauses (&OMP_TASK_CLAUSES (expr), pre_p, ORT_TASK);
+  gimplify_scan_omp_clauses (&OMP_TASK_CLAUSES (expr), pre_p,
+			     find_omp_clause (OMP_TASK_CLAUSES (expr),
+					      OMP_CLAUSE_UNTIED)
+			     ? ORT_UNTIED_TASK : ORT_TASK);
 
   push_gimplify_context (&gctx);
 
Index: gcc/tree-cfgcleanup.c
===================================================================
--- gcc/tree-cfgcleanup.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/tree-cfgcleanup.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,5 @@
 /* CFG cleanup for trees.
-   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009
+   Copyright (C) 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010
    Free Software Foundation, Inc.
 
 This file is part of GCC.
@@ -224,6 +224,7 @@
   edge_iterator ei;
   edge e, succ;
   basic_block dest;
+  location_t locus;
 
   /* BB must have a single outgoing edge.  */
   if (single_succ_p (bb) != 1
@@ -242,6 +243,8 @@
   gcc_assert (bb != ENTRY_BLOCK_PTR);
 #endif
 
+  locus = single_succ_edge (bb)->goto_locus;
+
   /* Now walk through the statements backward.  We can ignore labels,
      anything else means this is not a forwarder block.  */
   for (gsi = gsi_last_bb (bb); !gsi_end_p (gsi); gsi_prev (&gsi))
@@ -253,6 +256,8 @@
 	case GIMPLE_LABEL:
 	  if (DECL_NONLOCAL (gimple_label_label (stmt)))
 	    return false;
+	  if (optimize == 0 && gimple_location (stmt) != locus)
+	    return false;
 	  break;
 
 	default:
@@ -289,6 +294,10 @@
 	  if (!single_pred_p (dest))
 	    return false;
 	}
+      /* If goto_locus of any of the edges differs, prevent removing
+	 the forwarder block for -O0.  */
+      if (optimize == 0 && e->goto_locus != locus)
+	return false;
     }
 
   return true;
@@ -543,12 +552,8 @@
     return true;
 
   retval = cleanup_control_flow_bb (bb);
-  
-  /* Forwarder blocks can carry line number information which is
-     useful when debugging, so we only clean them up when
-     optimizing.  */
-  if (optimize > 0
-      && tree_forwarder_block_p (bb, false)
+
+  if (tree_forwarder_block_p (bb, false)
       && remove_forwarder_block (bb))
     return true;
 
Index: gcc/tree-ssa-pre.c
===================================================================
--- gcc/tree-ssa-pre.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/tree-ssa-pre.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2509,31 +2509,46 @@
     {
     case CALL_EXPR:
       {
-	tree folded, sc = currop->op1;
+	tree folded, sc = NULL_TREE;
 	unsigned int nargs = 0;
-	tree *args = XNEWVEC (tree, VEC_length (vn_reference_op_s,
-						ref->operands) - 1);
+	tree fn, *args;
+	if (TREE_CODE (currop->op0) == FUNCTION_DECL)
+	  fn = currop->op0;
+	else
+	  {
+	    pre_expr op0 = get_or_alloc_expr_for (currop->op0);
+	    fn = find_or_generate_expression (block, op0, stmts, domstmt);
+	    if (!fn)
+	      return NULL_TREE;
+	  }
+	if (currop->op1)
+	  {
+	    pre_expr scexpr = get_or_alloc_expr_for (currop->op1);
+	    sc = find_or_generate_expression (block, scexpr, stmts, domstmt);
+	    if (!sc)
+	      return NULL_TREE;
+	  }
+	args = XNEWVEC (tree, VEC_length (vn_reference_op_s,
+					  ref->operands) - 1);
 	while (*operand < VEC_length (vn_reference_op_s, ref->operands))
 	  {
 	    args[nargs] = create_component_ref_by_pieces_1 (block, ref,
 							    operand, stmts,
 							    domstmt);
+	    if (!args[nargs])
+	      {
+		free (args);
+		return NULL_TREE;
+	      }
 	    nargs++;
 	  }
 	folded = build_call_array (currop->type,
-				   TREE_CODE (currop->op0) == FUNCTION_DECL
-				   ? build_fold_addr_expr (currop->op0)
-				   : currop->op0,
+				   (TREE_CODE (fn) == FUNCTION_DECL
+				    ? build_fold_addr_expr (fn) : fn),
 				   nargs, args);
 	free (args);
 	if (sc)
-	  {
-	    pre_expr scexpr = get_or_alloc_expr_for (sc);
-	    sc = find_or_generate_expression (block, scexpr, stmts, domstmt);
-	    if (!sc)
-	      return NULL_TREE;
-	    CALL_EXPR_STATIC_CHAIN (folded) = sc;
-	  }
+	  CALL_EXPR_STATIC_CHAIN (folded) = sc;
 	return folded;
       }
       break;
Index: gcc/c-omp.c
===================================================================
--- gcc/c-omp.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/c-omp.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,7 +1,7 @@
 /* This file contains routines to construct GNU OpenMP constructs, 
    called from parsing in the C and C++ front ends.
 
-   Copyright (C) 2005, 2007, 2008, 2009 Free Software Foundation, Inc.
+   Copyright (C) 2005, 2007, 2008, 2009, 2010 Free Software Foundation, Inc.
    Contributed by Richard Henderson <rth@redhat.com>,
 		  Diego Novillo <dnovillo@redhat.com>.
 
@@ -281,7 +281,8 @@
 	      || TREE_CODE (cond) == LE_EXPR
 	      || TREE_CODE (cond) == GT_EXPR
 	      || TREE_CODE (cond) == GE_EXPR
-	      || TREE_CODE (cond) == NE_EXPR)
+	      || TREE_CODE (cond) == NE_EXPR
+	      || TREE_CODE (cond) == EQ_EXPR)
 	    {
 	      tree op0 = TREE_OPERAND (cond, 0);
 	      tree op1 = TREE_OPERAND (cond, 1);
@@ -326,18 +327,21 @@
 		  cond_ok = true;
 		}
 
-	      if (TREE_CODE (cond) == NE_EXPR)
+	      if (TREE_CODE (cond) == NE_EXPR
+		  || TREE_CODE (cond) == EQ_EXPR)
 		{
 		  if (!INTEGRAL_TYPE_P (TREE_TYPE (decl)))
 		    cond_ok = false;
 		  else if (operand_equal_p (TREE_OPERAND (cond, 1),
 					    TYPE_MIN_VALUE (TREE_TYPE (decl)),
 					    0))
-		    TREE_SET_CODE (cond, GT_EXPR);
+		    TREE_SET_CODE (cond, TREE_CODE (cond) == NE_EXPR
+					 ? GT_EXPR : LE_EXPR);
 		  else if (operand_equal_p (TREE_OPERAND (cond, 1),
 					    TYPE_MAX_VALUE (TREE_TYPE (decl)),
 					    0))
-		    TREE_SET_CODE (cond, LT_EXPR);
+		    TREE_SET_CODE (cond, TREE_CODE (cond) == NE_EXPR
+					 ? LT_EXPR : GE_EXPR);
 		  else
 		    cond_ok = false;
 		}
Index: gcc/c-common.c
===================================================================
--- gcc/c-common.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/c-common.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -5957,10 +5957,12 @@
     }
   else if (is_type)
     {
+      if ((flags & (int) ATTR_FLAG_TYPE_IN_PLACE))
+	/* OK, modify the type in place.  */;
       /* If we have a TYPE_DECL, then copy the type, so that we
 	 don't accidentally modify a builtin type.  See pushdecl.  */
-      if (decl && TREE_TYPE (decl) != error_mark_node
-	  && DECL_ORIGINAL_TYPE (decl) == NULL_TREE)
+      else if (decl && TREE_TYPE (decl) != error_mark_node
+	       && DECL_ORIGINAL_TYPE (decl) == NULL_TREE)
 	{
 	  tree tt = TREE_TYPE (decl);
 	  *type = build_variant_type_copy (*type);
@@ -5969,7 +5971,7 @@
 	  TREE_USED (*type) = TREE_USED (decl);
 	  TREE_TYPE (decl) = *type;
 	}
-      else if (!(flags & (int) ATTR_FLAG_TYPE_IN_PLACE))
+      else
 	*type = build_variant_type_copy (*type);
 
       TYPE_ALIGN (*type) = (1 << i) * BITS_PER_UNIT;
Index: gcc/config/s390/s390.c
===================================================================
--- gcc/config/s390/s390.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/s390/s390.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1657,7 +1657,7 @@
       if (!PARAM_SET_P (PARAM_MAX_UNROLL_TIMES))
 	set_param_value ("max-unroll-times", 32);
       if (!PARAM_SET_P (PARAM_MAX_COMPLETELY_PEELED_INSNS))
-	set_param_value ("max-completely-peeled-insns", 800);
+	set_param_value ("max-completely-peeled-insns", 2000);
       if (!PARAM_SET_P (PARAM_MAX_COMPLETELY_PEEL_TIMES))
 	set_param_value ("max-completely-peel-times", 64);
     }
Index: gcc/config/s390/s390.md
===================================================================
--- gcc/config/s390/s390.md	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/s390/s390.md	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1876,7 +1876,7 @@
    stcy\t%1,%0
    mvi\t%S0,%b1
    mviy\t%S0,%b1
-   *"
+   #"
   [(set_attr "op_type" "RR,RI,RX,RXY,RX,RXY,SI,SIY,SS")
    (set_attr "type" "lr,*,*,*,store,store,store,store,*")
    (set_attr "z10prop" "z10_fr_E1,
Index: gcc/config/i386/i386.md
===================================================================
--- gcc/config/i386/i386.md	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/i386/i386.md	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1314,11 +1314,12 @@
 		   UNSPEC_SAHF))]
   "TARGET_SAHF"
 {
-#ifdef HAVE_AS_IX86_SAHF
+#ifndef HAVE_AS_IX86_SAHF
+  if (TARGET_64BIT)
+    return ".byte\t0x9e";
+  else
+#endif
   return "sahf";
-#else
-  return ".byte\t0x9e";
-#endif
 }
   [(set_attr "length" "1")
    (set_attr "athlon_decode" "vector")
@@ -19144,7 +19145,7 @@
 	(mem:BLK (match_dup 4)))
    (use (match_dup 5))]
   "TARGET_64BIT"
-  "rep movsq"
+  "rep{%;} movsq"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "both")
@@ -19163,7 +19164,7 @@
 	(mem:BLK (match_dup 4)))
    (use (match_dup 5))]
   "!TARGET_64BIT"
-  "rep movs{l|d}"
+  "rep{%;} movs{l|d}"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "both")
@@ -19182,7 +19183,7 @@
 	(mem:BLK (match_dup 4)))
    (use (match_dup 5))]
   "TARGET_64BIT"
-  "rep movs{l|d}"
+  "rep{%;} movs{l|d}"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "both")
@@ -19199,7 +19200,7 @@
 	(mem:BLK (match_dup 4)))
    (use (match_dup 5))]
   "!TARGET_64BIT"
-  "rep movsb"
+  "rep{%;} movsb"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "both")
@@ -19216,7 +19217,7 @@
 	(mem:BLK (match_dup 4)))
    (use (match_dup 5))]
   "TARGET_64BIT"
-  "rep movsb"
+  "rep{%;} movsb"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "both")
@@ -19396,7 +19397,7 @@
    (use (match_operand:DI 2 "register_operand" "a"))
    (use (match_dup 4))]
   "TARGET_64BIT"
-  "rep stosq"
+  "rep{%;} stosq"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "store")
@@ -19413,7 +19414,7 @@
    (use (match_operand:SI 2 "register_operand" "a"))
    (use (match_dup 4))]
   "!TARGET_64BIT"
-  "rep stos{l|d}"
+  "rep{%;} stos{l|d}"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "store")
@@ -19430,7 +19431,7 @@
    (use (match_operand:SI 2 "register_operand" "a"))
    (use (match_dup 4))]
   "TARGET_64BIT"
-  "rep stos{l|d}"
+  "rep{%;} stos{l|d}"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "store")
@@ -19446,7 +19447,7 @@
    (use (match_operand:QI 2 "register_operand" "a"))
    (use (match_dup 4))]
   "!TARGET_64BIT"
-  "rep stosb"
+  "rep{%;} stosb"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "store")
@@ -19462,7 +19463,7 @@
    (use (match_operand:QI 2 "register_operand" "a"))
    (use (match_dup 4))]
   "TARGET_64BIT"
-  "rep stosb"
+  "rep{%;} stosb"
   [(set_attr "type" "str")
    (set_attr "prefix_rep" "1")
    (set_attr "memory" "store")
@@ -19574,7 +19575,7 @@
    (clobber (match_operand:SI 1 "register_operand" "=D"))
    (clobber (match_operand:SI 2 "register_operand" "=c"))]
   "!TARGET_64BIT"
-  "repz cmpsb"
+  "repz{%;} cmpsb"
   [(set_attr "type" "str")
    (set_attr "mode" "QI")
    (set_attr "prefix_rep" "1")])
@@ -19589,7 +19590,7 @@
    (clobber (match_operand:DI 1 "register_operand" "=D"))
    (clobber (match_operand:DI 2 "register_operand" "=c"))]
   "TARGET_64BIT"
-  "repz cmpsb"
+  "repz{%;} cmpsb"
   [(set_attr "type" "str")
    (set_attr "mode" "QI")
    (set_attr "prefix_rep" "1")])
@@ -19624,7 +19625,7 @@
    (clobber (match_operand:SI 1 "register_operand" "=D"))
    (clobber (match_operand:SI 2 "register_operand" "=c"))]
   "!TARGET_64BIT"
-  "repz cmpsb"
+  "repz{%;} cmpsb"
   [(set_attr "type" "str")
    (set_attr "mode" "QI")
    (set_attr "prefix_rep" "1")])
@@ -19642,7 +19643,7 @@
    (clobber (match_operand:DI 1 "register_operand" "=D"))
    (clobber (match_operand:DI 2 "register_operand" "=c"))]
   "TARGET_64BIT"
-  "repz cmpsb"
+  "repz{%;} cmpsb"
   [(set_attr "type" "str")
    (set_attr "mode" "QI")
    (set_attr "prefix_rep" "1")])
@@ -19689,7 +19690,7 @@
    (clobber (match_operand:SI 1 "register_operand" "=D"))
    (clobber (reg:CC FLAGS_REG))]
   "!TARGET_64BIT"
-  "repnz scasb"
+  "repnz{%;} scasb"
   [(set_attr "type" "str")
    (set_attr "mode" "QI")
    (set_attr "prefix_rep" "1")])
@@ -19703,7 +19704,7 @@
    (clobber (match_operand:DI 1 "register_operand" "=D"))
    (clobber (reg:CC FLAGS_REG))]
   "TARGET_64BIT"
-  "repnz scasb"
+  "repnz{%;} scasb"
   [(set_attr "type" "str")
    (set_attr "mode" "QI")
    (set_attr "prefix_rep" "1")])
Index: gcc/config/i386/sol2.h
===================================================================
--- gcc/config/i386/sol2.h	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/i386/sol2.h	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -72,7 +72,7 @@
 #define LOCAL_LABEL_PREFIX "."
 
 /* The 32-bit Solaris assembler does not support .quad.  Do not use it.  */
-#ifndef TARGET_BI_ARCH
+#ifndef HAVE_AS_IX86_QUAD
 #undef ASM_QUAD
 #endif
 
Index: gcc/config/i386/sync.md
===================================================================
--- gcc/config/i386/sync.md	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/i386/sync.md	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,5 @@
 ;; GCC machine description for i386 synchronization instructions.
-;; Copyright (C) 2005, 2006, 2007, 2008, 2009
+;; Copyright (C) 2005, 2006, 2007, 2008, 2009, 2010
 ;; Free Software Foundation, Inc.
 ;;
 ;; This file is part of GCC.
@@ -51,7 +51,7 @@
 	(unspec:BLK [(match_dup 0)] UNSPEC_MFENCE))
    (clobber (reg:CC FLAGS_REG))]
   "!(TARGET_64BIT || TARGET_SSE2)"
-  "lock{%;| }or{l}\t{$0, (%%esp)|DWORD PTR [esp], 0}"
+  "lock{%;} or{l}\t{$0, (%%esp)|DWORD PTR [esp], 0}"
   [(set_attr "memory" "unknown")])
 
 ;; ??? It would be possible to use cmpxchg8b on pentium for DImode
@@ -111,7 +111,7 @@
 	  UNSPECV_CMPXCHG))
    (clobber (reg:CC FLAGS_REG))]
   "TARGET_CMPXCHG"
-  "lock{%;| }cmpxchg{<modesuffix>}\t{%3, %1|%1, %3}")
+  "lock{%;} cmpxchg{<modesuffix>}\t{%3, %1|%1, %3}")
 
 (define_insn "sync_double_compare_and_swap<mode>"
   [(set (match_operand:DCASMODE 0 "register_operand" "=A")
@@ -125,7 +125,7 @@
 	  UNSPECV_CMPXCHG))
    (clobber (reg:CC FLAGS_REG))]
   ""
-  "lock{%;| }cmpxchg<doublemodesuffix>b\t%1")
+  "lock{%;} cmpxchg<doublemodesuffix>b\t%1")
 
 ;; Theoretically we'd like to use constraint "r" (any reg) for operand
 ;; 3, but that includes ecx.  If operand 3 and 4 are the same (like when
@@ -148,7 +148,7 @@
 	  UNSPECV_CMPXCHG))
    (clobber (reg:CC FLAGS_REG))]
   "!TARGET_64BIT && TARGET_CMPXCHG8B && flag_pic"
-  "xchg{l}\t%%ebx, %3\;lock{%;| }cmpxchg8b\t%1\;xchg{l}\t%%ebx, %3")
+  "xchg{l}\t%%ebx, %3\;lock{%;} cmpxchg8b\t%1\;xchg{l}\t%%ebx, %3")
 
 (define_expand "sync_compare_and_swap_cc<mode>"
   [(parallel
@@ -213,7 +213,7 @@
 	    [(match_dup 1) (match_dup 2) (match_dup 3)] UNSPECV_CMPXCHG)
 	  (match_dup 2)))]
   "TARGET_CMPXCHG"
-  "lock{%;| }cmpxchg{<modesuffix>}\t{%3, %1|%1, %3}")
+  "lock{%;} cmpxchg{<modesuffix>}\t{%3, %1|%1, %3}")
 
 (define_insn "sync_double_compare_and_swap_cc<mode>"
   [(set (match_operand:DCASMODE 0 "register_operand" "=A")
@@ -232,7 +232,7 @@
 	    UNSPECV_CMPXCHG)
 	  (match_dup 2)))]
   ""
-  "lock{%;| }cmpxchg<doublemodesuffix>b\t%1")
+  "lock{%;} cmpxchg<doublemodesuffix>b\t%1")
 
 ;; See above for the explanation of using the constraint "SD" for
 ;; operand 3.
@@ -253,7 +253,7 @@
 	    UNSPECV_CMPXCHG)
 	  (match_dup 2)))]
   "!TARGET_64BIT && TARGET_CMPXCHG8B && flag_pic"
-  "xchg{l}\t%%ebx, %3\;lock{%;| }cmpxchg8b\t%1\;xchg{l}\t%%ebx, %3")
+  "xchg{l}\t%%ebx, %3\;lock{%;} cmpxchg8b\t%1\;xchg{l}\t%%ebx, %3")
 
 (define_insn "sync_old_add<mode>"
   [(set (match_operand:IMODE 0 "register_operand" "=<modeconstraint>")
@@ -264,7 +264,7 @@
 		    (match_operand:IMODE 2 "register_operand" "0")))
    (clobber (reg:CC FLAGS_REG))]
   "TARGET_XADD"
-  "lock{%;| }xadd{<modesuffix>}\t{%0, %1|%1, %0}")
+  "lock{%;} xadd{<modesuffix>}\t{%0, %1|%1, %0}")
 
 ;; Recall that xchg implicitly sets LOCK#, so adding it again wastes space.
 (define_insn "sync_lock_test_and_set<mode>"
@@ -288,12 +288,12 @@
   if (TARGET_USE_INCDEC)
     {
       if (operands[1] == const1_rtx)
-	return "lock{%;| }inc{<modesuffix>}\t%0";
+	return "lock{%;} inc{<modesuffix>}\t%0";
       if (operands[1] == constm1_rtx)
-	return "lock{%;| }dec{<modesuffix>}\t%0";
+	return "lock{%;} dec{<modesuffix>}\t%0";
     }
 
-  return "lock{%;| }add{<modesuffix>}\t{%1, %0|%0, %1}";
+  return "lock{%;} add{<modesuffix>}\t{%1, %0|%0, %1}";
 })
 
 (define_insn "sync_sub<mode>"
@@ -308,12 +308,12 @@
   if (TARGET_USE_INCDEC)
     {
       if (operands[1] == const1_rtx)
-	return "lock{%;| }dec{<modesuffix>}\t%0";
+	return "lock{%;} dec{<modesuffix>}\t%0";
       if (operands[1] == constm1_rtx)
-	return "lock{%;| }inc{<modesuffix>}\t%0";
+	return "lock{%;} inc{<modesuffix>}\t%0";
     }
 
-  return "lock{%;| }sub{<modesuffix>}\t{%1, %0|%0, %1}";
+  return "lock{%;} sub{<modesuffix>}\t{%1, %0|%0, %1}";
 })
 
 (define_insn "sync_ior<mode>"
@@ -324,7 +324,7 @@
 	  UNSPECV_LOCK))
    (clobber (reg:CC FLAGS_REG))]
   ""
-  "lock{%;| }or{<modesuffix>}\t{%1, %0|%0, %1}")
+  "lock{%;} or{<modesuffix>}\t{%1, %0|%0, %1}")
 
 (define_insn "sync_and<mode>"
   [(set (match_operand:IMODE 0 "memory_operand" "+m")
@@ -334,7 +334,7 @@
 	  UNSPECV_LOCK))
    (clobber (reg:CC FLAGS_REG))]
   ""
-  "lock{%;| }and{<modesuffix>}\t{%1, %0|%0, %1}")
+  "lock{%;} and{<modesuffix>}\t{%1, %0|%0, %1}")
 
 (define_insn "sync_xor<mode>"
   [(set (match_operand:IMODE 0 "memory_operand" "+m")
@@ -344,4 +344,4 @@
 	  UNSPECV_LOCK))
    (clobber (reg:CC FLAGS_REG))]
   ""
-  "lock{%;| }xor{<modesuffix>}\t{%1, %0|%0, %1}")
+  "lock{%;} xor{<modesuffix>}\t{%1, %0|%0, %1}")
Index: gcc/config/i386/i386.c
===================================================================
--- gcc/config/i386/i386.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/i386/i386.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -2358,7 +2358,7 @@
   if (flags && add_nl_p)
     {
       opts[num++][0] = target_other;
-      sprintf (target_other, "(other flags: 0x%x)", isa);
+      sprintf (target_other, "(other flags: 0x%x)", flags);
     }
 
   /* Add -fpmath= option.  */
@@ -11277,10 +11277,8 @@
 	  return;
 
 	case ';':
-#if TARGET_MACHO
-	  fputs (" ; ", file);
-#else
-	  fputc (' ', file);
+#if TARGET_MACHO || !HAVE_AS_IX86_REP_LOCK_PREFIX
+	  fputs (";", file);
 #endif
 	  return;
 
@@ -20618,6 +20616,7 @@
     {
       ix86_builtins_isa[(int) code].isa = mask;
 
+      mask &= ~OPTION_MASK_ISA_64BIT;
       if ((mask & ix86_isa_flags) != 0
 	  || (lang_hooks.builtin_function
 	      == lang_hooks.builtin_function_ext_scope))
Index: gcc/config/sh/sh.c
===================================================================
--- gcc/config/sh/sh.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/sh/sh.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -3884,6 +3884,7 @@
   int si_limit;
   int hi_limit;
   rtx orig = from;
+  rtx last_symoff = NULL_RTX;
 
   /* For HImode: range is 510, add 4 because pc counts from address of
      second instruction after this one, subtract 2 for the jump instruction
@@ -4015,6 +4016,16 @@
 	{
 	  switch (untangle_mova (&num_mova, &mova, from))
 	    {
+	      case 1:
+		if (flag_pic)
+		  {
+		    rtx src = SET_SRC (PATTERN (from));
+		    if (GET_CODE (src) == CONST
+			&& GET_CODE (XEXP (src, 0)) == UNSPEC
+			&& XINT (XEXP (src, 0), 1) == UNSPEC_SYMOFF)
+		      last_symoff = from;
+		  }
+		break;
 	      case 0:	return find_barrier (0, 0, mova);
 	      case 2:
 		{
@@ -4120,6 +4131,12 @@
 	 so we'll make one.  */
       rtx label = gen_label_rtx ();
 
+      /* Don't emit a constant table in the middle of insns for
+	 casesi_worker_2.  This is a bit overkill but is enough
+	 because casesi_worker_2 wouldn't appear so frequently.  */
+      if (last_symoff)
+	from = last_symoff;
+
       /* If we exceeded the range, then we must back up over the last
 	 instruction we looked at.  Otherwise, we just need to undo the
 	 NEXT_INSN at the end of the loop.  */
Index: gcc/config/cris/cris.md
===================================================================
--- gcc/config/cris/cris.md	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/cris/cris.md	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1868,7 +1868,7 @@
    add%u2 %2,%0
    addo.%Z2 %2,%1,%0"
   [(set_attr "slottable" "yes,yes,yes,yes,yes,yes,yes,no,no,no,no,no,no")
-   (set_attr "cc" "*,none,*,none,*,*,none,*,*,*,*,*,none")])
+   (set_attr "cc" "*,none,*,none,*,*,none,*,none,*,*,*,none")])
 
 (define_insn "*addhi3_non_v32"
   [(set (match_operand:HI 0 "register_operand"		"=r,r, r,r,r,r")
Index: gcc/config/rs6000/rs6000.c
===================================================================
--- gcc/config/rs6000/rs6000.c	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/rs6000/rs6000.c	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -759,7 +759,6 @@
 static void emit_frame_save (rtx, rtx, enum machine_mode, unsigned int,
 			     int, HOST_WIDE_INT);
 static rtx gen_frame_mem_offset (enum machine_mode, rtx, int);
-static void rs6000_emit_allocate_stack (HOST_WIDE_INT, int, int);
 static unsigned rs6000_hash_constant (rtx);
 static unsigned toc_hash_function (const void *);
 static int toc_hash_eq (const void *, const void *);
@@ -15548,13 +15547,11 @@
 }
 
 /* Emit the correct code for allocating stack space, as insns.
-   If COPY_R12, make sure a copy of the old frame is left in r12.
-   If COPY_R11, make sure a copy of the old frame is left in r11,
-   in preference to r12 if COPY_R12.
+   If COPY_REG, make sure a copy of the old frame is left there.
    The generated code may use hard register 0 as a temporary.  */
 
 static void
-rs6000_emit_allocate_stack (HOST_WIDE_INT size, int copy_r12, int copy_r11)
+rs6000_emit_allocate_stack (HOST_WIDE_INT size, rtx copy_reg)
 {
   rtx insn;
   rtx stack_reg = gen_rtx_REG (Pmode, STACK_POINTER_REGNUM);
@@ -15604,11 +15601,8 @@
 	warning (0, "stack limit expression is not supported");
     }
 
-  if (copy_r12 || copy_r11)
-    emit_move_insn (copy_r11
-                    ? gen_rtx_REG (Pmode, 11)
-                    : gen_rtx_REG (Pmode, 12),
-                    stack_reg);
+  if (copy_reg)
+    emit_move_insn (copy_reg, stack_reg);
 
   if (size > 32767)
     {
@@ -16180,20 +16174,33 @@
 		       ? (!saving_GPRs_inline
 			  && info->spe_64bit_regs_used == 0)
 		       : (!saving_FPRs_inline || !saving_GPRs_inline));
+      rtx copy_reg = need_r11 ? gen_rtx_REG (Pmode, 11) : NULL;
+
       if (info->total_size < 32767)
 	sp_offset = info->total_size;
+      else if (need_r11)
+	frame_reg_rtx = copy_reg;
+      else if (info->cr_save_p
+	       || info->lr_save_p
+	       || info->first_fp_reg_save < 64
+	       || info->first_gp_reg_save < 32
+	       || info->altivec_size != 0
+	       || info->vrsave_mask != 0
+	       || crtl->calls_eh_return)
+	{
+	  copy_reg = frame_ptr_rtx;
+	  frame_reg_rtx = copy_reg;
+	}
       else
-	frame_reg_rtx = (need_r11
-			 ? gen_rtx_REG (Pmode, 11)
-			 : frame_ptr_rtx);
-      rs6000_emit_allocate_stack (info->total_size,
-				  (frame_reg_rtx != sp_reg_rtx
-				   && (info->cr_save_p
-				       || info->lr_save_p
-				       || info->first_fp_reg_save < 64
-				       || info->first_gp_reg_save < 32
-				       )),
-				  need_r11);
+	{
+	  /* The prologue won't be saving any regs so there is no need
+	     to set up a frame register to access any frame save area.
+	     We also won't be using sp_offset anywhere below, but set
+	     the correct value anyway to protect against future
+	     changes to this function.  */
+	  sp_offset = info->total_size;
+	}
+      rs6000_emit_allocate_stack (info->total_size, copy_reg);
       if (frame_reg_rtx != sp_reg_rtx)
 	rs6000_emit_stack_tie ();
     }
@@ -16627,16 +16634,19 @@
   if (!WORLD_SAVE_P (info) && info->push_p
       && !(DEFAULT_ABI == ABI_V4 || crtl->calls_eh_return))
     {
+      rtx copy_reg = NULL;
+
       if (info->total_size < 32767)
-      sp_offset = info->total_size;
+	sp_offset = info->total_size;
+      else if (info->altivec_size != 0
+	       || info->vrsave_mask != 0)
+	{
+	  copy_reg = frame_ptr_rtx;
+	  frame_reg_rtx = copy_reg;
+	}
       else
-	frame_reg_rtx = frame_ptr_rtx;
-      rs6000_emit_allocate_stack (info->total_size,
-				  (frame_reg_rtx != sp_reg_rtx
-				   && ((info->altivec_size != 0)
-				       || (info->vrsave_mask != 0)
-				       )),
-				  FALSE);
+	sp_offset = info->total_size;
+      rs6000_emit_allocate_stack (info->total_size, copy_reg);
       if (frame_reg_rtx != sp_reg_rtx)
 	rs6000_emit_stack_tie ();
     }
@@ -17152,6 +17162,16 @@
       frame_reg_rtx = sp_reg_rtx;
       if (DEFAULT_ABI == ABI_V4)
 	frame_reg_rtx = gen_rtx_REG (Pmode, 11);
+      /* Prevent reordering memory accesses against stack pointer restore.  */
+      else if (cfun->calls_alloca
+	       || info->total_size > (TARGET_32BIT ? 220 : 288))
+	{
+	  rtx mem1 = gen_rtx_MEM (BLKmode, hard_frame_pointer_rtx);
+	  rtx mem2 = gen_rtx_MEM (BLKmode, sp_reg_rtx);
+	  MEM_NOTRAP_P (mem1) = 1;
+	  MEM_NOTRAP_P (mem2) = 1;
+	  emit_insn (gen_frame_tie (mem1, mem2));
+	}
 
       emit_insn (TARGET_32BIT
 		 ? gen_addsi3 (frame_reg_rtx, hard_frame_pointer_rtx,
@@ -17164,6 +17184,14 @@
 	   && DEFAULT_ABI != ABI_V4
 	   && !crtl->calls_eh_return)
     {
+      /* Prevent reordering memory accesses against stack pointer restore.  */
+      if (cfun->calls_alloca
+	  || info->total_size > (TARGET_32BIT ? 220 : 288))
+	{
+	  rtx mem = gen_rtx_MEM (BLKmode, sp_reg_rtx);
+	  MEM_NOTRAP_P (mem) = 1;
+	  emit_insn (gen_stack_tie (mem));
+	}
       emit_insn (TARGET_32BIT
 		 ? gen_addsi3 (sp_reg_rtx, sp_reg_rtx,
 			       GEN_INT (info->total_size))
Index: gcc/config/rs6000/rs6000.md
===================================================================
--- gcc/config/rs6000/rs6000.md	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ gcc/config/rs6000/rs6000.md	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -14732,7 +14732,16 @@
   ""
   [(set_attr "length" "0")])
 
+; Like stack_tie, but depend on both fp and sp based memory.
+(define_insn "frame_tie"
+  [(set (match_operand:BLK 0 "memory_operand" "+m")
+	(unspec:BLK [(match_dup 0)
+		     (match_operand:BLK 1 "memory_operand" "m")] UNSPEC_TIE))]
+  ""
+  ""
+  [(set_attr "length" "0")])
 
+
 (define_expand "epilogue"
   [(use (const_int 0))]
   "TARGET_SCHED_PROLOG"
Index: libstdc++-v3/Makefile.in
===================================================================
--- libstdc++-v3/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libstdc++-v3/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -36,13 +36,14 @@
 build_triplet = @build@
 host_triplet = @host@
 target_triplet = @target@
-DIST_COMMON = README $(am__configure_deps) $(srcdir)/../config.guess \
-	$(srcdir)/../config.sub $(srcdir)/../install-sh \
-	$(srcdir)/../ltmain.sh $(srcdir)/../missing \
-	$(srcdir)/../mkinstalldirs $(srcdir)/Makefile.am \
-	$(srcdir)/Makefile.in $(srcdir)/config.h.in \
-	$(top_srcdir)/configure $(top_srcdir)/fragment.am \
-	$(top_srcdir)/scripts/testsuite_flags.in ChangeLog
+DIST_COMMON = $(top_srcdir)/fragment.am $(srcdir)/../config.guess \
+	$(srcdir)/../config.sub README ChangeLog $(srcdir)/Makefile.in \
+	$(srcdir)/Makefile.am $(top_srcdir)/configure \
+	$(am__configure_deps) $(srcdir)/config.h.in \
+	$(srcdir)/../mkinstalldirs \
+	$(top_srcdir)/scripts/testsuite_flags.in \
+	$(srcdir)/../ltmain.sh $(srcdir)/../config.guess \
+	$(srcdir)/../config.sub
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../config/enable.m4 \
@@ -72,7 +73,6 @@
 depcomp =
 am__depfiles_maybe =
 SOURCES =
-DIST_SOURCES =
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -88,17 +88,6 @@
 ETAGS = etags
 CTAGS = ctags
 DIST_SUBDIRS = include libsupc++ doc src po testsuite
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ABI_TWEAKS_SRCDIR = @ABI_TWEAKS_SRCDIR@
 ACLOCAL = @ACLOCAL@
 ALLOCATOR_H = @ALLOCATOR_H@
@@ -557,149 +546,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/scripts
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
-	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
-	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
-	        distdir) \
-	      || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-recursive
 all-am: Makefile all-multi config.h
@@ -783,16 +629,14 @@
 
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am all-multi \
 	am--refresh check check-am clean clean-generic clean-libtool \
-	clean-multi clean-recursive ctags ctags-recursive dist \
-	dist-all dist-bzip2 dist-gzip dist-shar dist-tarZ dist-zip \
-	distcheck distclean distclean-generic distclean-hdr \
-	distclean-libtool distclean-multi distclean-recursive \
-	distclean-tags distcleancheck distdir distuninstallcheck dvi \
-	dvi-am html html-am info info-am install install-am \
-	install-data install-data-am install-exec install-exec-am \
-	install-info install-info-am install-man install-multi \
-	install-strip installcheck installcheck-am installdirs \
-	installdirs-am maintainer-clean maintainer-clean-generic \
+	clean-multi clean-recursive ctags ctags-recursive distclean \
+	distclean-generic distclean-hdr distclean-libtool \
+	distclean-multi distclean-recursive distclean-tags dvi dvi-am \
+	html html-am info info-am install install-am install-data \
+	install-data-am install-exec install-exec-am install-info \
+	install-info-am install-man install-multi install-strip \
+	installcheck installcheck-am installdirs installdirs-am \
+	maintainer-clean maintainer-clean-generic \
 	maintainer-clean-multi maintainer-clean-recursive mostlyclean \
 	mostlyclean-generic mostlyclean-libtool mostlyclean-multi \
 	mostlyclean-recursive pdf pdf-am ps ps-am tags tags-recursive \
Index: libstdc++-v3/ChangeLog
===================================================================
--- libstdc++-v3/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libstdc++-v3/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,9 @@
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libstdc++-v3/configure.ac
===================================================================
--- libstdc++-v3/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libstdc++-v3/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -74,7 +74,7 @@
 #  no-dependencies:  turns off auto dependency generation (just for now)
 #  -Wall:  turns on all automake warnings...
 #  -Wno-portability:  ...except this one, since GNU make is now required.
-AM_INIT_AUTOMAKE([1.9.3 no-define foreign no-dependencies -Wall -Wno-portability -Wno-override])
+AM_INIT_AUTOMAKE([1.9.3 no-define foreign no-dependencies no-dist -Wall -Wno-portability -Wno-override])
 AH_TEMPLATE(PACKAGE, [Name of package])
 AH_TEMPLATE(VERSION, [Version number of package])
 
Index: libgfortran/Makefile.in
===================================================================
--- libgfortran/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgfortran/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -40,12 +40,12 @@
 
 # dummy sources for libtool
 @onestep_TRUE@am__append_1 = libgfortran_c.c libgfortran_f.f90
-DIST_COMMON = $(am__configure_deps) $(srcdir)/../config.guess \
-	$(srcdir)/../config.sub $(srcdir)/../depcomp \
-	$(srcdir)/../install-sh $(srcdir)/../ltmain.sh \
-	$(srcdir)/../missing $(srcdir)/../mkinstalldirs \
-	$(srcdir)/Makefile.am $(srcdir)/Makefile.in \
-	$(srcdir)/config.h.in $(top_srcdir)/configure ChangeLog
+DIST_COMMON = $(srcdir)/../config.guess $(srcdir)/../config.sub \
+	ChangeLog $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/config.h.in $(srcdir)/../mkinstalldirs \
+	$(srcdir)/../depcomp $(srcdir)/../ltmain.sh \
+	$(srcdir)/../config.guess $(srcdir)/../config.sub
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \
@@ -78,508 +78,6 @@
 toolexeclibLTLIBRARIES_INSTALL = $(INSTALL)
 LTLIBRARIES = $(myexeclib_LTLIBRARIES) $(toolexeclib_LTLIBRARIES)
 libgfortran_la_LIBADD =
-am__libgfortran_la_SOURCES_DIST = runtime/backtrace.c \
-	runtime/compile_options.c runtime/convert_char.c \
-	runtime/environ.c runtime/error.c runtime/fpu.c runtime/main.c \
-	runtime/memory.c runtime/pause.c runtime/stop.c \
-	runtime/string.c runtime/select.c $(srcdir)/generated/all_l1.c \
-	$(srcdir)/generated/all_l2.c $(srcdir)/generated/all_l4.c \
-	$(srcdir)/generated/all_l8.c $(srcdir)/generated/all_l16.c \
-	$(srcdir)/generated/any_l1.c $(srcdir)/generated/any_l2.c \
-	$(srcdir)/generated/any_l4.c $(srcdir)/generated/any_l8.c \
-	$(srcdir)/generated/any_l16.c $(srcdir)/generated/count_1_l.c \
-	$(srcdir)/generated/count_2_l.c \
-	$(srcdir)/generated/count_4_l.c \
-	$(srcdir)/generated/count_8_l.c \
-	$(srcdir)/generated/count_16_l.c \
-	$(srcdir)/generated/maxloc0_4_i1.c \
-	$(srcdir)/generated/maxloc0_8_i1.c \
-	$(srcdir)/generated/maxloc0_16_i1.c \
-	$(srcdir)/generated/maxloc0_4_i2.c \
-	$(srcdir)/generated/maxloc0_8_i2.c \
-	$(srcdir)/generated/maxloc0_16_i2.c \
-	$(srcdir)/generated/maxloc0_4_i4.c \
-	$(srcdir)/generated/maxloc0_8_i4.c \
-	$(srcdir)/generated/maxloc0_16_i4.c \
-	$(srcdir)/generated/maxloc0_4_i8.c \
-	$(srcdir)/generated/maxloc0_8_i8.c \
-	$(srcdir)/generated/maxloc0_16_i8.c \
-	$(srcdir)/generated/maxloc0_4_i16.c \
-	$(srcdir)/generated/maxloc0_8_i16.c \
-	$(srcdir)/generated/maxloc0_16_i16.c \
-	$(srcdir)/generated/maxloc0_4_r4.c \
-	$(srcdir)/generated/maxloc0_8_r4.c \
-	$(srcdir)/generated/maxloc0_16_r4.c \
-	$(srcdir)/generated/maxloc0_4_r8.c \
-	$(srcdir)/generated/maxloc0_8_r8.c \
-	$(srcdir)/generated/maxloc0_16_r8.c \
-	$(srcdir)/generated/maxloc0_4_r10.c \
-	$(srcdir)/generated/maxloc0_8_r10.c \
-	$(srcdir)/generated/maxloc0_16_r10.c \
-	$(srcdir)/generated/maxloc0_4_r16.c \
-	$(srcdir)/generated/maxloc0_8_r16.c \
-	$(srcdir)/generated/maxloc0_16_r16.c \
-	$(srcdir)/generated/maxloc1_4_i1.c \
-	$(srcdir)/generated/maxloc1_8_i1.c \
-	$(srcdir)/generated/maxloc1_16_i1.c \
-	$(srcdir)/generated/maxloc1_4_i2.c \
-	$(srcdir)/generated/maxloc1_8_i2.c \
-	$(srcdir)/generated/maxloc1_16_i2.c \
-	$(srcdir)/generated/maxloc1_4_i4.c \
-	$(srcdir)/generated/maxloc1_8_i4.c \
-	$(srcdir)/generated/maxloc1_16_i4.c \
-	$(srcdir)/generated/maxloc1_4_i8.c \
-	$(srcdir)/generated/maxloc1_8_i8.c \
-	$(srcdir)/generated/maxloc1_16_i8.c \
-	$(srcdir)/generated/maxloc1_4_i16.c \
-	$(srcdir)/generated/maxloc1_8_i16.c \
-	$(srcdir)/generated/maxloc1_16_i16.c \
-	$(srcdir)/generated/maxloc1_4_r4.c \
-	$(srcdir)/generated/maxloc1_8_r4.c \
-	$(srcdir)/generated/maxloc1_16_r4.c \
-	$(srcdir)/generated/maxloc1_4_r8.c \
-	$(srcdir)/generated/maxloc1_8_r8.c \
-	$(srcdir)/generated/maxloc1_16_r8.c \
-	$(srcdir)/generated/maxloc1_4_r10.c \
-	$(srcdir)/generated/maxloc1_8_r10.c \
-	$(srcdir)/generated/maxloc1_16_r10.c \
-	$(srcdir)/generated/maxloc1_4_r16.c \
-	$(srcdir)/generated/maxloc1_8_r16.c \
-	$(srcdir)/generated/maxloc1_16_r16.c \
-	$(srcdir)/generated/maxval_i1.c \
-	$(srcdir)/generated/maxval_i2.c \
-	$(srcdir)/generated/maxval_i4.c \
-	$(srcdir)/generated/maxval_i8.c \
-	$(srcdir)/generated/maxval_i16.c \
-	$(srcdir)/generated/maxval_r4.c \
-	$(srcdir)/generated/maxval_r8.c \
-	$(srcdir)/generated/maxval_r10.c \
-	$(srcdir)/generated/maxval_r16.c \
-	$(srcdir)/generated/minloc0_4_i1.c \
-	$(srcdir)/generated/minloc0_8_i1.c \
-	$(srcdir)/generated/minloc0_16_i1.c \
-	$(srcdir)/generated/minloc0_4_i2.c \
-	$(srcdir)/generated/minloc0_8_i2.c \
-	$(srcdir)/generated/minloc0_16_i2.c \
-	$(srcdir)/generated/minloc0_4_i4.c \
-	$(srcdir)/generated/minloc0_8_i4.c \
-	$(srcdir)/generated/minloc0_16_i4.c \
-	$(srcdir)/generated/minloc0_4_i8.c \
-	$(srcdir)/generated/minloc0_8_i8.c \
-	$(srcdir)/generated/minloc0_16_i8.c \
-	$(srcdir)/generated/minloc0_4_i16.c \
-	$(srcdir)/generated/minloc0_8_i16.c \
-	$(srcdir)/generated/minloc0_16_i16.c \
-	$(srcdir)/generated/minloc0_4_r4.c \
-	$(srcdir)/generated/minloc0_8_r4.c \
-	$(srcdir)/generated/minloc0_16_r4.c \
-	$(srcdir)/generated/minloc0_4_r8.c \
-	$(srcdir)/generated/minloc0_8_r8.c \
-	$(srcdir)/generated/minloc0_16_r8.c \
-	$(srcdir)/generated/minloc0_4_r10.c \
-	$(srcdir)/generated/minloc0_8_r10.c \
-	$(srcdir)/generated/minloc0_16_r10.c \
-	$(srcdir)/generated/minloc0_4_r16.c \
-	$(srcdir)/generated/minloc0_8_r16.c \
-	$(srcdir)/generated/minloc0_16_r16.c \
-	$(srcdir)/generated/minloc1_4_i1.c \
-	$(srcdir)/generated/minloc1_8_i1.c \
-	$(srcdir)/generated/minloc1_16_i1.c \
-	$(srcdir)/generated/minloc1_4_i2.c \
-	$(srcdir)/generated/minloc1_8_i2.c \
-	$(srcdir)/generated/minloc1_16_i2.c \
-	$(srcdir)/generated/minloc1_4_i4.c \
-	$(srcdir)/generated/minloc1_8_i4.c \
-	$(srcdir)/generated/minloc1_16_i4.c \
-	$(srcdir)/generated/minloc1_4_i8.c \
-	$(srcdir)/generated/minloc1_8_i8.c \
-	$(srcdir)/generated/minloc1_16_i8.c \
-	$(srcdir)/generated/minloc1_4_i16.c \
-	$(srcdir)/generated/minloc1_8_i16.c \
-	$(srcdir)/generated/minloc1_16_i16.c \
-	$(srcdir)/generated/minloc1_4_r4.c \
-	$(srcdir)/generated/minloc1_8_r4.c \
-	$(srcdir)/generated/minloc1_16_r4.c \
-	$(srcdir)/generated/minloc1_4_r8.c \
-	$(srcdir)/generated/minloc1_8_r8.c \
-	$(srcdir)/generated/minloc1_16_r8.c \
-	$(srcdir)/generated/minloc1_4_r10.c \
-	$(srcdir)/generated/minloc1_8_r10.c \
-	$(srcdir)/generated/minloc1_16_r10.c \
-	$(srcdir)/generated/minloc1_4_r16.c \
-	$(srcdir)/generated/minloc1_8_r16.c \
-	$(srcdir)/generated/minloc1_16_r16.c \
-	$(srcdir)/generated/minval_i1.c \
-	$(srcdir)/generated/minval_i2.c \
-	$(srcdir)/generated/minval_i4.c \
-	$(srcdir)/generated/minval_i8.c \
-	$(srcdir)/generated/minval_i16.c \
-	$(srcdir)/generated/minval_r4.c \
-	$(srcdir)/generated/minval_r8.c \
-	$(srcdir)/generated/minval_r10.c \
-	$(srcdir)/generated/minval_r16.c \
-	$(srcdir)/generated/product_i1.c \
-	$(srcdir)/generated/product_i2.c \
-	$(srcdir)/generated/product_i4.c \
-	$(srcdir)/generated/product_i8.c \
-	$(srcdir)/generated/product_i16.c \
-	$(srcdir)/generated/product_r4.c \
-	$(srcdir)/generated/product_r8.c \
-	$(srcdir)/generated/product_r10.c \
-	$(srcdir)/generated/product_r16.c \
-	$(srcdir)/generated/product_c4.c \
-	$(srcdir)/generated/product_c8.c \
-	$(srcdir)/generated/product_c10.c \
-	$(srcdir)/generated/product_c16.c $(srcdir)/generated/sum_i1.c \
-	$(srcdir)/generated/sum_i2.c $(srcdir)/generated/sum_i4.c \
-	$(srcdir)/generated/sum_i8.c $(srcdir)/generated/sum_i16.c \
-	$(srcdir)/generated/sum_r4.c $(srcdir)/generated/sum_r8.c \
-	$(srcdir)/generated/sum_r10.c $(srcdir)/generated/sum_r16.c \
-	$(srcdir)/generated/sum_c4.c $(srcdir)/generated/sum_c8.c \
-	$(srcdir)/generated/sum_c10.c $(srcdir)/generated/sum_c16.c \
-	$(srcdir)/generated/matmul_i1.c \
-	$(srcdir)/generated/matmul_i2.c \
-	$(srcdir)/generated/matmul_i4.c \
-	$(srcdir)/generated/matmul_i8.c \
-	$(srcdir)/generated/matmul_i16.c \
-	$(srcdir)/generated/matmul_r4.c \
-	$(srcdir)/generated/matmul_r8.c \
-	$(srcdir)/generated/matmul_r10.c \
-	$(srcdir)/generated/matmul_r16.c \
-	$(srcdir)/generated/matmul_c4.c \
-	$(srcdir)/generated/matmul_c8.c \
-	$(srcdir)/generated/matmul_c10.c \
-	$(srcdir)/generated/matmul_c16.c \
-	$(srcdir)/generated/matmul_l4.c \
-	$(srcdir)/generated/matmul_l8.c \
-	$(srcdir)/generated/matmul_l16.c \
-	$(srcdir)/generated/transpose_i4.c \
-	$(srcdir)/generated/transpose_i8.c \
-	$(srcdir)/generated/transpose_i16.c \
-	$(srcdir)/generated/transpose_r4.c \
-	$(srcdir)/generated/transpose_r8.c \
-	$(srcdir)/generated/transpose_r10.c \
-	$(srcdir)/generated/transpose_r16.c \
-	$(srcdir)/generated/transpose_c4.c \
-	$(srcdir)/generated/transpose_c8.c \
-	$(srcdir)/generated/transpose_c10.c \
-	$(srcdir)/generated/transpose_c16.c \
-	$(srcdir)/generated/shape_i4.c $(srcdir)/generated/shape_i8.c \
-	$(srcdir)/generated/shape_i16.c \
-	$(srcdir)/generated/eoshift1_4.c \
-	$(srcdir)/generated/eoshift1_8.c \
-	$(srcdir)/generated/eoshift1_16.c \
-	$(srcdir)/generated/eoshift3_4.c \
-	$(srcdir)/generated/eoshift3_8.c \
-	$(srcdir)/generated/eoshift3_16.c \
-	$(srcdir)/generated/cshift1_4.c \
-	$(srcdir)/generated/cshift1_8.c \
-	$(srcdir)/generated/cshift1_16.c \
-	$(srcdir)/generated/reshape_i4.c \
-	$(srcdir)/generated/reshape_i8.c \
-	$(srcdir)/generated/reshape_i16.c \
-	$(srcdir)/generated/reshape_r4.c \
-	$(srcdir)/generated/reshape_r8.c \
-	$(srcdir)/generated/reshape_r10.c \
-	$(srcdir)/generated/reshape_r16.c \
-	$(srcdir)/generated/reshape_c4.c \
-	$(srcdir)/generated/reshape_c8.c \
-	$(srcdir)/generated/reshape_c10.c \
-	$(srcdir)/generated/reshape_c16.c \
-	$(srcdir)/generated/in_pack_i1.c \
-	$(srcdir)/generated/in_pack_i2.c \
-	$(srcdir)/generated/in_pack_i4.c \
-	$(srcdir)/generated/in_pack_i8.c \
-	$(srcdir)/generated/in_pack_i16.c \
-	$(srcdir)/generated/in_pack_r4.c \
-	$(srcdir)/generated/in_pack_r8.c \
-	$(srcdir)/generated/in_pack_r10.c \
-	$(srcdir)/generated/in_pack_r16.c \
-	$(srcdir)/generated/in_pack_c4.c \
-	$(srcdir)/generated/in_pack_c8.c \
-	$(srcdir)/generated/in_pack_c10.c \
-	$(srcdir)/generated/in_pack_c16.c \
-	$(srcdir)/generated/in_unpack_i1.c \
-	$(srcdir)/generated/in_unpack_i2.c \
-	$(srcdir)/generated/in_unpack_i4.c \
-	$(srcdir)/generated/in_unpack_i8.c \
-	$(srcdir)/generated/in_unpack_i16.c \
-	$(srcdir)/generated/in_unpack_r4.c \
-	$(srcdir)/generated/in_unpack_r8.c \
-	$(srcdir)/generated/in_unpack_r10.c \
-	$(srcdir)/generated/in_unpack_r16.c \
-	$(srcdir)/generated/in_unpack_c4.c \
-	$(srcdir)/generated/in_unpack_c8.c \
-	$(srcdir)/generated/in_unpack_c10.c \
-	$(srcdir)/generated/in_unpack_c16.c \
-	$(srcdir)/generated/exponent_r4.c \
-	$(srcdir)/generated/exponent_r8.c \
-	$(srcdir)/generated/exponent_r10.c \
-	$(srcdir)/generated/exponent_r16.c \
-	$(srcdir)/generated/fraction_r4.c \
-	$(srcdir)/generated/fraction_r8.c \
-	$(srcdir)/generated/fraction_r10.c \
-	$(srcdir)/generated/fraction_r16.c \
-	$(srcdir)/generated/nearest_r4.c \
-	$(srcdir)/generated/nearest_r8.c \
-	$(srcdir)/generated/nearest_r10.c \
-	$(srcdir)/generated/nearest_r16.c \
-	$(srcdir)/generated/set_exponent_r4.c \
-	$(srcdir)/generated/set_exponent_r8.c \
-	$(srcdir)/generated/set_exponent_r10.c \
-	$(srcdir)/generated/set_exponent_r16.c \
-	$(srcdir)/generated/pow_i4_i4.c \
-	$(srcdir)/generated/pow_i8_i4.c \
-	$(srcdir)/generated/pow_i16_i4.c \
-	$(srcdir)/generated/pow_c4_i4.c \
-	$(srcdir)/generated/pow_c8_i4.c \
-	$(srcdir)/generated/pow_c10_i4.c \
-	$(srcdir)/generated/pow_c16_i4.c \
-	$(srcdir)/generated/pow_i4_i8.c \
-	$(srcdir)/generated/pow_i8_i8.c \
-	$(srcdir)/generated/pow_i16_i8.c \
-	$(srcdir)/generated/pow_r4_i8.c \
-	$(srcdir)/generated/pow_r8_i8.c \
-	$(srcdir)/generated/pow_r10_i8.c \
-	$(srcdir)/generated/pow_r16_i8.c \
-	$(srcdir)/generated/pow_c4_i8.c \
-	$(srcdir)/generated/pow_c8_i8.c \
-	$(srcdir)/generated/pow_c10_i8.c \
-	$(srcdir)/generated/pow_c16_i8.c \
-	$(srcdir)/generated/pow_i4_i16.c \
-	$(srcdir)/generated/pow_i8_i16.c \
-	$(srcdir)/generated/pow_i16_i16.c \
-	$(srcdir)/generated/pow_r4_i16.c \
-	$(srcdir)/generated/pow_r8_i16.c \
-	$(srcdir)/generated/pow_r10_i16.c \
-	$(srcdir)/generated/pow_r16_i16.c \
-	$(srcdir)/generated/pow_c4_i16.c \
-	$(srcdir)/generated/pow_c8_i16.c \
-	$(srcdir)/generated/pow_c10_i16.c \
-	$(srcdir)/generated/pow_c16_i16.c \
-	$(srcdir)/generated/rrspacing_r4.c \
-	$(srcdir)/generated/rrspacing_r8.c \
-	$(srcdir)/generated/rrspacing_r10.c \
-	$(srcdir)/generated/rrspacing_r16.c \
-	$(srcdir)/generated/spacing_r4.c \
-	$(srcdir)/generated/spacing_r8.c \
-	$(srcdir)/generated/spacing_r10.c \
-	$(srcdir)/generated/spacing_r16.c \
-	$(srcdir)/generated/pack_i1.c $(srcdir)/generated/pack_i2.c \
-	$(srcdir)/generated/pack_i4.c $(srcdir)/generated/pack_i8.c \
-	$(srcdir)/generated/pack_i16.c $(srcdir)/generated/pack_r4.c \
-	$(srcdir)/generated/pack_r8.c $(srcdir)/generated/pack_r10.c \
-	$(srcdir)/generated/pack_r16.c $(srcdir)/generated/pack_c4.c \
-	$(srcdir)/generated/pack_c8.c $(srcdir)/generated/pack_c10.c \
-	$(srcdir)/generated/pack_c16.c $(srcdir)/generated/unpack_i1.c \
-	$(srcdir)/generated/unpack_i2.c \
-	$(srcdir)/generated/unpack_i4.c \
-	$(srcdir)/generated/unpack_i8.c \
-	$(srcdir)/generated/unpack_i16.c \
-	$(srcdir)/generated/unpack_r4.c \
-	$(srcdir)/generated/unpack_r8.c \
-	$(srcdir)/generated/unpack_r10.c \
-	$(srcdir)/generated/unpack_r16.c \
-	$(srcdir)/generated/unpack_c4.c \
-	$(srcdir)/generated/unpack_c8.c \
-	$(srcdir)/generated/unpack_c10.c \
-	$(srcdir)/generated/unpack_c16.c \
-	$(srcdir)/generated/spread_i1.c \
-	$(srcdir)/generated/spread_i2.c \
-	$(srcdir)/generated/spread_i4.c \
-	$(srcdir)/generated/spread_i8.c \
-	$(srcdir)/generated/spread_i16.c \
-	$(srcdir)/generated/spread_r4.c \
-	$(srcdir)/generated/spread_r8.c \
-	$(srcdir)/generated/spread_r10.c \
-	$(srcdir)/generated/spread_r16.c \
-	$(srcdir)/generated/spread_c4.c \
-	$(srcdir)/generated/spread_c8.c \
-	$(srcdir)/generated/spread_c10.c \
-	$(srcdir)/generated/spread_c16.c selected_int_kind.inc \
-	selected_real_kind.inc kinds.h \
-	$(srcdir)/generated/cshift0_i1.c \
-	$(srcdir)/generated/cshift0_i2.c \
-	$(srcdir)/generated/cshift0_i4.c \
-	$(srcdir)/generated/cshift0_i8.c \
-	$(srcdir)/generated/cshift0_i16.c \
-	$(srcdir)/generated/cshift0_r4.c \
-	$(srcdir)/generated/cshift0_r8.c \
-	$(srcdir)/generated/cshift0_r10.c \
-	$(srcdir)/generated/cshift0_r16.c \
-	$(srcdir)/generated/cshift0_c4.c \
-	$(srcdir)/generated/cshift0_c8.c \
-	$(srcdir)/generated/cshift0_c10.c \
-	$(srcdir)/generated/cshift0_c16.c kinds.inc c99_protos.inc \
-	fpu-target.h io/close.c io/file_pos.c io/format.c io/inquire.c \
-	io/intrinsics.c io/list_read.c io/lock.c io/open.c io/read.c \
-	io/size_from_kind.c io/transfer.c io/unit.c io/unix.c \
-	io/write.c io/fbuf.c intrinsics/associated.c \
-	intrinsics/abort.c intrinsics/access.c intrinsics/args.c \
-	intrinsics/bit_intrinsics.c intrinsics/c99_functions.c \
-	intrinsics/chdir.c intrinsics/chmod.c intrinsics/clock.c \
-	intrinsics/cpu_time.c intrinsics/cshift0.c intrinsics/ctime.c \
-	intrinsics/date_and_time.c intrinsics/dtime.c intrinsics/env.c \
-	intrinsics/eoshift0.c intrinsics/eoshift2.c \
-	intrinsics/erfc_scaled.c intrinsics/etime.c intrinsics/exit.c \
-	intrinsics/fnum.c intrinsics/gerror.c intrinsics/getcwd.c \
-	intrinsics/getlog.c intrinsics/getXid.c intrinsics/hostnm.c \
-	intrinsics/ierrno.c intrinsics/ishftc.c \
-	intrinsics/iso_c_generated_procs.c intrinsics/iso_c_binding.c \
-	intrinsics/kill.c intrinsics/link.c intrinsics/malloc.c \
-	intrinsics/mvbits.c intrinsics/move_alloc.c \
-	intrinsics/pack_generic.c intrinsics/perror.c \
-	intrinsics/selected_char_kind.c intrinsics/signal.c \
-	intrinsics/size.c intrinsics/sleep.c \
-	intrinsics/spread_generic.c intrinsics/string_intrinsics.c \
-	intrinsics/system.c intrinsics/rand.c intrinsics/random.c \
-	intrinsics/rename.c intrinsics/reshape_generic.c \
-	intrinsics/reshape_packed.c intrinsics/selected_int_kind.f90 \
-	intrinsics/selected_real_kind.f90 intrinsics/stat.c \
-	intrinsics/symlnk.c intrinsics/system_clock.c \
-	intrinsics/time.c intrinsics/transpose_generic.c \
-	intrinsics/umask.c intrinsics/unlink.c \
-	intrinsics/unpack_generic.c runtime/in_pack_generic.c \
-	runtime/in_unpack_generic.c io/io.h \
-	$(srcdir)/generated/_abs_c4.F90 \
-	$(srcdir)/generated/_abs_c8.F90 \
-	$(srcdir)/generated/_abs_c10.F90 \
-	$(srcdir)/generated/_abs_c16.F90 \
-	$(srcdir)/generated/_abs_i4.F90 \
-	$(srcdir)/generated/_abs_i8.F90 \
-	$(srcdir)/generated/_abs_i16.F90 \
-	$(srcdir)/generated/_abs_r4.F90 \
-	$(srcdir)/generated/_abs_r8.F90 \
-	$(srcdir)/generated/_abs_r10.F90 \
-	$(srcdir)/generated/_abs_r16.F90 \
-	$(srcdir)/generated/_aimag_c4.F90 \
-	$(srcdir)/generated/_aimag_c8.F90 \
-	$(srcdir)/generated/_aimag_c10.F90 \
-	$(srcdir)/generated/_aimag_c16.F90 \
-	$(srcdir)/generated/_exp_r4.F90 \
-	$(srcdir)/generated/_exp_r8.F90 \
-	$(srcdir)/generated/_exp_r10.F90 \
-	$(srcdir)/generated/_exp_r16.F90 \
-	$(srcdir)/generated/_exp_c4.F90 \
-	$(srcdir)/generated/_exp_c8.F90 \
-	$(srcdir)/generated/_exp_c10.F90 \
-	$(srcdir)/generated/_exp_c16.F90 \
-	$(srcdir)/generated/_log_r4.F90 \
-	$(srcdir)/generated/_log_r8.F90 \
-	$(srcdir)/generated/_log_r10.F90 \
-	$(srcdir)/generated/_log_r16.F90 \
-	$(srcdir)/generated/_log_c4.F90 \
-	$(srcdir)/generated/_log_c8.F90 \
-	$(srcdir)/generated/_log_c10.F90 \
-	$(srcdir)/generated/_log_c16.F90 \
-	$(srcdir)/generated/_log10_r4.F90 \
-	$(srcdir)/generated/_log10_r8.F90 \
-	$(srcdir)/generated/_log10_r10.F90 \
-	$(srcdir)/generated/_log10_r16.F90 \
-	$(srcdir)/generated/_sqrt_r4.F90 \
-	$(srcdir)/generated/_sqrt_r8.F90 \
-	$(srcdir)/generated/_sqrt_r10.F90 \
-	$(srcdir)/generated/_sqrt_r16.F90 \
-	$(srcdir)/generated/_sqrt_c4.F90 \
-	$(srcdir)/generated/_sqrt_c8.F90 \
-	$(srcdir)/generated/_sqrt_c10.F90 \
-	$(srcdir)/generated/_sqrt_c16.F90 \
-	$(srcdir)/generated/_asin_r4.F90 \
-	$(srcdir)/generated/_asin_r8.F90 \
-	$(srcdir)/generated/_asin_r10.F90 \
-	$(srcdir)/generated/_asin_r16.F90 \
-	$(srcdir)/generated/_asinh_r4.F90 \
-	$(srcdir)/generated/_asinh_r8.F90 \
-	$(srcdir)/generated/_asinh_r10.F90 \
-	$(srcdir)/generated/_asinh_r16.F90 \
-	$(srcdir)/generated/_acos_r4.F90 \
-	$(srcdir)/generated/_acos_r8.F90 \
-	$(srcdir)/generated/_acos_r10.F90 \
-	$(srcdir)/generated/_acos_r16.F90 \
-	$(srcdir)/generated/_acosh_r4.F90 \
-	$(srcdir)/generated/_acosh_r8.F90 \
-	$(srcdir)/generated/_acosh_r10.F90 \
-	$(srcdir)/generated/_acosh_r16.F90 \
-	$(srcdir)/generated/_atan_r4.F90 \
-	$(srcdir)/generated/_atan_r8.F90 \
-	$(srcdir)/generated/_atan_r10.F90 \
-	$(srcdir)/generated/_atan_r16.F90 \
-	$(srcdir)/generated/_atanh_r4.F90 \
-	$(srcdir)/generated/_atanh_r8.F90 \
-	$(srcdir)/generated/_atanh_r10.F90 \
-	$(srcdir)/generated/_atanh_r16.F90 \
-	$(srcdir)/generated/_sin_r4.F90 \
-	$(srcdir)/generated/_sin_r8.F90 \
-	$(srcdir)/generated/_sin_r10.F90 \
-	$(srcdir)/generated/_sin_r16.F90 \
-	$(srcdir)/generated/_sin_c4.F90 \
-	$(srcdir)/generated/_sin_c8.F90 \
-	$(srcdir)/generated/_sin_c10.F90 \
-	$(srcdir)/generated/_sin_c16.F90 \
-	$(srcdir)/generated/_cos_r4.F90 \
-	$(srcdir)/generated/_cos_r8.F90 \
-	$(srcdir)/generated/_cos_r10.F90 \
-	$(srcdir)/generated/_cos_r16.F90 \
-	$(srcdir)/generated/_cos_c4.F90 \
-	$(srcdir)/generated/_cos_c8.F90 \
-	$(srcdir)/generated/_cos_c10.F90 \
-	$(srcdir)/generated/_cos_c16.F90 \
-	$(srcdir)/generated/_tan_r4.F90 \
-	$(srcdir)/generated/_tan_r8.F90 \
-	$(srcdir)/generated/_tan_r10.F90 \
-	$(srcdir)/generated/_tan_r16.F90 \
-	$(srcdir)/generated/_sinh_r4.F90 \
-	$(srcdir)/generated/_sinh_r8.F90 \
-	$(srcdir)/generated/_sinh_r10.F90 \
-	$(srcdir)/generated/_sinh_r16.F90 \
-	$(srcdir)/generated/_cosh_r4.F90 \
-	$(srcdir)/generated/_cosh_r8.F90 \
-	$(srcdir)/generated/_cosh_r10.F90 \
-	$(srcdir)/generated/_cosh_r16.F90 \
-	$(srcdir)/generated/_tanh_r4.F90 \
-	$(srcdir)/generated/_tanh_r8.F90 \
-	$(srcdir)/generated/_tanh_r10.F90 \
-	$(srcdir)/generated/_tanh_r16.F90 \
-	$(srcdir)/generated/_conjg_c4.F90 \
-	$(srcdir)/generated/_conjg_c8.F90 \
-	$(srcdir)/generated/_conjg_c10.F90 \
-	$(srcdir)/generated/_conjg_c16.F90 \
-	$(srcdir)/generated/_aint_r4.F90 \
-	$(srcdir)/generated/_aint_r8.F90 \
-	$(srcdir)/generated/_aint_r10.F90 \
-	$(srcdir)/generated/_aint_r16.F90 \
-	$(srcdir)/generated/_anint_r4.F90 \
-	$(srcdir)/generated/_anint_r8.F90 \
-	$(srcdir)/generated/_anint_r10.F90 \
-	$(srcdir)/generated/_anint_r16.F90 \
-	$(srcdir)/generated/_sign_i4.F90 \
-	$(srcdir)/generated/_sign_i8.F90 \
-	$(srcdir)/generated/_sign_i16.F90 \
-	$(srcdir)/generated/_sign_r4.F90 \
-	$(srcdir)/generated/_sign_r8.F90 \
-	$(srcdir)/generated/_sign_r10.F90 \
-	$(srcdir)/generated/_sign_r16.F90 \
-	$(srcdir)/generated/_dim_i4.F90 \
-	$(srcdir)/generated/_dim_i8.F90 \
-	$(srcdir)/generated/_dim_i16.F90 \
-	$(srcdir)/generated/_dim_r4.F90 \
-	$(srcdir)/generated/_dim_r8.F90 \
-	$(srcdir)/generated/_dim_r10.F90 \
-	$(srcdir)/generated/_dim_r16.F90 \
-	$(srcdir)/generated/_atan2_r4.F90 \
-	$(srcdir)/generated/_atan2_r8.F90 \
-	$(srcdir)/generated/_atan2_r10.F90 \
-	$(srcdir)/generated/_atan2_r16.F90 \
-	$(srcdir)/generated/_mod_i4.F90 \
-	$(srcdir)/generated/_mod_i8.F90 \
-	$(srcdir)/generated/_mod_i16.F90 \
-	$(srcdir)/generated/_mod_r4.F90 \
-	$(srcdir)/generated/_mod_r8.F90 \
-	$(srcdir)/generated/_mod_r10.F90 \
-	$(srcdir)/generated/_mod_r16.F90 \
-	$(srcdir)/generated/misc_specifics.F90 intrinsics/dprod_r8.f90 \
-	intrinsics/f2c_specifics.F90 libgfortran_c.c $(filter-out \
-	%.c,$(prereq_SRC))
 am__objects_1 = backtrace.lo compile_options.lo convert_char.lo \
 	environ.lo error.lo fpu.lo main.lo memory.lo pause.lo stop.lo \
 	string.lo select.lo
@@ -788,8 +286,6 @@
 FCCOMPILE = $(FC) $(AM_FCFLAGS) $(FCFLAGS)
 LTFCCOMPILE = $(LIBTOOL) --mode=compile $(FC) $(AM_FCFLAGS) $(FCFLAGS)
 SOURCES = $(libgfortran_la_SOURCES) $(libgfortranbegin_la_SOURCES)
-DIST_SOURCES = $(am__libgfortran_la_SOURCES_DIST) \
-	$(libgfortranbegin_la_SOURCES)
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -798,17 +294,6 @@
 MULTICLEAN = true
 ETAGS = etags
 CTAGS = ctags
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -5798,134 +5283,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/m4
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: $(BUILT_SOURCES)
 	$(MAKE) $(AM_MAKEFLAGS) check-am
@@ -6019,14 +5376,12 @@
 .PHONY: CTAGS GTAGS all all-am all-multi am--refresh check check-am \
 	clean clean-generic clean-libtool clean-multi \
 	clean-myexeclibLTLIBRARIES clean-toolexeclibLTLIBRARIES ctags \
-	dist dist-all dist-bzip2 dist-gzip dist-shar dist-tarZ \
-	dist-zip distcheck distclean distclean-compile \
-	distclean-generic distclean-hdr distclean-libtool \
-	distclean-multi distclean-tags distcleancheck distdir \
-	distuninstallcheck dvi dvi-am html html-am info info-am \
-	install install-am install-data install-data-am install-exec \
-	install-exec-am install-info install-info-am install-man \
-	install-multi install-myexeclibLTLIBRARIES install-strip \
+	distclean distclean-compile distclean-generic distclean-hdr \
+	distclean-libtool distclean-multi distclean-tags dvi dvi-am \
+	html html-am info info-am install install-am install-data \
+	install-data-am install-exec install-exec-am install-info \
+	install-info-am install-man install-multi \
+	install-myexeclibLTLIBRARIES install-strip \
 	install-toolexeclibLTLIBRARIES installcheck installcheck-am \
 	installdirs maintainer-clean maintainer-clean-generic \
 	maintainer-clean-multi mostlyclean mostlyclean-compile \
Index: libgfortran/ChangeLog
===================================================================
--- libgfortran/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgfortran/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,9 @@
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libgfortran/configure.ac
===================================================================
--- libgfortran/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libgfortran/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -62,7 +62,7 @@
 #            file in the top srcdir, etc, etc), so stop complaining.
 #  -Wall:  turns on all automake warnings...
 #  -Wno-portability:  ...except this one, since GNU make is required.
-AM_INIT_AUTOMAKE([1.9.6 no-define foreign -Wall -Wno-portability])
+AM_INIT_AUTOMAKE([1.9.6 no-define foreign no-dist -Wall -Wno-portability])
 
 AM_MAINTAINER_MODE
 AM_ENABLE_MULTILIB(, ..)
Index: libmudflap/Makefile.in
===================================================================
--- libmudflap/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libmudflap/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -38,13 +38,14 @@
 build_triplet = @build@
 host_triplet = @host@
 target_triplet = @target@
-DIST_COMMON = $(am__configure_deps) $(nobase_libsubinclude_HEADERS) \
-	$(srcdir)/../compile $(srcdir)/../config.guess \
-	$(srcdir)/../config.sub $(srcdir)/../depcomp \
-	$(srcdir)/../install-sh $(srcdir)/../ltmain.sh \
-	$(srcdir)/../missing $(srcdir)/../mkinstalldirs \
-	$(srcdir)/Makefile.am $(srcdir)/Makefile.in \
-	$(srcdir)/config.h.in $(top_srcdir)/configure ChangeLog
+DIST_COMMON = $(srcdir)/../config.guess $(srcdir)/../config.sub \
+	ChangeLog $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/config.h.in $(srcdir)/../mkinstalldirs \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../depcomp \
+	$(srcdir)/../ltmain.sh $(srcdir)/../config.guess \
+	$(srcdir)/../config.sub $(nobase_libsubinclude_HEADERS)
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../config/acx.m4 \
@@ -95,7 +96,6 @@
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(libmudflap_la_SOURCES) $(libmudflapth_la_SOURCES)
-DIST_SOURCES = $(libmudflap_la_SOURCES) $(libmudflapth_la_SOURCES)
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -113,17 +113,6 @@
 ETAGS = etags
 CTAGS = ctags
 DIST_SUBDIRS = $(SUBDIRS)
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -662,149 +651,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/testsuite
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
-	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
-	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
-	        distdir) \
-	      || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-recursive
 all-am: Makefile $(LTLIBRARIES) all-multi $(HEADERS) config.h
@@ -897,17 +743,14 @@
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am all-multi \
 	am--refresh check check-am clean clean-generic clean-libtool \
 	clean-multi clean-recursive clean-toolexeclibLTLIBRARIES ctags \
-	ctags-recursive dist dist-all dist-bzip2 dist-gzip dist-shar \
-	dist-tarZ dist-zip distcheck distclean distclean-compile \
-	distclean-generic distclean-hdr distclean-libtool \
-	distclean-multi distclean-recursive distclean-tags \
-	distcleancheck distdir distuninstallcheck dvi dvi-am html \
-	html-am info info-am install install-am install-data \
-	install-data-am install-exec install-exec-am install-info \
-	install-info-am install-man install-multi \
-	install-nobase_libsubincludeHEADERS install-strip \
-	install-toolexeclibLTLIBRARIES installcheck installcheck-am \
-	installdirs installdirs-am maintainer-clean \
+	ctags-recursive distclean distclean-compile distclean-generic \
+	distclean-hdr distclean-libtool distclean-multi \
+	distclean-recursive distclean-tags dvi dvi-am html html-am \
+	info info-am install install-am install-data install-data-am \
+	install-exec install-exec-am install-info install-info-am \
+	install-man install-multi install-nobase_libsubincludeHEADERS \
+	install-strip install-toolexeclibLTLIBRARIES installcheck \
+	installcheck-am installdirs installdirs-am maintainer-clean \
 	maintainer-clean-generic maintainer-clean-multi \
 	maintainer-clean-recursive mostlyclean mostlyclean-compile \
 	mostlyclean-generic mostlyclean-libtool mostlyclean-multi \
Index: libmudflap/ChangeLog
===================================================================
--- libmudflap/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libmudflap/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,9 @@
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libmudflap/configure.ac
===================================================================
--- libmudflap/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libmudflap/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -7,7 +7,7 @@
 AC_CANONICAL_SYSTEM
 ACX_NONCANONICAL_TARGET
 
-AM_INIT_AUTOMAKE
+AM_INIT_AUTOMAKE([no-dist])
 
 AC_MSG_CHECKING([for --enable-version-specific-runtime-libs])
 AC_ARG_ENABLE(version-specific-runtime-libs,
Index: libffi/configure
===================================================================
--- libffi/configure	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/configure	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -13272,7 +13272,7 @@
 
 	libffi_cv_as_x86_pcrel=yes
 	echo '.text; foo: nop; .data; .long foo-.; .text' > conftest.s
-	if $CC $CFLAGS -c conftest.s 2>&1 | grep -i warning > /dev/null; then
+	if $CC $CFLAGS -c conftest.s 2>&1 | $EGREP -i 'illegal|warning' > /dev/null; then
 	    libffi_cv_as_x86_pcrel=no
 	fi
 
@@ -13286,8 +13286,163 @@
 _ACEOF
 
     fi
+
+    echo "$as_me:$LINENO: checking assembler .ascii pseudo-op support" >&5
+echo $ECHO_N "checking assembler .ascii pseudo-op support... $ECHO_C" >&6
+if test "${libffi_cv_as_ascii_pseudo_op+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+       libffi_cv_as_ascii_pseudo_op=unknown
+       # Check if we have .ascii
+       cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+asm (".ascii \"string\"");
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  libffi_cv_as_ascii_pseudo_op=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+libffi_cv_as_ascii_pseudo_op=no
 fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
 
+fi
+echo "$as_me:$LINENO: result: $libffi_cv_as_ascii_pseudo_op" >&5
+echo "${ECHO_T}$libffi_cv_as_ascii_pseudo_op" >&6
+    if test "x$libffi_cv_as_ascii_pseudo_op" = xyes; then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_AS_ASCII_PSEUDO_OP 1
+_ACEOF
+
+    fi
+
+    echo "$as_me:$LINENO: checking assembler .string pseudo-op support" >&5
+echo $ECHO_N "checking assembler .string pseudo-op support... $ECHO_C" >&6
+if test "${libffi_cv_as_string_pseudo_op+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+       libffi_cv_as_string_pseudo_op=unknown
+       # Check if we have .string
+       cat >conftest.$ac_ext <<_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h >>conftest.$ac_ext
+cat >>conftest.$ac_ext <<_ACEOF
+/* end confdefs.h.  */
+asm (".string \"string\"");
+int
+main ()
+{
+
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext
+if { (eval echo "$as_me:$LINENO: \"$ac_compile\"") >&5
+  (eval $ac_compile) 2>conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 >conftest.err
+  rm -f conftest.er1
+  cat conftest.err >&5
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); } &&
+	 { ac_try='test -z "$ac_c_werror_flag"
+			 || test ! -s conftest.err'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; } &&
+	 { ac_try='test -s conftest.$ac_objext'
+  { (eval echo "$as_me:$LINENO: \"$ac_try\"") >&5
+  (eval $ac_try) 2>&5
+  ac_status=$?
+  echo "$as_me:$LINENO: \$? = $ac_status" >&5
+  (exit $ac_status); }; }; then
+  libffi_cv_as_string_pseudo_op=yes
+else
+  echo "$as_me: failed program was:" >&5
+sed 's/^/| /' conftest.$ac_ext >&5
+
+libffi_cv_as_string_pseudo_op=no
+fi
+rm -f conftest.err conftest.$ac_objext conftest.$ac_ext
+
+fi
+echo "$as_me:$LINENO: result: $libffi_cv_as_string_pseudo_op" >&5
+echo "${ECHO_T}$libffi_cv_as_string_pseudo_op" >&6
+    if test "x$libffi_cv_as_string_pseudo_op" = xyes; then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_AS_STRING_PSEUDO_OP 1
+_ACEOF
+
+    fi
+fi
+
+if test x$TARGET = xX86_64; then
+    echo "$as_me:$LINENO: checking assembler supports unwind section type" >&5
+echo $ECHO_N "checking assembler supports unwind section type... $ECHO_C" >&6
+if test "${libffi_cv_as_x86_64_unwind_section_type+set}" = set; then
+  echo $ECHO_N "(cached) $ECHO_C" >&6
+else
+
+	libffi_cv_as_x86_64_unwind_section_type=yes
+	echo '.section .eh_frame,"a",@unwind' > conftest.s
+	if $CC $CFLAGS -c conftest.s 2>&1 | grep -i warning > /dev/null; then
+	    libffi_cv_as_x86_64_unwind_section_type=no
+	fi
+
+fi
+echo "$as_me:$LINENO: result: $libffi_cv_as_x86_64_unwind_section_type" >&5
+echo "${ECHO_T}$libffi_cv_as_x86_64_unwind_section_type" >&6
+    if test "x$libffi_cv_as_x86_64_unwind_section_type" = xyes; then
+
+cat >>confdefs.h <<\_ACEOF
+#define HAVE_AS_X86_64_UNWIND_SECTION_TYPE 1
+_ACEOF
+
+    fi
+fi
+
 echo "$as_me:$LINENO: checking whether .eh_frame section should be read-only" >&5
 echo $ECHO_N "checking whether .eh_frame section should be read-only... $ECHO_C" >&6
 if test "${libffi_cv_ro_eh_frame+set}" = set; then
Index: libffi/Makefile.in
===================================================================
--- libffi/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -59,13 +59,32 @@
 @SH64_TRUE@am__append_20 = src/sh64/sysv.S src/sh64/ffi.c
 @PA_LINUX_TRUE@am__append_21 = src/pa/linux.S src/pa/ffi.c
 @PA_HPUX_TRUE@am__append_22 = src/pa/hpux32.S src/pa/ffi.c
-DIST_COMMON = README $(am__configure_deps) $(srcdir)/../compile \
-	$(srcdir)/../config.guess $(srcdir)/../config.sub \
-	$(srcdir)/../depcomp $(srcdir)/../install-sh \
-	$(srcdir)/../ltmain.sh $(srcdir)/../missing \
-	$(srcdir)/../mkinstalldirs $(srcdir)/Makefile.am \
-	$(srcdir)/Makefile.in $(srcdir)/fficonfig.h.in \
-	$(top_srcdir)/configure ChangeLog
+DIST_COMMON = $(srcdir)/../config.guess $(srcdir)/../config.sub README \
+	ChangeLog $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/fficonfig.h.in $(srcdir)/../mkinstalldirs \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../compile \
+	$(srcdir)/../depcomp $(srcdir)/../ltmain.sh \
+	$(srcdir)/../config.guess $(srcdir)/../config.sub
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../config/depstand.m4 \
@@ -174,7 +193,6 @@
 SOURCES = $(libffi_la_SOURCES) $(nodist_libffi_la_SOURCES) \
 	$(libffi_convenience_la_SOURCES) \
 	$(nodist_libffi_convenience_la_SOURCES)
-DIST_SOURCES = $(libffi_la_SOURCES) $(libffi_convenience_la_SOURCES)
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -190,17 +208,6 @@
 ETAGS = etags
 CTAGS = ctags
 DIST_SUBDIRS = $(SUBDIRS)
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 ALLOCA = @ALLOCA@
 ALPHA_FALSE = @ALPHA_FALSE@
@@ -1087,149 +1094,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/include $(distdir)/src/alpha $(distdir)/src/arm $(distdir)/src/cris $(distdir)/src/frv $(distdir)/src/ia64 $(distdir)/src/m32r $(distdir)/src/m68k $(distdir)/src/mips $(distdir)/src/pa $(distdir)/src/powerpc $(distdir)/src/s390 $(distdir)/src/sh $(distdir)/src/sh64 $(distdir)/src/sparc $(distdir)/src/x86
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
-	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
-	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
-	        distdir) \
-	      || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-recursive
 all-am: Makefile $(LTLIBRARIES) all-multi fficonfig.h
@@ -1353,13 +1217,11 @@
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am all-multi \
 	am--refresh check check-am clean clean-generic clean-libtool \
 	clean-multi clean-noinstLTLIBRARIES clean-recursive \
-	clean-toolexeclibLTLIBRARIES ctags ctags-recursive dist \
-	dist-all dist-bzip2 dist-gzip dist-shar dist-tarZ dist-zip \
-	distcheck distclean distclean-compile distclean-generic \
-	distclean-hdr distclean-libtool distclean-multi \
-	distclean-recursive distclean-tags distcleancheck distdir \
-	distuninstallcheck dvi dvi-am html html-am info info-am \
-	install install-am install-data install-data-am install-exec \
+	clean-toolexeclibLTLIBRARIES ctags ctags-recursive distclean \
+	distclean-compile distclean-generic distclean-hdr \
+	distclean-libtool distclean-multi distclean-recursive \
+	distclean-tags dvi dvi-am html html-am info info-am install \
+	install-am install-data install-data-am install-exec \
 	install-exec-am install-info install-info-am install-man \
 	install-multi install-strip install-toolexeclibLTLIBRARIES \
 	installcheck installcheck-am installdirs installdirs-am \
Index: libffi/fficonfig.h.in
===================================================================
--- libffi/fficonfig.h.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/fficonfig.h.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -27,6 +27,9 @@
    */
 #undef HAVE_ALLOCA_H
 
+/* Define if your assembler supports .ascii. */
+#undef HAVE_AS_ASCII_PSEUDO_OP
+
 /* Define if your assembler supports .cfi_* directives. */
 #undef HAVE_AS_CFI_PSEUDO_OP
 
@@ -37,6 +40,12 @@
    */
 #undef HAVE_AS_SPARC_UA_PCREL
 
+/* Define if your assembler supports .string. */
+#undef HAVE_AS_STRING_PSEUDO_OP
+
+/* Define if your assembler supports unwind section type. */
+#undef HAVE_AS_X86_64_UNWIND_SECTION_TYPE
+
 /* Define if your assembler supports PC relative relocs. */
 #undef HAVE_AS_X86_PCREL
 
Index: libffi/ChangeLog
===================================================================
--- libffi/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,34 @@
+2010-05-21  Jakub Jelinek  <jakub@redhat.com>
+
+	* configure: Regenerate.
+
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* configure.ac (libffi_cv_as_x86_pcrel): Check for illegal in as
+	output, too.
+	(libffi_cv_as_ascii_pseudo_op): Check for .ascii.
+	(libffi_cv_as_string_pseudo_op): Check for .string.
+	* configure: Regenerate.
+	* fficonfig.h.in: Regenerate.
+	* src/x86/sysv.S (.eh_frame): Use .ascii, .string or error.
+
+2010-05-19  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	Backport from mainline:
+	2010-03-15  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* configure.ac (libffi_cv_as_x86_64_unwind_section_type): New test.
+	* configure: Regenerate.
+	* fficonfig.h.in: Regenerate.
+	* libffi/src/x86/unix64.S (.eh_frame)
+	[HAVE_AS_X86_64_UNWIND_SECTION_TYPE]: Use @unwind section type.
+
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libffi/src/x86/sysv.S
===================================================================
--- libffi/src/x86/sysv.S	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/src/x86/sysv.S	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,5 +1,5 @@
 /* -----------------------------------------------------------------------
-   sysv.S - Copyright (c) 1996, 1998, 2001, 2002, 2003, 2005, 2008
+   sysv.S - Copyright (c) 1996, 1998, 2001, 2002, 2003, 2005, 2008, 2010
    Red Hat, Inc.
    
    X86 Foreign Function Interface 
@@ -331,11 +331,21 @@
 .LSCIE1:
 	.long	0x0	/* CIE Identifier Tag */
 	.byte	0x1	/* CIE Version */
+#ifdef HAVE_AS_ASCII_PSEUDO_OP
 #ifdef __PIC__
 	.ascii "zR\0"	/* CIE Augmentation */
 #else
 	.ascii "\0"	/* CIE Augmentation */
 #endif
+#elif defined HAVE_AS_STRING_PSEUDO_OP
+#ifdef __PIC__
+	.string "zR"	/* CIE Augmentation */
+#else
+	.string ""	/* CIE Augmentation */
+#endif
+#else
+#error missing .ascii/.string
+#endif
 	.byte	0x1	/* .uleb128 0x1; CIE Code Alignment Factor */
 	.byte	0x7c	/* .sleb128 -4; CIE Data Alignment Factor */
 	.byte	0x8	/* CIE RA Column */
Index: libffi/src/x86/unix64.S
===================================================================
--- libffi/src/x86/unix64.S	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/src/x86/unix64.S	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -322,7 +322,11 @@
 .LUW9:
 	.size	ffi_closure_unix64,.-ffi_closure_unix64
 
+#ifdef HAVE_AS_X86_64_UNWIND_SECTION_TYPE
+	.section	.eh_frame,"a",@unwind
+#else
 	.section	.eh_frame,"a",@progbits
+#endif
 .Lframe1:
 	.long	.LECIE1-.LSCIE1		/* CIE Length */
 .LSCIE1:
Index: libffi/configure.ac
===================================================================
--- libffi/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libffi/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -12,7 +12,7 @@
 
 . ${srcdir}/configure.host
 
-AM_INIT_AUTOMAKE
+AM_INIT_AUTOMAKE([no-dist])
 
 # The same as in boehm-gc and libstdc++. Have to borrow it from there.
 # We must force CC to /not/ be precious variables; otherwise
@@ -245,7 +245,7 @@
 	libffi_cv_as_x86_pcrel, [
 	libffi_cv_as_x86_pcrel=yes
 	echo '.text; foo: nop; .data; .long foo-.; .text' > conftest.s
-	if $CC $CFLAGS -c conftest.s 2>&1 | grep -i warning > /dev/null; then
+	if $CC $CFLAGS -c conftest.s 2>&1 | $EGREP -i 'illegal|warning' > /dev/null; then
 	    libffi_cv_as_x86_pcrel=no
 	fi
 	])
@@ -253,8 +253,49 @@
 	AC_DEFINE(HAVE_AS_X86_PCREL, 1,
 		  [Define if your assembler supports PC relative relocs.])
     fi
+
+    AC_CACHE_CHECK([assembler .ascii pseudo-op support],
+       libffi_cv_as_ascii_pseudo_op, [
+       libffi_cv_as_ascii_pseudo_op=unknown
+       # Check if we have .ascii
+       AC_TRY_COMPILE([asm (".ascii \"string\"");],,
+		       [libffi_cv_as_ascii_pseudo_op=yes],
+		       [libffi_cv_as_ascii_pseudo_op=no])
+    ])
+    if test "x$libffi_cv_as_ascii_pseudo_op" = xyes; then
+       AC_DEFINE(HAVE_AS_ASCII_PSEUDO_OP, 1,
+	       [Define if your assembler supports .ascii.])
+    fi
+
+    AC_CACHE_CHECK([assembler .string pseudo-op support],
+       libffi_cv_as_string_pseudo_op, [
+       libffi_cv_as_string_pseudo_op=unknown
+       # Check if we have .string
+       AC_TRY_COMPILE([asm (".string \"string\"");],,
+		       [libffi_cv_as_string_pseudo_op=yes],
+		       [libffi_cv_as_string_pseudo_op=no])
+    ])
+    if test "x$libffi_cv_as_string_pseudo_op" = xyes; then
+       AC_DEFINE(HAVE_AS_STRING_PSEUDO_OP, 1,
+	       [Define if your assembler supports .string.])
+    fi
 fi
 
+if test x$TARGET = xX86_64; then
+    AC_CACHE_CHECK([assembler supports unwind section type],
+	libffi_cv_as_x86_64_unwind_section_type, [
+	libffi_cv_as_x86_64_unwind_section_type=yes
+	echo '.section .eh_frame,"a",@unwind' > conftest.s
+	if $CC $CFLAGS -c conftest.s 2>&1 | grep -i warning > /dev/null; then
+	    libffi_cv_as_x86_64_unwind_section_type=no
+	fi
+	])
+    if test "x$libffi_cv_as_x86_64_unwind_section_type" = xyes; then
+	AC_DEFINE(HAVE_AS_X86_64_UNWIND_SECTION_TYPE, 1,
+		  [Define if your assembler supports unwind section type.])
+    fi
+fi
+
 AC_CACHE_CHECK([whether .eh_frame section should be read-only],
     libffi_cv_ro_eh_frame, [
 	libffi_cv_ro_eh_frame=no
Index: libssp/Makefile.in
===================================================================
--- libssp/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libssp/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -38,14 +38,14 @@
 build_triplet = @build@
 host_triplet = @host@
 target_triplet = @target@
-DIST_COMMON = $(am__configure_deps) $(nobase_libsubinclude_HEADERS) \
-	$(srcdir)/../compile $(srcdir)/../config.guess \
-	$(srcdir)/../config.sub $(srcdir)/../depcomp \
-	$(srcdir)/../install-sh $(srcdir)/../ltmain.sh \
-	$(srcdir)/../missing $(srcdir)/../mkinstalldirs \
-	$(srcdir)/Makefile.am $(srcdir)/Makefile.in \
-	$(srcdir)/config.h.in $(top_srcdir)/configure \
-	$(top_srcdir)/ssp/ssp.h.in ChangeLog
+DIST_COMMON = $(srcdir)/../config.guess $(srcdir)/../config.sub \
+	ChangeLog $(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/config.h.in $(srcdir)/../mkinstalldirs \
+	$(top_srcdir)/ssp/ssp.h.in $(srcdir)/../compile \
+	$(srcdir)/../depcomp $(srcdir)/../ltmain.sh \
+	$(srcdir)/../config.guess $(srcdir)/../config.sub \
+	$(nobase_libsubinclude_HEADERS)
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../config/acx.m4 \
@@ -94,7 +94,6 @@
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(libssp_la_SOURCES) $(libssp_nonshared_la_SOURCES)
-DIST_SOURCES = $(libssp_la_SOURCES) $(libssp_nonshared_la_SOURCES)
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -105,17 +104,6 @@
 HEADERS = $(nobase_libsubinclude_HEADERS)
 ETAGS = etags
 CTAGS = ctags
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -546,134 +534,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/.. $(distdir)/../config $(distdir)/ssp
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-am
 all-am: Makefile $(LTLIBRARIES) all-multi $(HEADERS) config.h
@@ -762,20 +622,18 @@
 
 .PHONY: CTAGS GTAGS all all-am all-multi am--refresh check check-am \
 	clean clean-generic clean-libtool clean-multi \
-	clean-toolexeclibLTLIBRARIES ctags dist dist-all dist-bzip2 \
-	dist-gzip dist-shar dist-tarZ dist-zip distcheck distclean \
-	distclean-compile distclean-generic distclean-hdr \
-	distclean-libtool distclean-multi distclean-tags \
-	distcleancheck distdir distuninstallcheck dvi dvi-am html \
-	html-am info info-am install install-am install-data \
-	install-data-am install-exec install-exec-am install-info \
-	install-info-am install-man install-multi \
-	install-nobase_libsubincludeHEADERS install-strip \
-	install-toolexeclibLTLIBRARIES installcheck installcheck-am \
-	installdirs maintainer-clean maintainer-clean-generic \
-	maintainer-clean-multi mostlyclean mostlyclean-compile \
-	mostlyclean-generic mostlyclean-libtool mostlyclean-multi pdf \
-	pdf-am ps ps-am tags uninstall uninstall-am uninstall-info-am \
+	clean-toolexeclibLTLIBRARIES ctags distclean distclean-compile \
+	distclean-generic distclean-hdr distclean-libtool \
+	distclean-multi distclean-tags dvi dvi-am html html-am info \
+	info-am install install-am install-data install-data-am \
+	install-exec install-exec-am install-info install-info-am \
+	install-man install-multi install-nobase_libsubincludeHEADERS \
+	install-strip install-toolexeclibLTLIBRARIES installcheck \
+	installcheck-am installdirs maintainer-clean \
+	maintainer-clean-generic maintainer-clean-multi mostlyclean \
+	mostlyclean-compile mostlyclean-generic mostlyclean-libtool \
+	mostlyclean-multi pdf pdf-am ps ps-am tags uninstall \
+	uninstall-am uninstall-info-am \
 	uninstall-nobase_libsubincludeHEADERS \
 	uninstall-toolexeclibLTLIBRARIES
 
Index: libssp/ChangeLog
===================================================================
--- libssp/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libssp/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,9 @@
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libssp/configure.ac
===================================================================
--- libssp/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libssp/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -8,7 +8,7 @@
 AC_CANONICAL_SYSTEM
 ACX_NONCANONICAL_TARGET
 
-AM_INIT_AUTOMAKE
+AM_INIT_AUTOMAKE([no-dist])
 
 AC_MSG_CHECKING([for --enable-version-specific-runtime-libs])
 AC_ARG_ENABLE(version-specific-runtime-libs,
Index: contrib/ChangeLog
===================================================================
--- contrib/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ contrib/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,13 @@
+2010-05-25  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* dg-extract-results.sh: Redirect grep output to /dev/null instead
+	of grep -q.
+
+	Backport from mainline:
+	2010-01-05  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* dg-extract-results.sh: Don't use tail -n.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: contrib/dg-extract-results.sh
===================================================================
--- contrib/dg-extract-results.sh	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ contrib/dg-extract-results.sh	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -224,7 +224,7 @@
   VARIANTS=""
   for VAR in $VARS
   do
-    grep -q "Running target $VAR" $SUM_FILES && VARIANTS="$VARIANTS $VAR"
+    grep "Running target $VAR" $SUM_FILES > /dev/null && VARIANTS="$VARIANTS $VAR"
   done
 fi
 
@@ -418,6 +418,6 @@
 # This is ugly, but if there's version output from the compiler under test
 # at the end of the file, we want it.  The other thing that might be there
 # is the final summary counts.
-tail -n 2 $FIRST_SUM | grep -q '^#' || tail -n 2 $FIRST_SUM
+tail -2 $FIRST_SUM | grep '^#' > /dev/null || tail -2 $FIRST_SUM
 
 exit 0
Index: libjava/Makefile.in
===================================================================
--- libjava/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -61,20 +61,21 @@
 @USING_WIN32_THREADS_TRUE@am__append_16 = win32-threads.cc
 @USING_NO_THREADS_TRUE@am__append_17 = no-threads.cc
 @ANONVERSCRIPT_TRUE@am__append_18 = $(srcdir)/libgcj.ver
-DIST_COMMON = README $(am__configure_deps) $(srcdir)/../compile \
-	$(srcdir)/../config.guess $(srcdir)/../config.sub \
-	$(srcdir)/../depcomp $(srcdir)/../install-sh \
-	$(srcdir)/../ltmain.sh $(srcdir)/../missing \
-	$(srcdir)/../mkinstalldirs $(srcdir)/Makefile.am \
-	$(srcdir)/Makefile.in $(srcdir)/libgcj-test.spec.in \
-	$(srcdir)/libgcj.pc.in $(srcdir)/libgcj.spec.in \
-	$(srcdir)/sources.am $(top_srcdir)/configure \
-	$(top_srcdir)/contrib/aot-compile-rpm.in \
-	$(top_srcdir)/contrib/aot-compile.in \
+DIST_COMMON = $(srcdir)/sources.am $(srcdir)/../config.guess \
+	$(srcdir)/../config.sub NEWS README ChangeLog THANKS \
+	$(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/../mkinstalldirs $(srcdir)/libgcj.pc.in \
+	$(srcdir)/libgcj.spec.in $(srcdir)/libgcj-test.spec.in \
 	$(top_srcdir)/contrib/aotcompile.py.in \
+	$(top_srcdir)/contrib/aot-compile.in \
+	$(top_srcdir)/contrib/aot-compile-rpm.in \
 	$(top_srcdir)/contrib/generate-cacerts.pl.in \
 	$(top_srcdir)/contrib/rebuild-gcj-db.in \
-	$(top_srcdir)/scripts/jar.in COPYING ChangeLog NEWS THANKS
+	$(top_srcdir)/scripts/jar.in $(srcdir)/../compile \
+	$(srcdir)/../compile $(srcdir)/../compile $(srcdir)/../depcomp \
+	$(srcdir)/../ltmain.sh $(srcdir)/../config.guess \
+	$(srcdir)/../config.sub
 @MAINTAINER_MODE_TRUE@@NATIVE_TRUE@am__append_19 = gen-from-JIS
 @NATIVE_TRUE@@USE_LIBGCJ_BC_TRUE@am__append_20 = libgcj_bc.la
 @NATIVE_TRUE@@USE_LIBGCJ_BC_FALSE@am__append_21 = libgcj.la
@@ -307,72 +308,6 @@
 am__DEPENDENCIES_4 = $(patsubst classpath/resource/%,%,$(addsuffix \
 	.lo,$(property_files)))
 am__DEPENDENCIES_5 =
-am__libgcj_la_SOURCES_DIST = prims.cc jni.cc exception.cc \
-	stacktrace.cc link.cc defineclass.cc verify.cc jvmti.cc \
-	interpret.cc gnu/classpath/jdwp/natVMFrame.cc \
-	gnu/classpath/jdwp/natVMMethod.cc \
-	gnu/classpath/jdwp/natVMVirtualMachine.cc \
-	gnu/classpath/natConfiguration.cc \
-	gnu/classpath/natSystemProperties.cc \
-	gnu/classpath/natVMStackWalker.cc gnu/gcj/natCore.cc \
-	gnu/gcj/convert/JIS0208_to_Unicode.cc \
-	gnu/gcj/convert/JIS0212_to_Unicode.cc \
-	gnu/gcj/convert/Unicode_to_JIS.cc gnu/gcj/convert/natIconv.cc \
-	gnu/gcj/convert/natInput_EUCJIS.cc \
-	gnu/gcj/convert/natInput_SJIS.cc \
-	gnu/gcj/convert/natOutput_EUCJIS.cc \
-	gnu/gcj/convert/natOutput_SJIS.cc \
-	gnu/gcj/io/natSimpleSHSStream.cc gnu/gcj/io/shs.cc \
-	gnu/gcj/jvmti/natBreakpoint.cc \
-	gnu/gcj/jvmti/natNormalBreakpoint.cc \
-	gnu/gcj/runtime/natFinalizerThread.cc \
-	gnu/gcj/runtime/natSharedLibLoader.cc \
-	gnu/gcj/runtime/natSystemClassLoader.cc \
-	gnu/gcj/runtime/natStringBuffer.cc gnu/gcj/util/natDebug.cc \
-	gnu/gcj/util/natGCInfo.cc gnu/java/lang/natMainThread.cc \
-	gnu/java/lang/management/natVMClassLoadingMXBeanImpl.cc \
-	gnu/java/lang/management/natVMCompilationMXBeanImpl.cc \
-	gnu/java/lang/management/natVMGarbageCollectorMXBeanImpl.cc \
-	gnu/java/lang/management/natVMMemoryMXBeanImpl.cc \
-	gnu/java/lang/management/natVMMemoryManagerMXBeanImpl.cc \
-	gnu/java/lang/management/natVMMemoryPoolMXBeanImpl.cc \
-	gnu/java/lang/management/natVMOperatingSystemMXBeanImpl.cc \
-	gnu/java/lang/management/natVMRuntimeMXBeanImpl.cc \
-	gnu/java/lang/management/natVMThreadMXBeanImpl.cc \
-	gnu/java/net/natPlainDatagramSocketImpl.cc \
-	gnu/java/net/natPlainSocketImpl.cc \
-	gnu/java/net/protocol/core/natCoreInputStream.cc \
-	gnu/java/nio/natVMPipe.cc gnu/java/nio/natVMSelector.cc \
-	gnu/java/nio/natNIOServerSocket.cc \
-	gnu/java/nio/natVMChannel.cc \
-	gnu/java/nio/channels/natFileChannelImpl.cc \
-	gnu/java/security/jce/prng/natVMSecureRandom.cc \
-	java/io/natFile.cc java/io/natVMObjectInputStream.cc \
-	java/io/natVMObjectStreamClass.cc java/lang/natCharacter.cc \
-	java/lang/natClass.cc java/lang/natClassLoader.cc \
-	java/lang/natConcreteProcess.cc java/lang/natVMDouble.cc \
-	java/lang/natVMFloat.cc java/lang/natMath.cc \
-	java/lang/natObject.cc java/lang/natRuntime.cc \
-	java/lang/natString.cc java/lang/natAbstractStringBuffer.cc \
-	java/lang/natSystem.cc java/lang/natThread.cc \
-	java/lang/natThreadLocal.cc java/lang/natVMClassLoader.cc \
-	java/lang/natVMProcess.cc java/lang/natVMThrowable.cc \
-	java/lang/ref/natReference.cc java/lang/reflect/natArray.cc \
-	java/lang/reflect/natConstructor.cc \
-	java/lang/reflect/natField.cc java/lang/reflect/natMethod.cc \
-	java/lang/reflect/natVMProxy.cc java/net/natVMInetAddress.cc \
-	java/net/natVMNetworkInterface.cc \
-	java/net/natVMURLConnection.cc \
-	java/nio/channels/natVMChannels.cc \
-	java/nio/natVMDirectByteBufferImpl.cc \
-	java/security/natVMAccessController.cc \
-	java/security/natVMAccessControlState.cc \
-	java/text/natCollator.cc java/util/natVMTimeZone.cc \
-	java/util/concurrent/atomic/natAtomicLong.cc \
-	java/util/logging/natLogger.cc java/util/zip/natDeflater.cc \
-	java/util/zip/natInflater.cc sun/misc/natUnsafe.cc boehm.cc \
-	nogc.cc posix.cc win32.cc darwin.cc posix-threads.cc \
-	win32-threads.cc no-threads.cc
 @INTERPRETER_TRUE@am__objects_2 = jvmti.lo interpret.lo
 @INTERPRETER_TRUE@am__objects_3 = gnu/classpath/jdwp/natVMFrame.lo \
 @INTERPRETER_TRUE@	gnu/classpath/jdwp/natVMMethod.lo \
@@ -484,8 +419,6 @@
 gcj_dbtool_OBJECTS = $(am_gcj_dbtool_OBJECTS)
 am_gcjh_OBJECTS =
 gcjh_OBJECTS = $(am_gcjh_OBJECTS)
-am__gen_from_JIS_SOURCES_DIST = gnu/gcj/convert/gen-from-JIS.c \
-	gnu/gcj/convert/make-trie.c gnu/gcj/convert/make-trie.h
 @MAINTAINER_MODE_TRUE@@NATIVE_TRUE@am_gen_from_JIS_OBJECTS = gnu/gcj/convert/gen-from-JIS.$(OBJEXT) \
 @MAINTAINER_MODE_TRUE@@NATIVE_TRUE@	gnu/gcj/convert/make-trie.$(OBJEXT)
 gen_from_JIS_OBJECTS = $(am_gen_from_JIS_OBJECTS)
@@ -552,18 +485,6 @@
 	$(grmic_SOURCES) $(grmid_SOURCES) $(grmiregistry_SOURCES) \
 	$(gserialver_SOURCES) $(gtnameserv_SOURCES) \
 	$(jv_convert_SOURCES)
-DIST_SOURCES = $(lib_gnu_awt_xlib_la_SOURCES) \
-	$(libgcj_tools_la_SOURCES) $(am__libgcj_la_SOURCES_DIST) \
-	$(EXTRA_libgcj_la_SOURCES) $(libgcj_bc_la_SOURCES) \
-	$(libgij_la_SOURCES) $(libjvm_la_SOURCES) $(ecjx_SOURCES) \
-	$(gappletviewer_SOURCES) $(gc_analyze_SOURCES) \
-	$(gcj_dbtool_SOURCES) $(gcjh_SOURCES) \
-	$(am__gen_from_JIS_SOURCES_DIST) $(gij_SOURCES) \
-	$(gjar_SOURCES) $(gjarsigner_SOURCES) $(gjavah_SOURCES) \
-	$(gjdoc_SOURCES) $(gkeytool_SOURCES) $(gnative2ascii_SOURCES) \
-	$(gorbd_SOURCES) $(grmic_SOURCES) $(grmid_SOURCES) \
-	$(grmiregistry_SOURCES) $(gserialver_SOURCES) \
-	$(gtnameserv_SOURCES) $(jv_convert_SOURCES)
 RECURSIVE_TARGETS = all-recursive check-recursive dvi-recursive \
 	html-recursive info-recursive install-data-recursive \
 	install-exec-recursive install-info-recursive \
@@ -577,17 +498,6 @@
 ETAGS = etags
 CTAGS = ctags
 DIST_SUBDIRS = @DIRLTDL@ gcj include classpath testsuite
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -10179,149 +10089,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/. $(distdir)/.. $(distdir)/../config $(distdir)/contrib $(distdir)/libltdl $(distdir)/scripts
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
-	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
-	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
-	        distdir) \
-	      || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-recursive
 all-am: Makefile $(LTLIBRARIES) $(PROGRAMS) $(SCRIPTS) all-multi \
@@ -10491,18 +10258,16 @@
 	am--refresh check check-am clean clean-binPROGRAMS \
 	clean-dbexecLTLIBRARIES clean-generic clean-libexecsubPROGRAMS \
 	clean-libtool clean-multi clean-noinstPROGRAMS clean-recursive \
-	clean-toolexeclibLTLIBRARIES ctags ctags-recursive dist \
-	dist-all dist-bzip2 dist-gzip dist-shar dist-tarZ dist-zip \
-	distcheck distclean distclean-compile distclean-generic \
-	distclean-libtool distclean-local distclean-multi \
-	distclean-recursive distclean-tags distcleancheck distdir \
-	distuninstallcheck dvi dvi-am html html-am info info-am \
-	install install-am install-binPROGRAMS install-binSCRIPTS \
-	install-data install-data-am install-data-local \
-	install-dbexecDATA install-dbexecLTLIBRARIES install-exec \
-	install-exec-am install-exec-hook install-info install-info-am \
-	install-jarDATA install-libexecsubPROGRAMS install-man \
-	install-multi install-strip install-toolexeclibLTLIBRARIES \
+	clean-toolexeclibLTLIBRARIES ctags ctags-recursive distclean \
+	distclean-compile distclean-generic distclean-libtool \
+	distclean-local distclean-multi distclean-recursive \
+	distclean-tags dvi dvi-am html html-am info info-am install \
+	install-am install-binPROGRAMS install-binSCRIPTS install-data \
+	install-data-am install-data-local install-dbexecDATA \
+	install-dbexecLTLIBRARIES install-exec install-exec-am \
+	install-exec-hook install-info install-info-am install-jarDATA \
+	install-libexecsubPROGRAMS install-man install-multi \
+	install-strip install-toolexeclibLTLIBRARIES \
 	install-toolexecmainlibDATA installcheck installcheck-am \
 	installdirs installdirs-am maintainer-clean \
 	maintainer-clean-generic maintainer-clean-multi \
Index: libjava/libltdl/Makefile.in
===================================================================
--- libjava/libltdl/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/libltdl/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -37,11 +37,11 @@
 POST_UNINSTALL = :
 build_triplet = @build@
 host_triplet = @host@
-DIST_COMMON = README $(am__configure_deps) $(am__include_HEADERS_DIST) \
-	$(am__noinst_HEADERS_DIST) $(srcdir)/Makefile.am \
-	$(srcdir)/Makefile.in $(srcdir)/config-h.in \
-	$(top_srcdir)/configure COPYING.LIB ChangeLog config.guess \
-	config.sub install-sh ltmain.sh missing
+DIST_COMMON = config.guess config.sub README ChangeLog \
+	$(srcdir)/Makefile.in $(srcdir)/Makefile.am \
+	$(top_srcdir)/configure $(am__configure_deps) \
+	$(srcdir)/config-h.in ltmain.sh config.guess config.sub \
+	$(am__include_HEADERS_DIST) $(am__noinst_HEADERS_DIST)
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../../config/depstand.m4 \
@@ -87,7 +87,6 @@
 LINK = $(LIBTOOL) --tag=CC --mode=link $(CCLD) $(AM_CFLAGS) $(CFLAGS) \
 	$(AM_LDFLAGS) $(LDFLAGS) -o $@
 SOURCES = $(libltdl_la_SOURCES) $(libltdlc_la_SOURCES)
-DIST_SOURCES = $(libltdl_la_SOURCES) $(libltdlc_la_SOURCES)
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -100,17 +99,6 @@
 HEADERS = $(include_HEADERS) $(noinst_HEADERS)
 ETAGS = etags
 CTAGS = ctags
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -223,7 +211,7 @@
 sharedstatedir = @sharedstatedir@
 sysconfdir = @sysconfdir@
 target_alias = @target_alias@
-AUTOMAKE_OPTIONS = no-dependencies foreign
+AUTOMAKE_OPTIONS = no-dependencies foreign no-dist
 ACLOCAL_AMFLAGS = -I ../.. -I ../../config
 INCLUDES = $(GCINCS)
 @INSTALL_LTDL_TRUE@include_HEADERS = ltdl.h
@@ -445,134 +433,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/../../config
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-am
 all-am: Makefile $(LTLIBRARIES) all-multi $(HEADERS) config.h
@@ -661,12 +521,10 @@
 
 .PHONY: CTAGS GTAGS all all-am all-multi am--refresh check check-am \
 	clean clean-generic clean-libLTLIBRARIES clean-libtool \
-	clean-multi clean-noinstLTLIBRARIES ctags dist dist-all \
-	dist-bzip2 dist-gzip dist-shar dist-tarZ dist-zip distcheck \
-	distclean distclean-compile distclean-generic distclean-hdr \
-	distclean-libtool distclean-multi distclean-tags \
-	distcleancheck distdir distuninstallcheck dvi dvi-am html \
-	html-am info info-am install install-am install-data \
+	clean-multi clean-noinstLTLIBRARIES ctags distclean \
+	distclean-compile distclean-generic distclean-hdr \
+	distclean-libtool distclean-multi distclean-tags dvi dvi-am \
+	html html-am info info-am install install-am install-data \
 	install-data-am install-data-local install-exec \
 	install-exec-am install-includeHEADERS install-info \
 	install-info-am install-libLTLIBRARIES install-man \
Index: libjava/libltdl/ChangeLog
===================================================================
--- libjava/libltdl/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/libltdl/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,9 @@
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* Makefile.am (AUTOMAKE_OPTIONS): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libjava/libltdl/Makefile.am
===================================================================
--- libjava/libltdl/Makefile.am	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/libltdl/Makefile.am	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,6 +1,6 @@
 ## Process this file with automake to produce Makefile.in
 
-AUTOMAKE_OPTIONS = no-dependencies foreign
+AUTOMAKE_OPTIONS = no-dependencies foreign no-dist
 
 ACLOCAL_AMFLAGS = -I ../.. -I ../../config
 
Index: libjava/configure.ac
===================================================================
--- libjava/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -164,7 +164,7 @@
 AC_SUBST(CXXFLAGS)
 AC_SUBST(LDFLAGS)
 
-AM_INIT_AUTOMAKE([1.9.0])
+AM_INIT_AUTOMAKE([1.9.0 no-dist])
 
 AC_CHECK_TOOL(AS, as)
 AC_CHECK_TOOL(LD, ld)
@@ -1712,8 +1712,8 @@
 # Check if linker supports static linking on a per library basis
 LD_START_STATIC_SPEC=
 LD_FINISH_STATIC_SPEC=
-if $LD --help 2>&1 | grep -q -e -call_shared ; then
-  if $LD --help 2>&1 | grep -q -e -non_shared ; then
+if $LD --help 2>&1 | grep -- -call_shared >/dev/null 2>&1; then
+  if $LD --help 2>&1 | grep -- -non_shared >/dev/null 2>&1; then
     LD_START_STATIC_SPEC='%{static-libgcj:-non_shared}'
     LD_FINISH_STATIC_SPEC='%{static-libgcj:-call_shared}'
   fi
Index: libjava/classpath/Makefile.in
===================================================================
--- libjava/classpath/Makefile.in	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/classpath/Makefile.in	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -36,25 +36,17 @@
 build_triplet = @build@
 host_triplet = @host@
 target_triplet = @target@
-DIST_COMMON = README $(am__configure_deps) \
-	$(srcdir)/../../config.guess $(srcdir)/../../config.sub \
-	$(srcdir)/../../install-sh $(srcdir)/../../ltmain.sh \
-	$(srcdir)/../../missing $(srcdir)/../../mkinstalldirs \
-	$(srcdir)/Makefile.am $(srcdir)/Makefile.in \
-	$(top_srcdir)/configure \
+DIST_COMMON = $(srcdir)/../../config.guess $(srcdir)/../../config.sub \
+	INSTALL NEWS README AUTHORS ChangeLog $(srcdir)/Makefile.in \
+	$(srcdir)/Makefile.am $(top_srcdir)/configure \
+	$(am__configure_deps) $(srcdir)/../../mkinstalldirs \
 	$(top_srcdir)/gnu/classpath/Configuration.java.in \
 	$(top_srcdir)/gnu/java/security/Configuration.java.in \
 	$(top_srcdir)/resource/META-INF/services/java.util.prefs.PreferencesFactory.in \
 	$(top_srcdir)/resource/META-INF/services/javax.sound.sampled.spi.AudioFileReader.in \
 	$(top_srcdir)/resource/META-INF/services/javax.sound.sampled.spi.MixerProvider.in \
-	../../ABOUT-NLS ../../COPYING ../../COPYING.LIB \
-	../../ChangeLog ../../README ../../compile ../../config.guess \
-	../../config.rpath ../../config.sub ../../depcomp \
-	../../install-sh ../../ltmain.sh ../../missing \
-	../../mkinstalldirs ../../ylwrap AUTHORS COPYING ChangeLog \
-	INSTALL NEWS TODO compile config.guess config.sub depcomp \
-	install-sh ltcf-c.sh ltcf-cxx.sh ltcf-gcj.sh ltconfig \
-	ltmain.sh missing mkinstalldirs
+	$(srcdir)/../../ltmain.sh $(srcdir)/../../config.guess \
+	$(srcdir)/../../config.sub
 subdir = .
 ACLOCAL_M4 = $(top_srcdir)/aclocal.m4
 am__aclocal_m4_deps = $(top_srcdir)/../../config/depstand.m4 \
@@ -93,7 +85,6 @@
 	resource/META-INF/services/javax.sound.sampled.spi.AudioFileReader \
 	resource/META-INF/services/javax.sound.sampled.spi.MixerProvider
 SOURCES =
-DIST_SOURCES =
 MULTISRCTOP = 
 MULTIBUILDTOP = 
 MULTIDIRS = 
@@ -108,17 +99,6 @@
 	uninstall-recursive
 ETAGS = etags
 CTAGS = ctags
-DISTFILES = $(DIST_COMMON) $(DIST_SOURCES) $(TEXINFOS) $(EXTRA_DIST)
-distdir = $(PACKAGE)-$(VERSION)
-top_distdir = $(distdir)
-am__remove_distdir = \
-  { test ! -d $(distdir) \
-    || { find $(distdir) -type d ! -perm -200 -exec chmod u+w {} ';' \
-         && rm -fr $(distdir); }; }
-DIST_ARCHIVES = $(distdir).tar.gz
-GZIP_ENV = --best
-distuninstallcheck_listfiles = find . -type f -print
-distcleancheck_listfiles = find . -type f -print
 ACLOCAL = @ACLOCAL@
 AMDEP_FALSE = @AMDEP_FALSE@
 AMDEP_TRUE = @AMDEP_TRUE@
@@ -605,152 +585,6 @@
 
 distclean-tags:
 	-rm -f TAGS ID GTAGS GRTAGS GSYMS GPATH tags
-
-distdir: $(DISTFILES)
-	$(am__remove_distdir)
-	mkdir $(distdir)
-	$(mkdir_p) $(distdir)/../.. $(distdir)/../../config $(distdir)/examples $(distdir)/gnu/classpath $(distdir)/gnu/java/security $(distdir)/lib $(distdir)/m4 $(distdir)/resource/META-INF/services $(distdir)/scripts $(distdir)/tools
-	@srcdirstrip=`echo "$(srcdir)" | sed 's|.|.|g'`; \
-	topsrcdirstrip=`echo "$(top_srcdir)" | sed 's|.|.|g'`; \
-	list='$(DISTFILES)'; for file in $$list; do \
-	  case $$file in \
-	    $(srcdir)/*) file=`echo "$$file" | sed "s|^$$srcdirstrip/||"`;; \
-	    $(top_srcdir)/*) file=`echo "$$file" | sed "s|^$$topsrcdirstrip/|$(top_builddir)/|"`;; \
-	  esac; \
-	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
-	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
-	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
-	    dir="/$$dir"; \
-	    $(mkdir_p) "$(distdir)$$dir"; \
-	  else \
-	    dir=''; \
-	  fi; \
-	  if test -d $$d/$$file; then \
-	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
-	      cp -pR $(srcdir)/$$file $(distdir)$$dir || exit 1; \
-	    fi; \
-	    cp -pR $$d/$$file $(distdir)$$dir || exit 1; \
-	  else \
-	    test -f $(distdir)/$$file \
-	    || cp -p $$d/$$file $(distdir)/$$file \
-	    || exit 1; \
-	  fi; \
-	done
-	list='$(DIST_SUBDIRS)'; for subdir in $$list; do \
-	  if test "$$subdir" = .; then :; else \
-	    test -d "$(distdir)/$$subdir" \
-	    || $(mkdir_p) "$(distdir)/$$subdir" \
-	    || exit 1; \
-	    distdir=`$(am__cd) $(distdir) && pwd`; \
-	    top_distdir=`$(am__cd) $(top_distdir) && pwd`; \
-	    (cd $$subdir && \
-	      $(MAKE) $(AM_MAKEFLAGS) \
-	        top_distdir="$$top_distdir" \
-	        distdir="$$distdir/$$subdir" \
-	        distdir) \
-	      || exit 1; \
-	  fi; \
-	done
-	$(MAKE) $(AM_MAKEFLAGS) \
-	  top_distdir="$(top_distdir)" distdir="$(distdir)" \
-	  dist-hook
-	-find $(distdir) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
-	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
-	  ! -type d ! -perm -444 -exec $(SHELL) $(install_sh) -c -m a+r {} {} \; \
-	|| chmod -R a+r $(distdir)
-dist-gzip: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-dist-bzip2: distdir
-	tardir=$(distdir) && $(am__tar) | bzip2 -9 -c >$(distdir).tar.bz2
-	$(am__remove_distdir)
-
-dist-tarZ: distdir
-	tardir=$(distdir) && $(am__tar) | compress -c >$(distdir).tar.Z
-	$(am__remove_distdir)
-
-dist-shar: distdir
-	shar $(distdir) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).shar.gz
-	$(am__remove_distdir)
-
-dist-zip: distdir
-	-rm -f $(distdir).zip
-	zip -rq $(distdir).zip $(distdir)
-	$(am__remove_distdir)
-
-dist dist-all: distdir
-	tardir=$(distdir) && $(am__tar) | GZIP=$(GZIP_ENV) gzip -c >$(distdir).tar.gz
-	$(am__remove_distdir)
-
-# This target untars the dist file and tries a VPATH configuration.  Then
-# it guarantees that the distribution is self-contained by making another
-# tarfile.
-distcheck: dist
-	case '$(DIST_ARCHIVES)' in \
-	*.tar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).tar.gz | $(am__untar) ;;\
-	*.tar.bz2*) \
-	  bunzip2 -c $(distdir).tar.bz2 | $(am__untar) ;;\
-	*.tar.Z*) \
-	  uncompress -c $(distdir).tar.Z | $(am__untar) ;;\
-	*.shar.gz*) \
-	  GZIP=$(GZIP_ENV) gunzip -c $(distdir).shar.gz | unshar ;;\
-	*.zip*) \
-	  unzip $(distdir).zip ;;\
-	esac
-	chmod -R a-w $(distdir); chmod a+w $(distdir)
-	mkdir $(distdir)/_build
-	mkdir $(distdir)/_inst
-	chmod a-w $(distdir)
-	dc_install_base=`$(am__cd) $(distdir)/_inst && pwd | sed -e 's,^[^:\\/]:[\\/],/,'` \
-	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
-	  && cd $(distdir)/_build \
-	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
-	    $(DISTCHECK_CONFIGURE_FLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) \
-	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
-	  && $(MAKE) $(AM_MAKEFLAGS) check \
-	  && $(MAKE) $(AM_MAKEFLAGS) install \
-	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
-	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
-	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
-	        distuninstallcheck \
-	  && chmod -R a-w "$$dc_install_base" \
-	  && ({ \
-	       (cd ../.. && umask 077 && mkdir "$$dc_destdir") \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
-	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
-	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
-	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
-	  && rm -rf "$$dc_destdir" \
-	  && $(MAKE) $(AM_MAKEFLAGS) dist \
-	  && rm -rf $(DIST_ARCHIVES) \
-	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
-	$(am__remove_distdir)
-	@(echo "$(distdir) archives ready for distribution: "; \
-	  list='$(DIST_ARCHIVES)'; for i in $$list; do echo $$i; done) | \
-	  sed -e '1{h;s/./=/g;p;x;}' -e '$${p;x;}'
-distuninstallcheck:
-	@cd $(distuninstallcheck_dir) \
-	&& test `$(distuninstallcheck_listfiles) | wc -l` -le 1 \
-	   || { echo "ERROR: files left after uninstall:" ; \
-	        if test -n "$(DESTDIR)"; then \
-	          echo "  (check DESTDIR support)"; \
-	        fi ; \
-	        $(distuninstallcheck_listfiles) ; \
-	        exit 1; } >&2
-distcleancheck: distclean
-	@if test '$(srcdir)' = . ; then \
-	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
-	  exit 1 ; \
-	fi
-	@test `$(distcleancheck_listfiles) | wc -l` -eq 0 \
-	  || { echo "ERROR: files left in build directory after distclean:" ; \
-	       $(distcleancheck_listfiles) ; \
-	       exit 1; } >&2
 check-am: all-am
 check: check-recursive
 all-am: Makefile all-multi
@@ -834,20 +668,18 @@
 
 .PHONY: $(RECURSIVE_TARGETS) CTAGS GTAGS all all-am all-multi \
 	am--refresh check check-am clean clean-generic clean-libtool \
-	clean-multi clean-recursive ctags ctags-recursive dist \
-	dist-all dist-bzip2 dist-gzip dist-hook dist-shar dist-tarZ \
-	dist-zip distcheck distclean distclean-generic \
-	distclean-libtool distclean-multi distclean-recursive \
-	distclean-tags distcleancheck distdir distuninstallcheck dvi \
-	dvi-am html html-am info info-am install install-am \
-	install-data install-data-am install-exec install-exec-am \
-	install-info install-info-am install-man install-multi \
-	install-strip installcheck installcheck-am installdirs \
-	installdirs-am maintainer-clean maintainer-clean-generic \
-	maintainer-clean-multi maintainer-clean-recursive mostlyclean \
-	mostlyclean-generic mostlyclean-libtool mostlyclean-multi \
-	mostlyclean-recursive pdf pdf-am ps ps-am tags tags-recursive \
-	uninstall uninstall-am uninstall-info-am
+	clean-multi clean-recursive ctags ctags-recursive distclean \
+	distclean-generic distclean-libtool distclean-multi \
+	distclean-recursive distclean-tags dvi dvi-am html html-am \
+	info info-am install install-am install-data install-data-am \
+	install-exec install-exec-am install-info install-info-am \
+	install-man install-multi install-strip installcheck \
+	installcheck-am installdirs installdirs-am maintainer-clean \
+	maintainer-clean-generic maintainer-clean-multi \
+	maintainer-clean-recursive mostlyclean mostlyclean-generic \
+	mostlyclean-libtool mostlyclean-multi mostlyclean-recursive \
+	pdf pdf-am ps ps-am tags tags-recursive uninstall uninstall-am \
+	uninstall-info-am
 
 
 native: lib
Index: libjava/classpath/configure.ac
===================================================================
--- libjava/classpath/configure.ac	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/classpath/configure.ac	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -74,7 +74,7 @@
 AC_SUBST(CLASSPATH_CONVENIENCE)
 
 AC_PREREQ(2.59)
-AM_INIT_AUTOMAKE([1.9.0 gnu std-options tar-ustar -Wno-portability])
+AM_INIT_AUTOMAKE([1.9.0 gnu std-options tar-ustar no-dist -Wno-portability])
 AC_CONFIG_HEADERS([include/config.h])
 AC_PREFIX_DEFAULT(/usr/local/classpath)
 
Index: libjava/classpath/ChangeLog
===================================================================
--- libjava/classpath/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/classpath/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,9 @@
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libjava/ChangeLog
===================================================================
--- libjava/ChangeLog	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/ChangeLog	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -1,3 +1,16 @@
+2010-05-25  Rainer Orth  <ro@CeBiTec.Uni-Bielefeld.DE>
+
+	* configure.ac: Redirect grep stdout, stderr to /dev/null instead
+	of grep -q.
+	Use -- instead of grep -e.
+	* configure: Regenerate.
+
+2010-04-29  Jakub Jelinek  <jakub@redhat.com>
+
+	PR other/43620
+	* configure.ac (AM_INIT_AUTOMAKE): Add no-dist option.
+	* Makefile.in: Regenerated.
+
 2010-04-29  Release Manager
 
 	* GCC 4.4.4 released.
Index: libjava/configure
===================================================================
--- libjava/configure	(.../tags/gcc_4_4_4_release)	(wersja 160097)
+++ libjava/configure	(.../branches/gcc-4_4-branch)	(wersja 160097)
@@ -28079,8 +28079,8 @@
 # Check if linker supports static linking on a per library basis
 LD_START_STATIC_SPEC=
 LD_FINISH_STATIC_SPEC=
-if $LD --help 2>&1 | grep -q -e -call_shared ; then
-  if $LD --help 2>&1 | grep -q -e -non_shared ; then
+if $LD --help 2>&1 | grep -- -call_shared >/dev/null 2>&1; then
+  if $LD --help 2>&1 | grep -- -non_shared >/dev/null 2>&1; then
     LD_START_STATIC_SPEC='%{static-libgcj:-non_shared}'
     LD_FINISH_STATIC_SPEC='%{static-libgcj:-call_shared}'
   fi
